{"version":3,"sources":["../../.tmp/concat/scripts/scripts.js"],"names":["createAudioMeter","audioContext","clipLevel","averaging","clipLag","processor","createScriptProcessor","onaudioprocess","volumeAudioProcess","clipping","lastClip","volume","connect","destination","checkClipping","this","window","performance","now","shutdown","disconnect","event","x","buf","inputBuffer","getChannelData","bufLength","length","sum","i","Math","abs","rms","sqrt","max","$","JsonRpcClient","options","self","extend","ajaxUrl","socketUrl","onmessage","login","passwd","sessid","loginParams","userVariables","getSocket","onmessage_cb","_getSocket","ws_cnt","wsOnMessage","_wsOnMessage","prototype","_ws_socket","_ws_callbacks","_current_id","speedTest","bytes","cb","socket","speedCB","speedBytes","send","loops","rem","data","Array","join","call","method","params","success_cb","error_cb","request","jsonrpc","id","e","console","log","_wsCall","ajax","type","url","toJSON","dataType","cache","success","error","result","jqXHR","textStatus","errorThrown","response","parseJSON","responseText","err","notify","batch","callback","all_done_cb","_batchObject","_execute","socketReady","readyState","closeSocket","onclose","w","close","loginData","connectSocket","to","clearTimeout","authing","WebSocket","ws_sleep","onWSClose","wsFallbackURL","setTimeout","onopen","onWSConnect","req","q","pop","stopRetrying","request_json","push","request_obj","orig_req","code","onWSLogin","eventData","reply","msg","up_dur","parseInt","substring","down_dur","up_kps","toFixed","down_kps","info","upDur","downDur","upKPS","downKPS","jsonrpcclient","_requests","batch_request","handlers","undefined","_batchCb","jQuery","findLine","sdpLines","prefix","substr","findLineInRange","startLine","endLine","realEndLine","indexOf","toLowerCase","getCodecPayloadType","sdpLine","pattern","RegExp","match","setCompat","checkCompat","onStreamError","doCallback","onStreamSuccess","stream","onRemoteStreamSuccess","onICE","candidate","mediaData","candidateList","func","arg","callbacks","onICEComplete","onChannelError","onICESDP","sdp","SDP","stereoHack","onRemoteStream","useVideo","style","display","navigator","platform","setAttribute","element","useAudio","FSRTCattachMediaStream","remoteStream","onOfferSDP","getMediaParams","obj","audio","useMic","videoParams","screenShare","audioParams","deviceId","assignMediaIdToConstraint","localVideo","useStream","getUserMedia","constraints","video","useCamera","useCameraLabel","useMicLabel","onsuccess","localVideoStream","onerror","bestFrameRate","vertoBestFrameRate","minFrameRate","mozGetUserMedia","dowin","confirm","width","min","minWidth","maxWidth","height","minHeight","maxHeight","mediaSource","opt","sourceId","maxFrameRate","mandatory","optional","frameRate","ideal","FSRTCPeerConnection","ice_handler","done","gathering","peer","localDescription","createOffer","sessionDescription","serializeSdp","setLocalDescription","onSdpError","createAnswer","setRemoteDescription","RTCSessionDescription","offerSDP","onSdpSuccess","onAnswerSDP","openOffererChannel","onChannelMessage","_openOffererChannel","channel","createDataChannel","reliable","setChannelEvents","onChannelOpened","onChannelClosed","warn","config","default_ice","urls","turnServer","iceServers","bundlePolicy","sdpSemantics","RTCPeerConnection","onicecandidate","attachStream","getAudioTracks","forEach","track","addTrack","getVideoTracks","attachStreams","streams","addStream","onaddstream","remoteMediaStream","oninactive","onRemoteStreamEnded","addAnswerSDP","cbSuccess","cbError","addICE","addIceCandidate","RTCIceCandidate","sdpMLineIndex","sendData","message","stop","active","activateLocalVideo","el","srcObject","deactivateLocalVideo","assureConstraintByLabel","constraint","fallbackLabel","Promise","resolve","assureMediaInputId","then","Object","assign","catch","exact","trustyGetUserMedia","mediaDevices","mediaId","rest","video_constraints","all","assurances","FSRTC","useStereo","userData","audioEnabled","videoEnabled","profile","offerToReceiveAudio","useSpeak","offerToReceiveVideo","validRes","local","on","opusPayload","split","opusIndex","fmtpLineIndex","toString","concat","answer","onSuccess","onError","stopPeer","localStream","tracks","getTracks","index","getMute","setMute","what","audioTracks","len","enabled","getVideoMute","setVideoMute","videoTracks","remoteSDP","debug","mediaParams","screen","offerToSendAudio","resSupported","h","bestResSupported","resList","resI","ttl","checkRes","cam","res","localStorage","setItem","getValidRes","cached","getItem","checkPerms","runtime","check_audio","check_video","drop_bad","verto","eventSUBS","mark_ready","j","ready","readyHandler","do_subscribe","subChannels","sparams","eventChannel","handler","serno","SERNO","isnew","createMainModeratorMethods","conf","listVideoLayouts","modCommand","play","file","deaf","memberID","undeaf","record","stopRecord","snapshot","hasVid","setVideoLayout","layout","canvasID","kick","muteMic","muteVideo","presenter","videoFloor","banner","text","escape","volumeDown","volumeUp","gainDown","gainUp","transfer","exten","sendChat","rpcClient","laData","chatChannel","action","checkStateChange","oldS","newS","enum","state","purge","states","name","find_name","audioOutDevices","source","generateGUID","crypto","Uint16Array","getRandomValues","S4","num","ret","replace","c","r","random","saved","tag","localTag","deviceParams","onResCheck","ringSleep","dialogs","handleMessage","o","ringFile","ringer","logout","body","sendMethod","processReply","unauthorizedChannels","subscribedChannels","subscribe","subParams","unsubscribe","handle","unsubChannels","sendChannels","repl","u","broadcast","callID","setState","hangup","dialog","newCall","args","direction","outbound","invite","rtc","handleAnswer","handleMedia","handleDisplay","handleInfo","attach","inbound","recovering","wantVideo","list","key","onMessage","pvtEvent","sendMessage","sub","onEvent","from","clientReady","del_array","array","hashArray","vha","hash","reorder","a","clear","add","val","insertAt","redraw","n","del","get","order","arrayLen","asArray","each","dump","html","str","JSON","stringify","liveArray","context","la","lastSerno","binding","user_obj","userObj","_add","_del","_reorder","_clear","errs","onChange","checkSerno","onErr","bootstrap","init","bootObj","modify","eventHandler","v","packet","wireSerno","hashKey","arrIndex","destroy","sendCommand","cmd","command","changepage","heartbeat","hb_pid","liveTable","jq","genRow","tmp","oldStatus","genArray","dt","lt","dataTable","fnDestroy","iserr","aoColumns","sTitle","fnClearTable","fnAddData","fnAdjustColumnSizing","fnUpdate","fnDeleteRow","hide","show","CONFMAN_SERNO","onBroadcast","onLaChange","onLaRow","modChannel","infoChannel","infoCallback","chatCallback","value","application","destroyed","modfuncs","confMan","genMainMod","play_id","stop_id","recording_id","snapshot_id","rec_stop_id","div_id","change_video_layout","canvas_id","canvasCount","vlayout_id","vlselect_id","vlhtml","append","click","prompt","genControls","rowid","kick_id","canvas_in_next_id","canvas_in_prev_id","canvas_out_next_id","canvas_out_prev_id","canvas_in_set_id","canvas_out_set_id","layer_set_id","layer_next_id","layer_prev_id","tmute_id","tvmute_id","vbanner_id","tvpresenter_id","tvfloor_id","box_id","gainup_id","gaindn_id","volup_id","voldn_id","transfer_id","mouseover","mouse","mouseout","xten","cid","tableID","statusID","mainModID","atitle","awidth","role","displayID","selectmenu","empty","Option","responseData","rdata","sort","b","ga","gb","lastTimeout","row_callback","nRow","aData","iDisplayIndex","iDisplayIndexFull","$row","laChannel","laName","confEvent","laChange","aaData","sWidth","bAutoWidth","bDestroy","bSort","bInfo","bFilter","bLengthChange","bPaginate","iDisplayLength","oLanguage","sEmptyTable","fnRowCallback","lastState","new","answered","audioStream","document","getElementById","videoStream","RTCcallbacks","display_direction","remote_caller_id_name","caller_id_name","remote_caller_id_number","caller_id_number","callee_id_name","callee_id_number","destination_number","requesting","answering","location","reload","onStream","permissionCallback","onGranted","onDenied","cause","ring","dialogParams","noDialogParams","setAudioPlaybackDevice","sinkId","devname","setSinkId","errorMessage","ringing","stopRinging","onDialogState","early","speaker","trying","remove","holdState","held","causeCode","indicateRing","attr","dtmf","digits","rtt","pobj","chars","txt","dest","replaceCallID","hold","unhold","toggleHold","gotAnswer","gotEarly","cidString","enc","display_name","display_number","ENUM","s","map","freeze","unloadJobs","unloadEventName","bind","f","haltClosure","warnOnUnload","videoDevices","audioInDevices","checkDevices","gotDevices","deviceInfos","deviceInfo","kind","label","aud_in","aud_out","vid","Xstream","handleError","checkTypes","devs","has_audio","has_video","enumerateDevices","refreshDevices","skipPermCheck","skipDeviceCheck","status","genUUID","exports","module","define","amd","g","global","adapter","t","require","Error","p","1","_adapter_factory","adapterFactory","./adapter_factory.js","2","_interopRequireWildcard","__esModule","newObj","hasOwnProperty","default","_ref","arguments","shimChrome","shimFirefox","shimEdge","shimSafari","logging","utils","browserDetails","detectBrowser","commonShim","extractVersion","disableLog","disableWarnings","browser","chromeShim","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeAllowExtmapMixed","firefoxShim","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","edgeShim","shimGetDisplayMedia","shimReplaceTrack","safariShim","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","defineProperty","_utils","_chrome_shim","_edge_shim","_firefox_shim","_safari_shim","_common_shim","./chrome/chrome_shim","./common_shim","./edge/edge_shim","./firefox/firefox_shim","./safari/safari_shim","./utils","3","walkStats","stats","base","resultSet","has","set","keys","endsWith","filterStats","streamStatsType","filteredResult","Map","trackStats","trackIdentifier","trackStat","trackId","MediaStream","webkitMediaStream","_typeof","wrapPeerConnectionEvent","transceiver","receiver","_ontrack","removeEventListener","addEventListener","enumerable","configurable","origSetRemoteDescription","_this","_ontrackpoly","te","getReceivers","find","Event","dispatchEvent","apply","shimSenderWithDtmf","pc","_dtmf","createDTMFSender","_pc","getSenders","_senders","slice","origAddTrack","sender","origRemoveTrack","removeTrack","idx","splice","origAddStream","_this2","origRemoveStream","removeStream","_this3","RTCRtpSender","origGetSenders","_this4","senders","RTCRtpReceiver","_this5","getStats","origGetReceivers","_this6","receivers","srcElement","origGetStats","MediaStreamTrack","reject","DOMException","shimAddTrackRemoveTrackWithNative","getLocalStreams","_this7","_shimmedLocalStreams","streamId","_this8","existingSenders","newSenders","filter","newSender","_this9","replaceInternalStreamId","description","_reverseStreams","internalId","externalStream","internalStream","_streams","replaceExternalStreamId","version","origGetLocalStreams","_this10","nativeStreams","_this11","newStream","_this12","signalingState","oldStream","nativeMethod","_this13","desc","origSetLocalDescription","origLocalDescription","getOwnPropertyDescriptor","_this14","streamid","webkitRTCPeerConnection","selector","successCallback","errorCallback","_this15","fixChromeStats_","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","successCallbackWrapper_","nativeAddIceCandidate","target","Symbol","iterator","constructor","_getusermedia","_getdisplaymedia","../utils.js","./getdisplaymedia","./getusermedia","4","getSourceId","getDisplayMedia","widthSpecified","heightSpecified","frameRateSpecified","chromeMediaSource","chromeMediaSourceId","5","constraintsToChrome_","cc","oldname_","charAt","toUpperCase","oc","mix","advanced","shimConstraints_","parse","remap","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","devices","d","dev","some","includes","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraintName","getUserMedia_","webkitGetUserMedia","origGetUserMedia","cs","6","_interopRequireDefault","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","_sdp2","parseCandidate","augmentedCandidate","sdpMid","usernameFragment","writable","RTCSctpTransport","_sctp","sctpInDescription","sections","splitSections","shift","mediaSection","mLine","parseMLine","protocol","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","maxMessageSize","matchPrefix","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","sctp","wrapDcSend","dc","origDataChannelSend","size","byteLength","TypeError","origCreateDataChannel","dataChannel","proto","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","nativeSRD","line","trim","_sdp","7","RTCIceGatherer","origMSTEnabled","ev","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","_rtcpeerconnectionShim2","_filtericeservers","filterIceServers","replaceTrack","setTrack","_rtcpeerconnectionShim","../utils","./filtericeservers","rtcpeerconnection-shim","8","edgeVersion","hasTurn","server","deprecated","isString","validTurn","startsWith","9","10","11","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","onSucc","DataChannel","RTCDataChannel","12","preferredMediaSource","13","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","14","_localStreams","_addTrack","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","compactObject","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","RTCTransceiver","origCreateOffer","offerOptions","audioTransceiver","getTransceivers","setDirection","addTransceiver","videoTransceiver","15","_defineProperty","uastring","expr","pos","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","_eventMap","nativeRemoveEventListener","unwrappedCb","bool","logDisabled_","deprecationWarnings_","oldMethod","newMethod","userAgent","reduce","accumulator","isObject","isEmptyObject","16","fixStatsType","writeMediaSection","caps","dtlsRole","SDPUtils","writeRtpDescription","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","mid","rtpSender","rtpReceiver","_initialTrackId","msid","sendEncodingParameters","ssrc","rtx","localCName","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","codecs","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","parameters","apt","rCodec","clockRate","numChannels","rtcpFeedback","fb","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","offer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","remoteCandidate","foundation","ip","port","priority","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","removeTrackFromStreamAndFireEvent","fireAddTrack","trackEvent","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceGatheringState","usingBundle","rtcpMuxPolicy","iceTransportPolicy","_iceGatherers","iceCandidatePoolSize","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","getConfiguration","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","_gather","onlocalcandidate","evt","cand","component","ufrag","serializedCandidate","writeCandidate","getMediaSections","getDescription","complete","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","_disposeIceAndDtlsTransports","_transceive","recv","encodings","rtcp","cname","compound","rtcpParameters","receive","sessionpart","parseRtpParameters","isIceLite","isRejected","rejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","start","_updateSignalingState","receiverList","iceOptions","lines","splitLines","getKind","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","cands","setTransport","setRemoteCandidates","hasRtx","getCapabilities","codec","isNewTrack","nativeTrack","sid","item","newState","closed","connected","disconnected","failed","connecting","numAudioTracks","numVideoTracks","writeSessionBoilerplate","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","reducedSize","candidateString","senderOrReceiver","promises","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","17","blob","part","parts","address","relatedAddress","relatedPort","tcpType","parseIceOptions","parseRtpMap","parsed","channels","writeRtpMap","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","attribute","parseSsrcGroup","semantics","ssrcs","parseFingerprint","algorithm","fingerprints","setupType","fp","password","mline","rtpmapline","fmtps","maxptime","extension","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","encParam","codecPayloadType","fec","mechanism","bandwidth","maxBitrate","remoteSsrc","rsize","mux","spec","planB","msidParts","sessId","sessVer","sessUser","sessionId","fmt","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","getScreenConstraints","screen_constraints","postMessage","iframe","isLoaded","contentWindow","captureSourceId","loadIFrame","loadCallback","createElement","onload","src","documentElement","appendChild","getScreenId","onIFrameCallback","chromeExtensionStatus","mozMediaSource","domain","k","l","m","String","fromCharCode","charCodeAt","unescape","encodeURIComponent","md5","vertoApp","angular","constant","languages","dialects","en","en_GB","en_US","it","it_IT","fr","fr_FR","fr_CA","pt_BR","pt_PT","de","de_DE","es","es_ES","pl","pl_PL","ru","ru_RU","sv","sv_SV","sv_FI","da","da_DK","id_ID","zh","zh_CN","zh_TW","zh_HK","$routeProvider","gravatarServiceProvider","$translateProvider","configLanguages","when","title","templateUrl","controller","otherwise","redirectTo","defaults","reg_langs","useStaticFilesLoader","suffix","registerAvailableLanguageKeys","preferredLanguage","determinePreferredLanguage","fallbackLanguage","useSanitizeValueStrategy","run","$rootScope","$location","toastr","$on","next","current","path","previous","$$route","safeProtocol","promptInput","input","isFunction","$scope","$timeout","storage","splashscreen","progress_percentage","interrupt_next","errors","link","activity","checkProgressState","current_progress","soft","interrupt","calculate","getProgressMessage","$http","Fullscreen","$anchorScroll","$translate","scrollToChatBottom","querySelector","scrollTop","scrollHeight","clearConferenceChat","members","messages","CLEAN_MESSAGE","getResByLayout","layoutsData","confLayoutsData","resIDS","clearMembersResID","preserve","member","resID","reservationID","confResID","findMemberByUUID","uuid","found","translateMember","number","email","addMember","shortPrompt","$watch","activePane","chat_counter","created_at","Date","$apply","chatStatus","resIDs","currentLayout","layoutName","openId","watcher","master","memberIdx","conferenceMemberID","mutedMic","muted","mutedVideo","$applyAsync","closeChat","toggleModMenu","confRole","preventDefault","sendConferenceChat","confKick","confMuteMic","confMuteVideo","confPresenter","setResevartionId","confVideoFloor","confBanner","instant","confCanvasIn","setCanvasIn","confCanvasOut","setCanvasOut","confLayer","setLayer","confResetBanner","confVolumeDown","confVolumeUp","confGainDown","confGainUp","confTransfer","disableOnKeydownDtmf","enableOnKeydownDtmf","confToggleDeaf","origin","pathname","contributors","re","githash","CallHistory","eventQueue","onHold","cur_call","dialpadNumber","called_number","mirrorInput","videoCall","warning","process","search","autocall","call_history","history_control","all_control","has_history","userStatus","calling","clearCallHistory","viewCallsList","calls","call_list","fillDialpadNumber","preview","loading","cancelled","testSpeedJoin","testSpeed","cancel","$modal","buildCanvasesData","canvases","callTemplate","dialpadTemplate","incall","openChat","toggleDialpad","openModal","cbMuteVideo","cbMuteMic","confChangeVideoLayout","videoLayout","$emit","confChangeSpeaker","speakerId","selectedSpeaker","confPopup","href","curCall","webcam","offsetWidth","offsetHeight","y","open","moveTo","screenshare","shareCall","screenshareHangup","allowHtml","$broadcast","skipPreview","$q","$window","ws_modalInstance","backdrop","keyboard","showReconnectModal","autoBand","gapiClientLoaded","gapi","client","plus","people","userId","execute","handleEmailResponse","resp","primaryEmail","emails","displayName","image","sinkIdCallback","deviceName","onKeydownDtmfHistory","caracter","onKeydownDtmfEnabled","dtmfWidget","dtmfHistory","callState","language","use","addClass","dialpad","myVideo","hasClass","redirect","connectCallback","hostname","wsURL","ui_connected","ws_connected","disconnectCallback","reset","auth","signOut","openModalSettings","modalInstance","animation","animationsEnabled","rendered","material","_options","showAbout","showContributors","backspace","toggleCallHistory","removeClass","toggleChat","toggleClass","updateVideoSize","toggleSettings","settingsEl","closeSettings","goFullscreen","fullscreenEnabled","isEnabled","enable","getElementsByTagName","$digest","page_incall","askRecoverCall","events","authResult","load","callActive","call_start","start_time","incomingCall","answerCall","declineCall","selectedVideo","originalPath","unbind","vidQual","bwp","bandDown","bandUp","iconClass","videoQuality","vidRes","$modalInstance","ok","dismiss","ModalWsReconnectController","closeReconnect","instance","$inject","speakerFeature","mydata","copy","unshift","translation","selectedVideoName","changeData","useSTUN","googEchoCancellation","googNoiseSuppression","googHighpassFilter","googAutoGainControl","googAutoGainControl2","changedLanguage","langKey","browserlang","lang","fail_lang","refreshDeviceList","showPreview","speedMsg","isTestingSpeed","resetSettings","factoryReset","checkAutoBand","option","useDedenc","bestres","outgoingBandwidth","incomingBandwidth","checkUseDedRemoteEncoder","checkVideoQuality","resolution","videoResolution","stopMedia","streamObj","mediaStreamSource","createMediaStreamSource","meter","volumes","children","mirrored","selectedAudio","newDevice","device","AudioContext","endPreview","$interval","int_id","stopInterval","resCheckEnded","directive","restrict","$element","focus","scope","attrs","fadeIn","parent","fadeOut","condition","videoElem","getElementsByClassName","resize","css","appendTo","regex","regex64","test","videoQualitySource","qqvga","qvga","vga","qvga_wide","vga_wide","hd","hhd","framerate","updateReq","ms","new_w","new_h","aspect","videoContainer","round","vertoService","service","$cookieStore","cleanShareCall","that","cleanCall","confLayouts","chattingWith","last_state","updateResolutions","supportedResolutions","audioDevices","shareDevices","textTo","refreshDevicesCallback","speakerDevices","selectedShare","videoFlag","shareFlag","audioFlag","speakerFlag","canVideo","refreshVideoResolution","resolutions","qual","startConference","pvtData","chatID","fromDisplay","canvasInfo","callId","fromJson","stopConference","ourBootstrap","reloaded","loginFailed","videoOnly","from_msg_name","reattached_sessions","mediaPerm","custom","callerid","dedEnc","avatar","stopSharing","screenfunc","share_call","upBand","ceil","downBand","from_msg_number","configure","floor","googlelogin","googleclientid","autologin","autologin_done","fn","fn_return","emitNextProgress","$localStorage","verto_data","defaultSettings","$default","$reset","factory","history","addCallToHistory","getCallsFromHistory","checkBrowser","checkMediaPerm","refreshMediaDevices","checkConnectionSpeed","provisionConfig","configResponse","configPromise","checkLogin","checkUserStored","progress","progress_message","calculateProgress","_progress"],"mappings":"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","file":"scripts.js","sourcesContent":["/*\n * Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n * Copyright (C) 2005-2014, Anthony Minessale II <anthm@freeswitch.org>\n *\n * Version: MPL 1.1\n *\n * The contents of this file are subject to the Mozilla Public License Version\n * 1.1 (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n * http://www.mozilla.org/MPL/\n *\n * Software distributed under the License is distributed on an \"AS IS\" basis,\n * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n * for the specific language governing rights and limitations under the\n * License.\n *\n * The Original Code is jquery.jsonrpclient.js modified for Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n *\n * The Initial Developer of the Original Code is\n * Textalk AB http://textalk.se/\n * Portions created by the Initial Developer are Copyright (C)\n * the Initial Developer. All Rights Reserved.\n *\n * Contributor(s):\n *\n * Anthony Minessale II <anthm@freeswitch.org>\n *\n * jquery.jsonrpclient.js - JSON RPC client code\n *\n */\n/**\n * This plugin requires jquery.json.js to be available, or at least the methods $.toJSON and\n * $.parseJSON.\n *\n * The plan is to make use of websockets if they are available, but work just as well with only\n * http if not.\n *\n * Usage example:\n *\n *   var foo = new $.JsonRpcClient({ ajaxUrl: '/backend/jsonrpc' });\n *   foo.call(\n *     'bar', [ 'A parameter', 'B parameter' ],\n *     function(result) { alert('Foo bar answered: ' + result.my_answer); },\n *     function(error)  { console.log('There was an error', error); }\n *   );\n *\n * More examples are available in README.md\n */\n(function($) {\n  /**\n   * @fn new\n   * @memberof $.JsonRpcClient\n   *\n   * @param options An object stating the backends:\n   *                ajaxUrl    A url (relative or absolute) to a http(s) backend.\n   *                socketUrl  A url (relative of absolute) to a ws(s) backend.\n   *                onmessage  A socket message handler for other messages (non-responses).\n   *                getSocket  A function returning a WebSocket or null.\n   *                           It must take an onmessage_cb and bind it to the onmessage event\n   *                           (or chain it before/after some other onmessage handler).\n   *                           Or, it could return null if no socket is available.\n   *                           The returned instance must have readyState <= 1, and if less than 1,\n   *                           react to onopen binding.\n   */\n    $.JsonRpcClient = function(options) {\n        var self = this;\n        this.options = $.extend({\n            ajaxUrl       : null,\n            socketUrl     : null, ///< The ws-url for default getSocket.\n            onmessage     : null, ///< Other onmessage-handler.\n            login         : null, /// auth login\n            passwd        : null, /// auth passwd\n            sessid        : null,\n\t    loginParams   : null,\n\t    userVariables : null,\n            getSocket     : function(onmessage_cb) { return self._getSocket(onmessage_cb); }\n        }, options);\n\n        self.ws_cnt = 0;\n\n        // Declare an instance version of the onmessage callback to wrap 'this'.\n        this.wsOnMessage = function(event) { self._wsOnMessage(event); };\n    };\n\n    /// Holding the WebSocket on default getsocket.\n    $.JsonRpcClient.prototype._ws_socket = null;\n\n    /// Object <id>: { success_cb: cb, error_cb: cb }\n    $.JsonRpcClient.prototype._ws_callbacks = {};\n\n    /// The next JSON-RPC request id.\n    $.JsonRpcClient.prototype._current_id = 1;\n\n\n    $.JsonRpcClient.prototype.speedTest = function (bytes, cb) {\n        var socket = this.options.getSocket(this.wsOnMessage);\n\tif (socket !== null) {\n\t    this.speedCB = cb;\n\t    this.speedBytes = bytes;\n\t    socket.send(\"#SPU \" + bytes);\n\n\t    var loops = bytes / 1024;\n\t    var rem = bytes % 1024;\n\t    var i;\n\t    var data = new Array(1024).join(\".\");\n\t    for (i = 0; i < loops; i++) {\n\t\tsocket.send(\"#SPB \" + data);\n\t    }\n\t    \n\t    if (rem) {\n\t\tsocket.send(\"#SPB \" + data);\n\t    }\n\n\t    socket.send(\"#SPE\");\n\t}\n    };\n\n\n\n    /**\n     * @fn call\n     * @memberof $.JsonRpcClient\n     *\n     * @param method     The method to run on JSON-RPC server.\n     * @param params     The params; an array or object.\n     * @param success_cb A callback for successful request.\n     * @param error_cb   A callback for error.\n     */\n    $.JsonRpcClient.prototype.call = function(method, params, success_cb, error_cb) {\n    // Construct the JSON-RPC 2.0 request.\n\n        if (!params) {\n            params = {};\n        }\n\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        var request = {\n            jsonrpc : '2.0',\n            method  : method,\n            params  : params,\n            id      : this._current_id++  // Increase the id counter to match request/response\n        };\n\n        if (!success_cb) {\n            success_cb = function(e){console.log(\"Success: \", e);};\n        }\n\n        if (!error_cb) {\n            error_cb = function(e){console.log(\"Error: \", e);};\n        }\n\n        // Try making a WebSocket call.\n        var socket = this.options.getSocket(this.wsOnMessage);\n        if (socket !== null) {\n            this._wsCall(socket, request, success_cb, error_cb);\n            return;\n        }\n\n        // No WebSocket, and no HTTP backend?  This won't work.\n        if (this.options.ajaxUrl === null) {\n            throw \"$.JsonRpcClient.call used with no websocket and no http endpoint.\";\n        }\n\n        $.ajax({\n            type     : 'POST',\n            url      : this.options.ajaxUrl,\n            data     : $.toJSON(request),\n            dataType : 'json',\n            cache    : false,\n\n            success  : function(data) {\n                if ('error' in data) error_cb(data.error, this);\n                success_cb(data.result, this);\n            },\n\n            // JSON-RPC Server could return non-200 on error\n            error    : function(jqXHR, textStatus, errorThrown) {\n                try {\n                    var response = $.parseJSON(jqXHR.responseText);\n\n                    if ('console' in window) console.log(response);\n\n                    error_cb(response.error, this);\n                } catch (err) {\n                    // Perhaps the responseText wasn't really a jsonrpc-error.\n                    error_cb({ error: jqXHR.responseText }, this);\n                }\n            }\n        });\n    };\n\n    /**\n     * Notify sends a command to the server that won't need a response.  In http, there is probably\n     * an empty response - that will be dropped, but in ws there should be no response at all.\n     *\n     * This is very similar to call, but has no id and no handling of callbacks.\n     *\n     * @fn notify\n     * @memberof $.JsonRpcClient\n     *\n     * @param method     The method to run on JSON-RPC server.\n     * @param params     The params; an array or object.\n     */\n    $.JsonRpcClient.prototype.notify = function(method, params) {\n        // Construct the JSON-RPC 2.0 request.\n\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        var request = {\n            jsonrpc: '2.0',\n            method:  method,\n            params:  params\n        };\n\n        // Try making a WebSocket call.\n        var socket = this.options.getSocket(this.wsOnMessage);\n        if (socket !== null) {\n            this._wsCall(socket, request);\n            return;\n        }\n\n        // No WebSocket, and no HTTP backend?  This won't work.\n        if (this.options.ajaxUrl === null) {\n            throw \"$.JsonRpcClient.notify used with no websocket and no http endpoint.\";\n        }\n\n        $.ajax({\n            type     : 'POST',\n            url      : this.options.ajaxUrl,\n            data     : $.toJSON(request),\n            dataType : 'json',\n            cache    : false\n        });\n    };\n\n    /**\n     * Make a batch-call by using a callback.\n     *\n     * The callback will get an object \"batch\" as only argument.  On batch, you can call the methods\n     * \"call\" and \"notify\" just as if it was a normal $.JsonRpcClient object, and all calls will be\n     * sent as a batch call then the callback is done.\n     *\n     * @fn batch\n     * @memberof $.JsonRpcClient\n     *\n     * @param callback    The main function which will get a batch handler to run call and notify on.\n     * @param all_done_cb A callback function to call after all results have been handled.\n     * @param error_cb    A callback function to call if there is an error from the server.\n     *                    Note, that batch calls should always get an overall success, and the\n     *                    only error\n     */\n    $.JsonRpcClient.prototype.batch = function(callback, all_done_cb, error_cb) {\n        var batch = new $.JsonRpcClient._batchObject(this, all_done_cb, error_cb);\n        callback(batch);\n        batch._execute();\n    };\n\n    /**\n     * The default getSocket handler.\n     *\n     * @param onmessage_cb The callback to be bound to onmessage events on the socket.\n     *\n     * @fn _getSocket\n     * @memberof $.JsonRpcClient\n     */\n\n    $.JsonRpcClient.prototype.socketReady = function() {\n        if (this._ws_socket === null || this._ws_socket.readyState > 1) {\n            return false;\n        }\n\n        return true;\n    };\n\n    $.JsonRpcClient.prototype.closeSocket = function() {\n\tvar self = this;\n        if (self.socketReady()) {\n            self._ws_socket.onclose = function (w) {console.log(\"Closing Socket\");};\n            self._ws_socket.close();\n        }\n    };\n\n    $.JsonRpcClient.prototype.loginData = function(params) {\n\tvar self = this;\n        self.options.login = params.login;\n        self.options.passwd = params.passwd;\n\tself.options.loginParams = params.loginParams;\n\tself.options.userVariables = params.userVariables;\n    };\n\n    $.JsonRpcClient.prototype.connectSocket = function(onmessage_cb) {\n        var self = this;\n\n        if (self.to) {\n            clearTimeout(self.to);\n        }\n\n        if (!self.socketReady()) {\n            self.authing = false;\n\n            if (self._ws_socket) {\n                delete self._ws_socket;\n            }\n\n            // No socket, or dying socket, let's get a new one.\n            self._ws_socket = new WebSocket(self.options.socketUrl);\n\n            if (self._ws_socket) {\n                // Set up onmessage handler.\n                self._ws_socket.onmessage = onmessage_cb;\n                self._ws_socket.onclose = function (w) {\n                    if (!self.ws_sleep) {\n                        self.ws_sleep = 1000;\n                    }\n\n                    if (self.options.onWSClose) {\n                        self.options.onWSClose(self);\n                    }\n\n                    if (self.ws_cnt > 10 && self.options.wsFallbackURL) {\n                      self.options.socketUrl = self.options.wsFallbackURL;\n                    }\n\n                    console.error(\"Websocket Lost \" + self.ws_cnt + \" sleep: \" + self.ws_sleep + \"msec\");\n\n                    self.to = setTimeout(function() {\n                        console.log(\"Attempting Reconnection....\");\n                        self.connectSocket(onmessage_cb);\n                    }, self.ws_sleep);\n\n                    self.ws_cnt++;\n\n                    if (self.ws_sleep < 3000 && (self.ws_cnt % 10) === 0) {\n                        self.ws_sleep += 1000;\n                    }\n                };\n\n                // Set up sending of message for when the socket is open.\n                self._ws_socket.onopen = function() {\n                    if (self.to) {\n                        clearTimeout(self.to);\n                    }\n                    self.ws_sleep = 1000;\n                    self.ws_cnt = 0;\n                    if (self.options.onWSConnect) {\n                        self.options.onWSConnect(self);\n                    }\n\n                    var req;\n                    // Send the requests.\n                    while ((req = $.JsonRpcClient.q.pop())) {\n                        self._ws_socket.send(req);\n                    }\n                };\n            }\n        }\n\n        return self._ws_socket ? true : false;\n    };\n\n    $.JsonRpcClient.prototype.stopRetrying = function() {\n      if (self.to)\n        clearTimeout(self.to);\n    }\n\n    $.JsonRpcClient.prototype._getSocket = function(onmessage_cb) {\n        // If there is no ws url set, we don't have a socket.\n        // Likewise, if there is no window.WebSocket.\n        if (this.options.socketUrl === null || !(\"WebSocket\" in window)) return null;\n\n        this.connectSocket(onmessage_cb);\n\n        return this._ws_socket;\n    };\n\n    /**\n     * Queue to save messages delivered when websocket is not ready\n     */\n    $.JsonRpcClient.q = [];\n\n    /**\n     * Internal handler to dispatch a JRON-RPC request through a websocket.\n     *\n     * @fn _wsCall\n     * @memberof $.JsonRpcClient\n     */\n    $.JsonRpcClient.prototype._wsCall = function(socket, request, success_cb, error_cb) {\n        var request_json = $.toJSON(request);\n\n        if (socket.readyState < 1) {\n            // The websocket is not open yet; we have to set sending of the message in onopen.\n            self = this; // In closure below, this is set to the WebSocket.  Use self instead.\n            $.JsonRpcClient.q.push(request_json);\n        } else {\n            // We have a socket and it should be ready to send on.\n            socket.send(request_json);\n        }\n\n        // Setup callbacks.  If there is an id, this is a call and not a notify.\n        if ('id' in request && typeof success_cb !== 'undefined') {\n            this._ws_callbacks[request.id] = { request: request_json, request_obj: request, success_cb: success_cb, error_cb: error_cb };\n        }\n    };\n\n    /**\n     * Internal handler for the websocket messages.  It determines if the message is a JSON-RPC\n     * response, and if so, tries to couple it with a given callback.  Otherwise, it falls back to\n     * given external onmessage-handler, if any.\n     *\n     * @param event The websocket onmessage-event.\n     */\n    $.JsonRpcClient.prototype._wsOnMessage = function(event) {\n        // Check if this could be a JSON RPC message.\n        var response;\n\n\t// Special sub proto\n\tif (event.data[0] == \"#\" && event.data[1] == \"S\" && event.data[2] == \"P\") {\n\t    if (event.data[3] == \"U\") {\n\t\tthis.up_dur = parseInt(event.data.substring(4));\n\t    } else if (this.speedCB && event.data[3] == \"D\") {\n\t\tthis.down_dur = parseInt(event.data.substring(4));\n\n\t\tvar up_kps = (((this.speedBytes * 8) / (this.up_dur / 1000)) / 1024).toFixed(0);\n\t\tvar down_kps = (((this.speedBytes * 8) / (this.down_dur / 1000)) / 1024).toFixed(0);\n\t\t\n\t\tconsole.info(\"Speed Test: Up: \" + up_kps + \" Down: \" + down_kps);\n\t\tvar cb = this.speedCB;\n\t\tthis.speedCB = null;\n\t\tcb(event, {\n\t\t\tupDur: this.up_dur,\n\t\t\tdownDur: this.down_dur,\n\t\t\tupKPS: up_kps,\n\t\t\tdownKPS: down_kps\n\t\t});\n\t    }\n\t    \n\t    return;\n\t}\n\n\n        try {\n            response = $.parseJSON(event.data);\n\n            /// @todo Make using the jsonrcp 2.0 check optional, to use this on JSON-RPC 1 backends.\n\n            if (typeof response === 'object' &&\n                'jsonrpc' in response &&\n                response.jsonrpc === '2.0') {\n\n                /// @todo Handle bad response (without id).\n\n                // If this is an object with result, it is a response.\n                if ('result' in response && this._ws_callbacks[response.id]) {\n                    // Get the success callback.\n                    var success_cb = this._ws_callbacks[response.id].success_cb;\n\n    /*\n                    // set the sessid if present\n                    if ('sessid' in response.result && !this.options.sessid || (this.options.sessid != response.result.sessid)) {\n                        this.options.sessid = response.result.sessid;\n                        if (this.options.sessid) {\n                            console.log(\"setting session UUID to: \" + this.options.sessid);\n                        }\n                    }\n    */\n                    // Delete the callback from the storage.\n                    delete this._ws_callbacks[response.id];\n\n                    // Run callback with result as parameter.\n                    success_cb(response.result, this);\n                    return;\n                } else if ('error' in response && this._ws_callbacks[response.id]) {\n                // If this is an object with error, it is an error response.\n\n                // Get the error callback.\n                    var error_cb = this._ws_callbacks[response.id].error_cb;\n                    var orig_req = this._ws_callbacks[response.id].request;\n\n                    // if this is an auth request, send the credentials and resend the failed request\n                    if (!self.authing && response.error.code == -32000 && self.options.login && self.options.passwd) {\n                        self.authing = true;\n\n                        this.call(\"login\", { login: self.options.login, passwd: self.options.passwd, loginParams: self.options.loginParams,\n\t\t\t\t\t     userVariables: self.options.userVariables},\n                            this._ws_callbacks[response.id].request_obj.method == \"login\" ?\n                            function(e) {\n                                self.authing = false;\n                                console.log(\"logged in\");\n                                delete self._ws_callbacks[response.id];\n\n                                if (self.options.onWSLogin) {\n                                    self.options.onWSLogin(true, self);\n                                }\n                            }\n\n                            :\n\n                            function(e) {\n                                self.authing = false;\n                                console.log(\"logged in, resending request id: \" + response.id);\n                                var socket = self.options.getSocket(self.wsOnMessage);\n                                if (socket !== null) {\n                                    socket.send(orig_req);\n                                }\n                                if (self.options.onWSLogin) {\n                                    self.options.onWSLogin(true, self);\n                                }\n                            },\n\n                            function(e) {\n                                console.log(\"error logging in, request id:\", response.id);\n                                delete self._ws_callbacks[response.id];\n                                error_cb(response.error, this);\n                                if (self.options.onWSLogin) {\n                                self.options.onWSLogin(false, self);\n                                }\n                            });\n                            return;\n                        }\n\n                        // Delete the callback from the storage.\n                        delete this._ws_callbacks[response.id];\n\n                        // Run callback with the error object as parameter.\n                        error_cb(response.error, this);\n                        return;\n                    }\n                }\n            } catch (err) {\n            // Probably an error while parsing a non json-string as json.  All real JSON-RPC cases are\n            // handled above, and the fallback method is called below.\n            console.log(\"ERROR: \"+ err);\n            return;\n        }\n\n        // This is not a JSON-RPC response.  Call the fallback message handler, if given.\n        if (typeof this.options.onmessage === 'function') {\n            event.eventData = response;\n            if (!event.eventData) {\n                event.eventData = {};\n            }\n\n            var reply = this.options.onmessage(event);\n\n            if (reply && typeof reply === \"object\" && event.eventData.id) {\n                var msg = {\n                    jsonrpc: \"2.0\",\n                    id: event.eventData.id,\n                    result: reply\n                };\n\n                var socket = self.options.getSocket(self.wsOnMessage);\n                if (socket !== null) {\n                    socket.send($.toJSON(msg));\n                }\n            }\n        }\n    };\n\n\n    /************************************************************************************************\n     * Batch object with methods\n     ************************************************************************************************/\n\n    /**\n     * Handling object for batch calls.\n     */\n    $.JsonRpcClient._batchObject = function(jsonrpcclient, all_done_cb, error_cb) {\n        // Array of objects to hold the call and notify requests.  Each objects will have the request\n        // object, and unless it is a notify, success_cb and error_cb.\n        this._requests   = [];\n\n        this.jsonrpcclient = jsonrpcclient;\n        this.all_done_cb = all_done_cb;\n        this.error_cb    = typeof error_cb === 'function' ? error_cb : function() {};\n\n    };\n\n    /**\n     * @sa $.JsonRpcClient.prototype.call\n     */\n    $.JsonRpcClient._batchObject.prototype.call = function(method, params, success_cb, error_cb) {\n\n        if (!params) {\n            params = {};\n        }\n\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        if (!success_cb) {\n            success_cb = function(e){console.log(\"Success: \", e);};\n        }\n\n        if (!error_cb) {\n        error_cb = function(e){console.log(\"Error: \", e);};\n        }\n\n        this._requests.push({\n            request    : {\n            jsonrpc : '2.0',\n            method  : method,\n            params  : params,\n            id      : this.jsonrpcclient._current_id++  // Use the client's id series.\n        },\n            success_cb : success_cb,\n            error_cb   : error_cb\n        });\n    };\n\n    /**\n     * @sa $.JsonRpcClient.prototype.notify\n     */\n    $.JsonRpcClient._batchObject.prototype.notify = function(method, params) {\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        this._requests.push({\n            request    : {\n                jsonrpc : '2.0',\n                method  : method,\n                params  : params\n            }\n        });\n    };\n\n    /**\n     * Executes the batched up calls.\n     */\n    $.JsonRpcClient._batchObject.prototype._execute = function() {\n        var self = this;\n\n        if (this._requests.length === 0) return; // All done :P\n\n        // Collect all request data and sort handlers by request id.\n        var batch_request = [];\n        var handlers = {};\n        var i = 0;\n        var call;\n        var success_cb;\n        var error_cb;\n\n        // If we have a WebSocket, just send the requests individually like normal calls.\n        var socket = self.jsonrpcclient.options.getSocket(self.jsonrpcclient.wsOnMessage);\n        if (socket !== null) {\n            for (i = 0; i < this._requests.length; i++) {\n                call = this._requests[i];\n                success_cb = ('success_cb' in call) ? call.success_cb : undefined;\n                error_cb   = ('error_cb'   in call) ? call.error_cb   : undefined;\n                self.jsonrpcclient._wsCall(socket, call.request, success_cb, error_cb);\n            }\n\n            if (typeof all_done_cb === 'function') all_done_cb(result);\n            return;\n        }\n\n        for (i = 0; i < this._requests.length; i++) {\n            call = this._requests[i];\n            batch_request.push(call.request);\n\n            // If the request has an id, it should handle returns (otherwise it's a notify).\n            if ('id' in call.request) {\n                handlers[call.request.id] = {\n                    success_cb : call.success_cb,\n                    error_cb   : call.error_cb\n                };\n            }\n        }\n\n        success_cb = function(data) { self._batchCb(data, handlers, self.all_done_cb); };\n\n        // No WebSocket, and no HTTP backend?  This won't work.\n        if (self.jsonrpcclient.options.ajaxUrl === null) {\n            throw \"$.JsonRpcClient.batch used with no websocket and no http endpoint.\";\n        }\n\n        // Send request\n        $.ajax({\n            url      : self.jsonrpcclient.options.ajaxUrl,\n            data     : $.toJSON(batch_request),\n            dataType : 'json',\n            cache    : false,\n            type     : 'POST',\n\n            // Batch-requests should always return 200\n            error    : function(jqXHR, textStatus, errorThrown) {\n                self.error_cb(jqXHR, textStatus, errorThrown);\n            },\n            success  : success_cb\n        });\n    };\n\n    /**\n     * Internal helper to match the result array from a batch call to their respective callbacks.\n     *\n     * @fn _batchCb\n     * @memberof $.JsonRpcClient\n     */\n    $.JsonRpcClient._batchObject.prototype._batchCb = function(result, handlers, all_done_cb) {\n        for (var i = 0; i < result.length; i++) {\n            var response = result[i];\n\n            // Handle error\n            if ('error' in response) {\n                if (response.id === null || !(response.id in handlers)) {\n                    // An error on a notify?  Just log it to the console.\n                    if ('console' in window) console.log(response);\n                } else {\n                    handlers[response.id].error_cb(response.error, this);\n                }\n            } else {\n                // Here we should always have a correct id and no error.\n                if (!(response.id in handlers) && 'console' in window) {\n                    console.log(response);\n                } else {\n                    handlers[response.id].success_cb(response.result, this);\n                }\n            }\n        }\n\n        if (typeof all_done_cb === 'function') all_done_cb(result);\n    };\n\n})(jQuery);\n\n/*\n * Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n * Copyright (C) 2005-2014, Anthony Minessale II <anthm@freeswitch.org>\n *\n * Version: MPL 1.1\n *\n * The contents of this file are subject to the Mozilla Public License Version\n * 1.1 (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n * http://www.mozilla.org/MPL/\n *\n * Software distributed under the License is distributed on an \"AS IS\" basis,\n * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n * for the specific language governing rights and limitations under the\n * License.\n *\n * The Original Code is Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n *\n * The Initial Developer of the Original Code is\n * Anthony Minessale II <anthm@freeswitch.org>\n * Portions created by the Initial Developer are Copyright (C)\n * the Initial Developer. All Rights Reserved.\n *\n * Contributor(s):\n *\n * Anthony Minessale II <anthm@freeswitch.org>\n *\n * jquery.FSRTC.js - WebRTC Glue code\n *\n */\n\n(function($) {\n\n    // Find the line in sdpLines that starts with |prefix|, and, if specified,\n    // contains |substr| (case-insensitive search).\n    function findLine(sdpLines, prefix, substr) {\n        return findLineInRange(sdpLines, 0, -1, prefix, substr);\n    }\n\n    // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\n    // and, if specified, contains |substr| (case-insensitive search).\n    function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\n        var realEndLine = (endLine != -1) ? endLine : sdpLines.length;\n        for (var i = startLine; i < realEndLine; ++i) {\n            if (sdpLines[i].indexOf(prefix) === 0) {\n                if (!substr || sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\n                    return i;\n                }\n            }\n        }\n        return null;\n    }\n\n    // Gets the codec payload type from an a=rtpmap:X line.\n    function getCodecPayloadType(sdpLine) {\n        var pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\n        var result = sdpLine.match(pattern);\n        return (result && result.length == 2) ? result[1] : null;\n    }\n    \n    // Returns a new m= line with the specified codec as the first one.\n    function setDefaultCodec(mLine, payload) {\n        var elements = mLine.split(' ');\n        var newLine = [];\n        var index = 0;\n        for (var i = 0; i < elements.length; i++) {\n            if (index === 3) { // Format of media starts from the fourth.\n                newLine[index++] = payload; // Put target payload to the first.\n            }\n            if (elements[i] !== payload) newLine[index++] = elements[i];\n        }\n        return newLine.join(' ');\n    }\n\n    $.FSRTC = function(options) {\n        this.options = $.extend({\n            useVideo: null,\n            useStereo: false,\n            userData: null,\n\t    localVideo: null,\n\t    screenShare: false,\n\t    useCamera: \"any\",\n            iceServers: false,\n            videoParams: {},\n            audioParams: {},\n            callbacks: {\n                onICEComplete: function() {},\n                onICE: function() {},\n                onOfferSDP: function() {}\n            },\n      useStream: null,\n        }, options);\n\n\tthis.audioEnabled = true;\n\tthis.videoEnabled = true;\n\n\n        this.mediaData = {\n            SDP: null,\n            profile: {},\n            candidateList: []\n        };\n\n\tthis.constraints = {\n\t    offerToReceiveAudio: this.options.useSpeak === \"none\" ? false : true,\n\t    offerToReceiveVideo: this.options.useVideo ? true : false,\n\t};\n\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'none';\n        }\n\n        setCompat();\n        checkCompat();\n    };\n\n    $.FSRTC.validRes = [];\n\n    $.FSRTC.prototype.useVideo = function(obj, local) {\n        var self = this;\n\n        if (obj) {\n            self.options.useVideo = obj;\n\t    self.options.localVideo = local;\n\t    self.constraints.offerToReceiveVideo = true;\n        } else {\n            self.options.useVideo = null;\n\t    self.options.localVideo = null;\n\t    self.constraints.offerToReceiveVideo = false;\n        }\n\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'none';\n        }\n    };\n\n    $.FSRTC.prototype.useStereo = function(on) {\n        var self = this;\n        self.options.useStereo = on;\n    };\n\n    // Sets Opus in stereo if stereo is enabled, by adding the stereo=1 fmtp param.\n    $.FSRTC.prototype.stereoHack = function(sdp) {\n        var self = this;\n\n        if (!self.options.useStereo) {\n            return sdp;\n        }\n\n        var sdpLines = sdp.split('\\r\\n');\n\n        // Find opus payload.\n        var opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000'), opusPayload;\n\n        if (!opusIndex) {\n\t    return sdp;\n\t} else {\n            opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\n        }\n\n        // Find the payload in fmtp line.\n        var fmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + opusPayload.toString());\n\n        if (fmtpLineIndex === null) {\n\t    // create an fmtp line\n\t    sdpLines[opusIndex] = sdpLines[opusIndex] + '\\r\\na=fmtp:' + opusPayload.toString() + \" stereo=1; sprop-stereo=1\"\n\t} else {\n            // Append stereo=1 to fmtp line.\n            sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\n\t}\n\n        sdp = sdpLines.join('\\r\\n');\n        return sdp;\n    };\n\n    function setCompat() {\n    }\n\n    function checkCompat() {\n        return true;\n    }\n\n    function onStreamError(self, e) {\n        console.log('There has been a problem retrieving the streams - did you allow access? Check Device Resolution', e);\n        doCallback(self, \"onError\", e);\n    }\n\n    function onStreamSuccess(self, stream) {\n        console.log(\"Stream Success\");\n        doCallback(self, \"onStream\", stream);\n    }\n\n    function onRemoteStreamSuccess(self, stream) {\n      console.log(\"Remote Stream Success\");\n      doCallback(self, \"onRemoteStream\", stream);\n    }\n\n    function onICE(self, candidate) {\n        self.mediaData.candidate = candidate;\n        self.mediaData.candidateList.push(self.mediaData.candidate);\n\n        doCallback(self, \"onICE\");\n    }\n\n    function doCallback(self, func, arg) {\n        if (func in self.options.callbacks) {\n            self.options.callbacks[func](self, arg);\n        }\n    }\n\n    function onICEComplete(self, candidate) {\n        console.log(\"ICE Complete\");\n        doCallback(self, \"onICEComplete\");\n    }\n\n    function onChannelError(self, e) {\n        console.error(\"Channel Error\", e);\n        doCallback(self, \"onError\", e);\n    }\n\n    function onICESDP(self, sdp) {\n        self.mediaData.SDP = self.stereoHack(sdp.sdp);\n        console.log(\"ICE SDP\");\n        doCallback(self, \"onICESDP\");\n    }\n\n    function onAnswerSDP(self, sdp) {\n        self.answer.SDP = self.stereoHack(sdp.sdp);\n        console.log(\"ICE ANSWER SDP\");\n        doCallback(self, \"onAnswerSDP\", self.answer.SDP);\n    }\n\n    function onMessage(self, msg) {\n        console.log(\"Message\");\n        doCallback(self, \"onICESDP\", msg);\n    }\n\n    FSRTCattachMediaStream = function(element, stream) {\n        if (typeof element.srcObject !== 'undefined') {\n\t    element.srcObject = stream;\n\t} else {\n\t    console.error('Error attaching stream to element.');\n\t}\n    }\n    \n    function onRemoteStream(self, stream) {\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'block';\n\n\t    // Hacks for Mobile Safari\n\t    var iOS = ['iPad', 'iPhone', 'iPod'].indexOf(navigator.platform) >= 0;\n\n\t    if (iOS) {\n\t\tself.options.useVideo.setAttribute(\"playsinline\", true);\n\t    }\n        }\n\n        var element = self.options.useAudio;\n        console.log(\"REMOTE STREAM\", stream, element);\n\n\tFSRTCattachMediaStream(element, stream);\n\t\n\n\t\n        //self.options.useAudio.play();\n        self.remoteStream = stream;\n        onRemoteStreamSuccess(self, stream);\n    }\n\n    function onOfferSDP(self, sdp) {\n        self.mediaData.SDP = self.stereoHack(sdp.sdp);\n        console.log(\"Offer SDP\");\n        doCallback(self, \"onOfferSDP\");\n    }\n\n    $.FSRTC.prototype.answer = function(sdp, onSuccess, onError) {\n        this.peer.addAnswerSDP({\n            type: \"answer\",\n            sdp: sdp\n        },\n        onSuccess, onError);\n    };\n\n    $.FSRTC.prototype.stopPeer = function() {\n        if (self.peer) {\n            console.log(\"stopping peer\");\n            self.peer.stop();\n        }\n    }\n\n    $.FSRTC.prototype.stop = function() {\n        var self = this;\n\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'none';\n            self.options.useVideo['src'] = '';\n        }\n\n        if (self.localStream && !self.options.useStream) {\n            if(typeof self.localStream.stop == 'function') {\n                self.localStream.stop();\n            } else {\n\t\tif (self.localStream.active){\n                    var tracks = self.localStream.getTracks();\n                    console.log(tracks);\n\t\t    tracks.forEach(function(track, index){\n\t\t\tconsole.log(track);\n\t\t\ttrack.stop();\n\t\t    })\n                }\n            }\n            self.localStream = null;\n        }\n\n        if (self.options.localVideo) {\n      deactivateLocalVideo(self.options.localVideo);\n        }\n\n\tif (self.options.localVideoStream && !self.options.useStream) {\n            if(typeof self.options.localVideoStream.stop == 'function') {\n\t        self.options.localVideoStream.stop();\n            } else {\n\t\tif (self.options.localVideoStream.active){\n                    var tracks = self.options.localVideoStream.getTracks();\n                    console.log(tracks);\n\t\t    tracks.forEach(function(track, index){\n\t\t\tconsole.log(track);\n\t\t\ttrack.stop();\n\t\t    })\n                }\n            }\n        }\n\n        if (self.peer) {\n            console.log(\"stopping peer\");\n            self.peer.stop();\n        }\n    };\n\n    $.FSRTC.prototype.getMute = function() {\n\tvar self = this;\n\treturn self.audioEnabled;\n    }\n\n    $.FSRTC.prototype.setMute = function(what) {\n\tvar self = this;\n    if (!self.localStream) {\n        return false;\n    }\n\tvar audioTracks = self.localStream.getAudioTracks();\t\n\n\tfor (var i = 0, len = audioTracks.length; i < len; i++ ) {\n\t    switch(what) {\n\t    case \"on\":\n\t\taudioTracks[i].enabled = true;\n\t\tbreak;\n\t    case \"off\":\n\t\taudioTracks[i].enabled = false;\n\t\tbreak;\n\t    case \"toggle\":\n\t\taudioTracks[i].enabled = !audioTracks[i].enabled;\n\t    default:\n\t\tbreak;\n\t    }\n\n\t    self.audioEnabled = audioTracks[i].enabled;\n\t}\n\n\treturn !self.audioEnabled;\n    }\n\n    $.FSRTC.prototype.getVideoMute = function() {\n\tvar self = this;\n\treturn self.videoEnabled;\n    }\n\n    $.FSRTC.prototype.setVideoMute = function(what) {\n\tvar self = this;\n    if (!self.localStream) {\n        return false;\n    }\n\tvar videoTracks = self.localStream.getVideoTracks();\t\n\n\tfor (var i = 0, len = videoTracks.length; i < len; i++ ) {\n\t    switch(what) {\n\t    case \"on\":\n\t\tvideoTracks[i].enabled = true;\n\t\tbreak;\n\t    case \"off\":\n\t\tvideoTracks[i].enabled = false;\n\t\tbreak;\n\t    case \"toggle\":\n\t\tvideoTracks[i].enabled = !videoTracks[i].enabled;\n\t    default:\n\t\tbreak;\n\t    }\n\n\t    self.videoEnabled = videoTracks[i].enabled;\n\t}\n\n\treturn !self.videoEnabled;\n    }\n\n    $.FSRTC.prototype.createAnswer = function(params) {\n        var self = this;\n        self.type = \"answer\";\n        self.remoteSDP = params.sdp;\n        console.debug(\"inbound sdp: \", params.sdp);\n\n        function onSuccess(stream) {\n            self.localStream = stream;\n\n            self.peer = FSRTCPeerConnection({\n                type: self.type,\n                attachStream: self.localStream,\n                onICE: function(candidate) {\n                    return onICE(self, candidate);\n                },\n                onICEComplete: function() {\n                    return onICEComplete(self);\n                },\n                onRemoteStream: function(stream) {\n                    return onRemoteStream(self, stream);\n                },\n                onICESDP: function(sdp) {\n                    return onICESDP(self, sdp);\n                },\n                onChannelError: function(e) {\n                    return onChannelError(self, e);\n                },\n                constraints: self.constraints,\n                iceServers: self.options.iceServers,\n                offerSDP: {\n                    type: \"offer\",\n                    sdp: self.remoteSDP\n                },\n                turnServer: self.options.turnServer\n            });\n\n            onStreamSuccess(self, stream);\n        }\n\n        function onError(e) {\n            onStreamError(self, e);\n        }\n\n\tvar mediaParams = getMediaParams(self);\n\n\tconsole.log(\"Audio constraints\", mediaParams.audio);\n\tconsole.log(\"Video constraints\", mediaParams.video);\n\n    if (self.options.useVideo && self.options.localVideo && !self.options.useStream) {\n            getUserMedia({\n\t\tconstraints: {\n                    audio: false,\n                    video: { deviceId: params.useCamera },\n\t\t},\n        localVideo: self.options.localVideo,\n        useCameraLabel: self.options.useCameraLabel,\n        useMicLabel: self.options.useMicLabel,\n\t\tonsuccess: function(e) {self.options.localVideoStream = e; console.log(\"local video ready\");},\n\t\tonerror: function(e) {console.error(\"local video error!\", e);}\n            });\n\t}\n\n    if (self.options.useStream) {\n      if (self.options.useVideo) {\n        self.options.localVideoStream = self.options.useStream;\n        if (self.options.localVideo) {\n          activateLocalVideo(self.options.localVideo, self.options.useStream);\n        }\n      }\n      onSuccess(self.options.useStream);\n    }\n    else {\n      getUserMedia({\n        constraints: {\n          audio: mediaParams.audio,\n          video: mediaParams.video\n        },\n        video: mediaParams.useVideo,\n        useCameraLabel: self.options.useCameraLabel,\n        useMicLabel: self.options.useMicLabel,\n        onsuccess: onSuccess,\n        onerror: onError\n      });\n    }\n\n    };\n\n    function getMediaParams(obj) {\n\n\tvar audio;\n\n\tif (obj.options.useMic && obj.options.useMic === \"none\") {\n\t    console.log(\"Microphone Disabled\");\n\t    audio = false;\n\t} else if (obj.options.videoParams && obj.options.screenShare) {//obj.options.videoParams.chromeMediaSource == 'desktop') {\n\t    console.error(\"SCREEN SHARE\", obj.options.videoParams);\n\t    audio = false;\n\t} else {\n\t    audio = {\n\t    };\n\n\t    if (obj.options.audioParams) {\n\t        audio = obj.options.audioParams;\n            }\n\n\t    if (obj.options.useMic !== \"any\") {\n\t\t//audio.optional = [{sourceId: obj.options.useMic}];\n\t\taudio.deviceId = assignMediaIdToConstraint(obj.options.useMic);\n\t    }\n\t}\n\n    if (obj.options.useVideo && obj.options.localVideo && !obj.options.useStream) {\n            getUserMedia({\n\t\tconstraints: {\n                    audio: false,\n                    video: { deviceId: obj.options.useCamera },\n\t\t},\n        localVideo: obj.options.localVideo,\n        useCameraLabel: obj.options.useCameraLabel,\n        useMicLabel: obj.options.useMicLabel,\n\t\tonsuccess: function(e) {obj.options.localVideoStream = e; console.log(\"local video ready\");},\n\t\tonerror: function(e) {console.error(\"local video error!\", e); }\n            });\n\t}\n\n\tvar video = {};\n\tvar bestFrameRate = obj.options.videoParams.vertoBestFrameRate;\n\tvar minFrameRate = obj.options.videoParams.minFrameRate || 15;\n\tdelete obj.options.videoParams.vertoBestFrameRate;\n\n\tif (obj.options.screenShare) {\n\t    if (!obj.options.useCamera && !!navigator.mozGetUserMedia) {\n\t\t//This is an issue, only FireFox needs to ask this additional question if its screen or window we need a better way\n\t\tvar dowin = window.confirm(\"Do you want to share an application window?  If not you can share an entire screen.\");\n\n\t\tvideo = {\n\t\t    width: {min: obj.options.videoParams.minWidth, max: obj.options.videoParams.maxWidth},\n\t\t    height: {min: obj.options.videoParams.minHeight, max: obj.options.videoParams.maxHeight},\n\t\t    mediaSource: dowin ? \"window\" : \"screen\"\n\t\t}\n\t    } else {\n\t\tvar opt = [];\n\t\tif (obj.options.useCamera) {\n\t\t    opt.push({sourceId: obj.options.useCamera});\n\t\t}\n\t\t\n\t\tif (bestFrameRate) {\n\t\t    opt.push({minFrameRate: bestFrameRate});\n\t\t    opt.push({maxFrameRate: bestFrameRate});\n\t\t}\n\t\t\n\t\tvideo = {\n\t\t    mandatory: obj.options.videoParams,\n\t\t    optional: opt\t\t\n\t\t};\n\t    }\n\t} else {\n\n\t    video = {\n\t\t//mandatory: obj.options.videoParams,\n\t\twidth: {min: obj.options.videoParams.minWidth, max: obj.options.videoParams.maxWidth},\n\t\theight: {min: obj.options.videoParams.minHeight, max: obj.options.videoParams.maxHeight}\n\t    };\n\t    \n            \n\t    \n\t    var useVideo = obj.options.useVideo;\n\n\t    if (useVideo && obj.options.useCamera && obj.options.useCamera !== \"none\") {\n\t\t//if (!video.optional) {\n\t\t//video.optional = [];\n\t\t//}\n\n\t\t\n\t\tif (obj.options.useCamera !== \"any\") {\n\t\t    //video.optional.push({sourceId: obj.options.useCamera});\n        video = assignMediaIdToConstraint(obj.options.useCamera, video);\n\t\t}\n\n\t\tif (bestFrameRate) {\n\t\t    //video.optional.push({minFrameRate: bestFrameRate});\n\t\t    //video.optional.push({maxFrameRate: bestFrameRate});\n\t\t    video.frameRate = {ideal: bestFrameRate, min: minFrameRate, max: 30};\n\t\t}\n\n\t    } else {\n\t\tconsole.log(\"Camera Disabled\");\n\t\tvideo = false;\n\t\tuseVideo = false;\n\t    }\n\t}\n\n\treturn {audio: audio, video: video, useVideo: useVideo};\n    }\n    \n    $.FSRTC.prototype.call = function(profile) {\n        checkCompat();\n\t\n        var self = this;\n\tvar screen = false;\n\n        self.type = \"offer\";\n\n\tif (self.options.videoParams && self.options.screenShare) { //self.options.videoParams.chromeMediaSource == 'desktop') {\n\t    screen = true;\n\t}\n\n        function onSuccess(stream) {\n\t    self.localStream = stream;\n\t    \n\t    if (screen) {\n\t\tself.constraints.offerToReceiveVideo = false;\n\t\tself.constraints.offerToReceiveAudio = false;\n\t\tself.constraints.offerToSendAudio = false;\n\t    }\n\t    \n            self.peer = FSRTCPeerConnection({\n                type: self.type,\n                attachStream: self.localStream,\n                onICE: function(candidate) {\n                    return onICE(self, candidate);\n                },\n                onICEComplete: function() {\n                    return onICEComplete(self);\n                },\n                onRemoteStream: screen ? function(stream) {} : function(stream) {\n                    return onRemoteStream(self, stream);\n                },\n                onOfferSDP: function(sdp) {\n                    return onOfferSDP(self, sdp);\n                },\n                onICESDP: function(sdp) {\n                    return onICESDP(self, sdp);\n                },\n                onChannelError: function(e) {\n                    return onChannelError(self, e);\n                },\n                constraints: self.constraints,\n                iceServers: self.options.iceServers,\n                turnServer: self.options.turnServer\n            });\n\n            onStreamSuccess(self, stream);\n        }\n\n        function onError(e) {\n            onStreamError(self, e);\n        }\n\n\tvar mediaParams = getMediaParams(self);\n\n\tconsole.log(\"Audio constraints\", mediaParams.audio);\n\tconsole.log(\"Video constraints\", mediaParams.video);\n\n    if (self.options.useStream) {\n      if (self.options.useVideo) {\n        self.options.localVideoStream = self.options.useStream;\n        if (self.options.localVideo) {\n          activateLocalVideo(self.options.localVideo, self.options.useStream);\n        }\n      }\n      onSuccess(self.options.useStream);\n    }\n    else if (mediaParams.audio || mediaParams.video) {\n            getUserMedia({\n\t\tconstraints: {\n                    audio: mediaParams.audio,\n                    video: mediaParams.video\n\t\t},\n\t\tvideo: mediaParams.useVideo,\n\t\tonsuccess: onSuccess,\n        onerror: onError,\n        useCameraLabel: self.options.useCameraLabel,\n        useMicLabel: self.options.useMicLabel,\n            });\n\n\t} else {\n\t    onSuccess(null);\n\t}\n\n\n\n        /*\n        navigator.getUserMedia({\n            video: self.options.useVideo,\n            audio: true\n        }, onSuccess, onError);\n        */\n\n    };\n\n    // DERIVED from RTCPeerConnection-v1.5\n    // 2013, @muazkh - github.com/muaz-khan\n    // MIT License - https://www.webrtc-experiment.com/licence/\n    // Documentation - https://github.com/muaz-khan/WebRTC-Experiment/tree/master/RTCPeerConnection\n    \n    function FSRTCPeerConnection(options) {\n\tvar gathering = false, done = false;\n\tvar config = {};\n        var default_ice = [{ urls: ['stun:stun.l.google.com:19302'] }];\n\n        if (self.options.turnServer) {\n          default_ice.push(self.options.turnServer)\n        }\n\n        if (options.iceServers) {\n            if (typeof(options.iceServers) === \"boolean\") {\n\t\tconfig.iceServers = default_ice;\n            } else {\n\t\tconfig.iceServers = options.iceServers;\n\t    }\n        }\n\n\tconfig.bundlePolicy = \"max-compat\";\n\tconfig.sdpSemantics = \"plan-b\";\n\n        var peer = new window.RTCPeerConnection(config);\n\n        openOffererChannel();\n        var x = 0;\n\n\tfunction ice_handler() {\n\n\t    done = true;\n\t    gathering = null;\n\n            if (options.onICEComplete) {\n                options.onICEComplete();\n            }\n\t    \n            if (options.type == \"offer\") {\n                options.onICESDP(peer.localDescription);\n            } else {\n                if (!x && options.onICESDP) {\n                    options.onICESDP(peer.localDescription);\n                }\n            }\n        }\n\n        peer.onicecandidate = function(event) {\n\n\t    if (done) {\n\t\treturn;\n\t    }\n\n\t    if (!gathering) {\n\t\tgathering = setTimeout(ice_handler, 1000);\n\t    }\n\t    \n\t    if (event) {\n\t\tif (event.candidate) {\n\t\t    options.onICE(event.candidate);\n\t\t}\n\t    } else {\n\t\tdone = true;\n\n\t\tif (gathering) {\n\t\t    clearTimeout(gathering);\n\t\t    gathering = null;\n\t\t}\n\n\t\tice_handler();\n\t    }\n        };\n\n        // attachStream = MediaStream;\n        if (options.attachStream) {\n          // FreeSWITCH currently orders its answer SDP such that audio m-lines\n          // always come first, adding the tracks to the peer in that order\n          // prevents possible m-line ordering validation errors on the client.\n          options.attachStream.getAudioTracks().forEach(function(track) { peer.addTrack(track, options.attachStream) });\n          options.attachStream.getVideoTracks().forEach(function(track) { peer.addTrack(track, options.attachStream) });\n        }\n\n        // attachStreams[0] = audio-stream;\n        // attachStreams[1] = video-stream;\n        // attachStreams[2] = screen-capturing-stream;\n        if (options.attachStreams && options.attachStreams.length) {\n            var streams = options.attachStreams;\n            for (var i = 0; i < streams.length; i++) {\n                peer.addStream(streams[i]);\n            }\n        }\n\n        peer.onaddstream = function(event) {\n            var remoteMediaStream = event.stream;\n\n            // onRemoteStreamEnded(MediaStream)\n            remoteMediaStream.oninactive = function () {\n                if (options.onRemoteStreamEnded) options.onRemoteStreamEnded(remoteMediaStream);\n            };\n\n            // onRemoteStream(MediaStream)\n            if (options.onRemoteStream) options.onRemoteStream(remoteMediaStream);\n\n            //console.debug('on:add:stream', remoteMediaStream);\n        };\n\n        //var constraints = options.constraints || {\n\t  //  offerToReceiveAudio: true,\n\t    //offerToReceiveVideo: true   \n        //};\n\n        // onOfferSDP(RTCSessionDescription)\n        function createOffer() {\n            if (!options.onOfferSDP) return;\n\n            peer.createOffer(function(sessionDescription) {\n                sessionDescription.sdp = serializeSdp(sessionDescription.sdp);\n                peer.setLocalDescription(sessionDescription);\n                options.onOfferSDP(sessionDescription);\n            },\n\t\t\t\tonSdpError, options.constraints);\n        }\n\n        // onAnswerSDP(RTCSessionDescription)\n        function createAnswer() {\n            if (options.type != \"answer\") return;\n\n            //options.offerSDP.sdp = addStereo(options.offerSDP.sdp);\n            peer.setRemoteDescription(new window.RTCSessionDescription(options.offerSDP), onSdpSuccess, onSdpError);\n            peer.createAnswer(function(sessionDescription) {\n                sessionDescription.sdp = serializeSdp(sessionDescription.sdp);\n                peer.setLocalDescription(sessionDescription);\n                if (options.onAnswerSDP) {\n                    options.onAnswerSDP(sessionDescription);\n                }\n            },\n            onSdpError);\n        }\n\n\n        if ((options.onChannelMessage) || !options.onChannelMessage) {\n            createOffer();\n            createAnswer();\n        }\n\n        // DataChannel Bandwidth\n        function setBandwidth(sdp) {\n            // remove existing bandwidth lines\n            sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n            sdp = sdp.replace(/a=mid:data\\r\\n/g, 'a=mid:data\\r\\nb=AS:1638400\\r\\n');\n\n            return sdp;\n        }\n\n        // old: FF<>Chrome interoperability management\n        function getInteropSDP(sdp) {\n            var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''),\n            extractedChars = '';\n\n            function getChars() {\n                extractedChars += chars[parseInt(Math.random() * 40)] || '';\n                if (extractedChars.length < 40) getChars();\n\n                return extractedChars;\n            }\n\n            // usually audio-only streaming failure occurs out of audio-specific crypto line\n            // a=crypto:1 AES_CM_128_HMAC_SHA1_32 --------- kAttributeCryptoVoice\n            if (options.onAnswerSDP) sdp = sdp.replace(/(a=crypto:0 AES_CM_128_HMAC_SHA1_32)(.*?)(\\r\\n)/g, '');\n\n            // video-specific crypto line i.e. SHA1_80\n            // a=crypto:1 AES_CM_128_HMAC_SHA1_80 --------- kAttributeCryptoVideo\n            var inline = getChars() + '\\r\\n' + (extractedChars = '');\n            sdp = sdp.indexOf('a=crypto') == -1 ? sdp.replace(/c=IN/g, 'a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:' + inline + 'c=IN') : sdp;\n\n            return sdp;\n        }\n\n        function serializeSdp(sdp) {\n            return sdp;\n        }\n\n        // DataChannel management\n        var channel;\n\n        function openOffererChannel() {\n            if (!options.onChannelMessage) return;\n\n            _openOffererChannel();\n\n            return;\n        }\n\n        function _openOffererChannel() {\n            channel = peer.createDataChannel(options.channel || 'RTCDataChannel', {\n                reliable: false\n            });\n\n            setChannelEvents();\n        }\n\n        function setChannelEvents() {\n            channel.onmessage = function(event) {\n                if (options.onChannelMessage) options.onChannelMessage(event);\n            };\n\n            channel.onopen = function() {\n                if (options.onChannelOpened) options.onChannelOpened(channel);\n            };\n            channel.onclose = function(event) {\n                if (options.onChannelClosed) options.onChannelClosed(event);\n\n                console.warn('WebRTC DataChannel closed', event);\n            };\n            channel.onerror = function(event) {\n                if (options.onChannelError) options.onChannelError(event);\n\n                console.error('WebRTC DataChannel error', event);\n            };\n        }\n\n        function openAnswererChannel() {\n            peer.ondatachannel = function(event) {\n                channel = event.channel;\n                channel.binaryType = 'blob';\n                setChannelEvents();\n            };\n\n            return;\n        }\n\n        // fake:true is also available on chrome under a flag!\n        function useless() {\n            log('Error in fake:true');\n        }\n\n        function onSdpSuccess() {}\n\n        function onSdpError(e) {\n            if (options.onChannelError) {\n                options.onChannelError(e);\n            }\n            console.error('sdp error:', e);\n        }\n\n        return {\n            addAnswerSDP: function(sdp, cbSuccess, cbError) {\n\n                peer.setRemoteDescription(new window.RTCSessionDescription(sdp), cbSuccess ? cbSuccess : onSdpSuccess, cbError ? cbError : onSdpError);\n            },\n            addICE: function(candidate) {\n                peer.addIceCandidate(new window.RTCIceCandidate({\n                    sdpMLineIndex: candidate.sdpMLineIndex,\n                    candidate: candidate.candidate\n                }));\n            },\n\n            peer: peer,\n            channel: channel,\n            sendData: function(message) {\n                if (channel) {\n                    channel.send(message);\n                }\n            },\n\n            stop: function() {\n                peer.close();\n                if (options.attachStream) {\n                  if(typeof options.attachStream.stop == 'function') {\n                    options.attachStream.stop();\n                  } else {\n                    options.attachStream.active = false;\n                  }\n                }\n            }\n\n        };\n    }\n\n    // getUserMedia\n    var video_constraints = {\n        //mandatory: {},\n        //optional: []\n    };\n\n  function activateLocalVideo(el, stream) {\n    el.srcObject = stream;\n    el.style.display = 'block';\n  }\n\n  function deactivateLocalVideo(el) {\n    el.srcObject = null;\n    el.style.display = 'none';\n  }\n\n    function assureConstraintByLabel(constraint, fallbackLabel) {\n        if (fallbackLabel === undefined && constraint === undefined) {\n            return Promise.resolve(constraint);\n        }\n\n        if (typeof(assureMediaInputId) !== 'function') {\n            console.warn('Tried to use constraint fallbacks but did not found vendor function `assureMediaInputId` on window scope. Did you forget to import `vendor/media-device-id.js` before Verto?');\n            return Promise.resolve(constraint);\n        }\n\n        if (typeof(constraint) === 'object' && !constraint.deviceId) {\n            return Promise.resolve(constraint);\n        }\n\n        if (constraint.deviceId) {\n            if (typeof(constraint.deviceId) === 'string') {\n                return new Promise(function(resolve) {\n                    assureMediaInputId(fallbackLabel, constraint.deviceId).then(function(id) {\n                        resolve(Object.assign({}, constraint, { deviceId: id }));\n                    }).catch(function() {\n                        resolve(constraint);\n                    });\n                });\n            }\n\n            if (typeof(constraint.deviceId) === 'object' && typeof(constraint.deviceId.exact) === 'string') {\n                return new Promise(function(resolve) {\n                    assureMediaInputId(fallbackLabel, constraint.deviceId.exact).then(function(id) {\n                        resolve(assignMediaIdToConstraint(id, constraint));\n                    }).catch(function() {\n                        resolve(constraint);\n                    });\n                });\n            }\n        }\n\n        return Promise.resolve(constraint);\n    }\n\n    function trustyGetUserMedia(options, constraints) {\n        navigator.mediaDevices.getUserMedia(constraints).then(function(stream) {\n            if (options.localVideo) {\n                activateLocalVideo(options.localVideo, stream);\n            }\n\n            if (options.onsuccess) {\n                options.onsuccess(stream);\n            }\n        }).catch(options.onerror || function(e) {\n            console.error(e);\n        });\n    }\n\n    function assignMediaIdToConstraint(mediaId, rest) {\n        return Object.assign({}, rest || {}, { deviceId: { exact: mediaId } });\n    }\n\n    function getUserMedia(options) {\n        var constraints = options.constraints || {\n            audio: true,\n            video: video_constraints,\n        };\n\n        Promise.all([\n            assureConstraintByLabel(constraints.audio, options.useMicLabel),\n            assureConstraintByLabel(constraints.video, options.useCameraLabel),\n        ]).then(function(assurances) {\n            trustyGetUserMedia(options, { audio: assurances[0], video: assurances[1] });\n        }).catch(function(error) {\n            console.error('Unexpected error on media id assurance attempts:', error, 'Options:', options);\n        });\n    }\n\n    $.FSRTC.resSupported = function(w, h) {\n\tfor (var i in $.FSRTC.validRes) {\n\t    if ($.FSRTC.validRes[i][0] == w && $.FSRTC.validRes[i][1] == h) {\n\t\treturn true;\n\t    }\n\t}\n\n\treturn false;\n    }\n\n    $.FSRTC.bestResSupported = function() {\n\tvar w = 0, h = 0;\n\n\tfor (var i in $.FSRTC.validRes) {\n\t    if ($.FSRTC.validRes[i][0] >= w && $.FSRTC.validRes[i][1] >= h) {\n\t\tw = $.FSRTC.validRes[i][0];\n\t\th = $.FSRTC.validRes[i][1];\n\t    }\n\t}\n\n\treturn [w, h];\n    }\n\n    var resList = [[160, 120], [320, 180], [320, 240], [640, 360], [640, 480], [1280, 720], [1920, 1080]];\n    var resI = 0;\n    var ttl = 0;\n\n    var checkRes = function (cam, func) {\n\n\tif (resI >= resList.length) {\n            var res = {\n               'validRes': $.FSRTC.validRes,\n               'bestResSupported': $.FSRTC.bestResSupported()\n            };\n\t    \n\t    localStorage.setItem(\"res_\" + cam, $.toJSON(res));\n\t    \n\t    if (func) return func(res);\n\t    return;\n\t}\n\n\tw = resList[resI][0];\n\th = resList[resI][1];\n\tresI++;\n\n\tvar video = {\n\t    width: {exact: w},\n\t    height: {exact: h}\n\t};\n\n  if (cam !== \"any\") {\n    video = assignMediaIdToConstraint(cam, video);\n  }\n\n\tgetUserMedia({\n\t    constraints: {\n                audio: ttl++ == 0,\n                video: video\t    \n\t    },\n\t    onsuccess: function(e) {\n\t\te.getTracks().forEach(function(track) {track.stop();});\n\t\tconsole.info(w + \"x\" + h + \" supported.\"); $.FSRTC.validRes.push([w, h]); checkRes(cam, func);},\n\t    onerror: function(e) {console.warn( w + \"x\" + h + \" not supported.\"); checkRes(cam, func);}\n        });\n    }\n    \n\n    $.FSRTC.getValidRes = function (cam, func) {\n\tvar used = [];\n\tvar cached = localStorage.getItem(\"res_\" + cam);\n\t\n\tif (cached) {\n\t    var cache = $.parseJSON(cached);\n\n\t    if (cache) {\n\t\t$.FSRTC.validRes = cache.validRes;\n\t\tconsole.log(\"CACHED RES FOR CAM \" + cam, cache);\n\t    } else {\n\t\tconsole.error(\"INVALID CACHE\");\n\t    }\n\t    return func ? func(cache) : null;\n\t}\n\n\n\t$.FSRTC.validRes = [];\n\tresI = 0;\n\n\tcheckRes(cam, func);\n    }\n\n    $.FSRTC.checkPerms = function (runtime, check_audio, check_video) {\n\tgetUserMedia({\n\t    constraints: {\n\t\taudio: check_audio,\n\t\tvideo: check_video,\n\t    },\n\t    onsuccess: function(e) {\n\n\t\te.getTracks().forEach(function(track) {track.stop();});\n\t\t\n\t\tconsole.info(\"media perm init complete\"); \n\t\tif (runtime) {\n                    setTimeout(runtime, 100, true);\n\t\t}\n            },\n\t    onerror: function(e) {\n\t\tif (check_video && check_audio) {\n\t\t    console.error(\"error, retesting with audio params only\");\n\t\t    return $.FSRTC.checkPerms(runtime, check_audio, false);\n\t\t}\n\n\t\tconsole.error(\"media perm init error\");\n\n\t\tif (runtime) {\n\t\t    runtime(false)\n\t\t}\n\t    }\n\t});\n    }\n\n})(jQuery);\n\n\n/*\n * Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n * Copyright (C) 2005-2014, Anthony Minessale II <anthm@freeswitch.org>\n *\n * Version: MPL 1.1\n *\n * The contents of this file are subject to the Mozilla Public License Version\n * 1.1 (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n * http://www.mozilla.org/MPL/\n *\n * Software distributed under the License is distributed on an \"AS IS\" basis,\n * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n * for the specific language governing rights and limitations under the\n * License.\n *\n * The Original Code is Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n *\n * The Initial Developer of the Original Code is\n * Anthony Minessale II <anthm@freeswitch.org>\n * Portions created by the Initial Developer are Copyright (C)\n * the Initial Developer. All Rights Reserved.\n *\n * Contributor(s):\n *\n * Anthony Minessale II <anthm@freeswitch.org>\n *\n * jquery.verto.js - Main interface\n *\n */\n\n(function($) {\n    var sources = [];\n\n    var generateGUID = (typeof(window.crypto) !== 'undefined' && typeof(window.crypto.getRandomValues) !== 'undefined') ?\n    function() {\n        // If we have a cryptographically secure PRNG, use that\n        // http://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript\n        var buf = new Uint16Array(8);\n        window.crypto.getRandomValues(buf);\n        var S4 = function(num) {\n            var ret = num.toString(16);\n            while (ret.length < 4) {\n                ret = \"0\" + ret;\n            }\n            return ret;\n        };\n        return (S4(buf[0]) + S4(buf[1]) + \"-\" + S4(buf[2]) + \"-\" + S4(buf[3]) + \"-\" + S4(buf[4]) + \"-\" + S4(buf[5]) + S4(buf[6]) + S4(buf[7]));\n    }\n\n    :\n\n    function() {\n        // Otherwise, just use Math.random\n        // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = Math.random() * 16 | 0,\n            v = c == 'x' ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    };\n\n    /// MASTER OBJ\n    $.verto = function(options, callbacks) {\n        var verto = this;\n\n        $.verto.saved.push(verto);\n\n        verto.options = $.extend({\n            login: null,\n            passwd: null,\n            socketUrl: null,\n            tag: null,\n\t    localTag: null,\n            videoParams: {},\n            audioParams: {},\n\t    loginParams: {},\n\t    deviceParams: {onResCheck: null},\n\t    userVariables: {},\n            iceServers: false,\n            ringSleep: 6000,\n      sessid: null,\n      useStream: null\n        }, options);\n\n\tif (verto.options.deviceParams.useCamera) {\n\t    $.FSRTC.getValidRes(verto.options.deviceParams.useCamera, verto.options.deviceParams.onResCheck);\n\t}\n\n\tif (!verto.options.deviceParams.useMic) {\n\t    verto.options.deviceParams.useMic = \"any\";\n\t}\n\n\tif (!verto.options.deviceParams.useSpeak) {\n\t    verto.options.deviceParams.useSpeak = \"any\";\n\t}\n\n\tif (verto.options.sessid) {\n\t    verto.sessid = verto.options.sessid;\n\t} else {\n            verto.sessid = localStorage.getItem(\"verto_session_uuid\") || generateGUID();\n\t    localStorage.setItem(\"verto_session_uuid\", verto.sessid);\n\t}\n\n        verto.dialogs = {};\n        verto.callbacks = callbacks || {};\n        verto.eventSUBS = {};\n\n        verto.rpcClient = new $.JsonRpcClient({\n            login: verto.options.login,\n            passwd: verto.options.passwd,\n            socketUrl: verto.options.socketUrl,\n            wsFallbackURL: verto.options.wsFallbackURL,\n            turnServer: verto.options.turnServer,\n\t    loginParams: verto.options.loginParams,\n\t    userVariables: verto.options.userVariables,\n            sessid: verto.sessid,\n            onmessage: function(e) {\n                return verto.handleMessage(e.eventData);\n            },\n            onWSConnect: function(o) {\n                o.call('login', {});\n            },\n            onWSLogin: function(success) {\n                if (verto.callbacks.onWSLogin) {\n                    verto.callbacks.onWSLogin(verto, success);\n                }\n            },\n            onWSClose: function(success) {\n                if (verto.callbacks.onWSClose) {\n                    verto.callbacks.onWSClose(verto, success);\n                }\n                verto.purge();\n            }\n        });\n\n        var tag = verto.options.tag;\n        if (typeof(tag) === \"function\") {\n          tag = tag();\n        }\n\n        if (verto.options.ringFile && verto.options.tag) {\n            verto.ringer = $(\"#\" + tag);\n        }\n\n        verto.rpcClient.call('login', {});\n\n    };\n\n\n    $.verto.prototype.deviceParams = function(obj) {\n        var verto = this;\n\n\tfor (var i in obj) {\n            verto.options.deviceParams[i] = obj[i];\n\t}\n\n\tif (obj.useCamera) {\n\t    $.FSRTC.getValidRes(verto.options.deviceParams.useCamera, obj ? obj.onResCheck : undefined);\n\t}\n    };\n\n    $.verto.prototype.videoParams = function(obj) {\n        var verto = this;\n\n\tfor (var i in obj) {\n            verto.options.videoParams[i] = obj[i];\n\t}\n    };\n\n    $.verto.prototype.iceServers = function(obj) {\n        var verto = this;\n        verto.options.iceServers = obj;\n    };\n\n    $.verto.prototype.loginData = function(params) {\n\tvar verto = this;\n        verto.options.login = params.login;\n        verto.options.passwd = params.passwd;\n        verto.rpcClient.loginData(params);\n    };\n\n    $.verto.prototype.logout = function(msg) {\n        var verto = this;\n        verto.rpcClient.closeSocket();\n        if (verto.callbacks.onWSClose) {\n            verto.callbacks.onWSClose(verto, false);\n        }\n        verto.purge();\n    };\n\n    $.verto.prototype.login = function(msg) {\n        var verto = this;\n        verto.logout();\n        verto.rpcClient.call('login', {});\n    };\n\n    $.verto.prototype.message = function(msg) {\n        var verto = this;\n        var err = 0;\n\n        if (!msg.to) {\n            console.error(\"Missing To\");\n            err++;\n        }\n\n        if (!msg.body) {\n            console.error(\"Missing Body\");\n            err++;\n        }\n\n        if (err) {\n            return false;\n        }\n\n        verto.sendMethod(\"verto.info\", {\n            msg: msg\n        });\n\n        return true;\n    };\n\n    $.verto.prototype.processReply = function(method, success, e) {\n        var verto = this;\n        var i;\n\n        //console.log(\"Response: \" + method, success, e);\n\n        switch (method) {\n        case \"verto.subscribe\":\n            for (i in e.unauthorizedChannels) {\n                drop_bad(verto, e.unauthorizedChannels[i]);\n            }\n            for (i in e.subscribedChannels) {\n                mark_ready(verto, e.subscribedChannels[i]);\n            }\n\n            break;\n        case \"verto.unsubscribe\":\n            //console.error(e);\n            break;\n        }\n    };\n\n    $.verto.prototype.sendMethod = function(method, params) {\n        var verto = this;\n\n        verto.rpcClient.call(method, params,\n\n        function(e) {\n            /* Success */\n            verto.processReply(method, true, e);\n        },\n\n        function(e) {\n            /* Error */\n            verto.processReply(method, false, e);\n        });\n    };\n\n    function do_sub(verto, channel, obj) {\n\n    }\n\n    function drop_bad(verto, channel) {\n        console.error(\"drop unauthorized channel: \" + channel);\n        delete verto.eventSUBS[channel];\n    }\n\n    function mark_ready(verto, channel) {\n        for (var j in verto.eventSUBS[channel]) {\n            verto.eventSUBS[channel][j].ready = true;\n            console.log(\"subscribed to channel: \" + channel);\n            if (verto.eventSUBS[channel][j].readyHandler) {\n                verto.eventSUBS[channel][j].readyHandler(verto, channel);\n            }\n        }\n    }\n\n    var SERNO = 1;\n\n    function do_subscribe(verto, channel, subChannels, sparams) {\n        var params = sparams || {};\n\n        var local = params.local;\n\n        var obj = {\n            eventChannel: channel,\n            userData: params.userData,\n            handler: params.handler,\n            ready: false,\n            readyHandler: params.readyHandler,\n            serno: SERNO++\n        };\n\n        var isnew = false;\n\n        if (!verto.eventSUBS[channel]) {\n            verto.eventSUBS[channel] = [];\n            subChannels.push(channel);\n            isnew = true;\n        }\n\n        verto.eventSUBS[channel].push(obj);\n\n        if (local) {\n            obj.ready = true;\n            obj.local = true;\n        }\n\n        if (!isnew && verto.eventSUBS[channel][0].ready) {\n            obj.ready = true;\n            if (obj.readyHandler) {\n                obj.readyHandler(verto, channel);\n            }\n        }\n\n        return {\n            serno: obj.serno,\n            eventChannel: channel\n        };\n\n    }\n\n    $.verto.prototype.subscribe = function(channel, sparams) {\n        var verto = this;\n        var r = [];\n        var subChannels = [];\n        var params = sparams || {};\n\n        if (typeof(channel) === \"string\") {\n            r.push(do_subscribe(verto, channel, subChannels, params));\n        } else {\n            for (var i in channel) {\n                r.push(do_subscribe(verto, channel, subChannels, params));\n            }\n        }\n\n        if (subChannels.length) {\n            verto.sendMethod(\"verto.subscribe\", {\n                eventChannel: subChannels.length == 1 ? subChannels[0] : subChannels,\n                subParams: params.subParams\n            });\n        }\n\n        return r;\n    };\n\n    $.verto.prototype.unsubscribe = function(handle) {\n        var verto = this;\n        var i;\n\n        if (!handle) {\n            for (i in verto.eventSUBS) {\n                if (verto.eventSUBS[i]) {\n                    verto.unsubscribe(verto.eventSUBS[i]);\n                }\n            }\n        } else {\n            var unsubChannels = {};\n            var sendChannels = [];\n            var channel;\n\n            if (typeof(handle) == \"string\") {\n                delete verto.eventSUBS[handle];\n                unsubChannels[handle]++;\n            } else {\n                for (i in handle) {\n                    if (typeof(handle[i]) == \"string\") {\n                        channel = handle[i];\n                        delete verto.eventSUBS[channel];\n                        unsubChannels[channel]++;\n                    } else {\n                        var repl = [];\n                        channel = handle[i].eventChannel;\n\n                        for (var j in verto.eventSUBS[channel]) {\n                            if (verto.eventSUBS[channel][j].serno == handle[i].serno) {} else {\n                                repl.push(verto.eventSUBS[channel][j]);\n                            }\n                        }\n\n                        verto.eventSUBS[channel] = repl;\n\n                        if (verto.eventSUBS[channel].length === 0) {\n                            delete verto.eventSUBS[channel];\n                            unsubChannels[channel]++;\n                        }\n                    }\n                }\n            }\n\n            for (var u in unsubChannels) {\n                console.log(\"Sending Unsubscribe for: \", u);\n                sendChannels.push(u);\n            }\n\n            if (sendChannels.length) {\n                verto.sendMethod(\"verto.unsubscribe\", {\n                    eventChannel: sendChannels.length == 1 ? sendChannels[0] : sendChannels\n                });\n            }\n        }\n    };\n\n    $.verto.prototype.broadcast = function(channel, params) {\n        var verto = this;\n        var msg = {\n            eventChannel: channel,\n            data: {}\n        };\n        for (var i in params) {\n            msg.data[i] = params[i];\n        }\n        verto.sendMethod(\"verto.broadcast\", msg);\n    };\n\n    $.verto.prototype.purge = function(callID) {\n        var verto = this;\n        var x = 0;\n        var i;\n\n        for (i in verto.dialogs) {\n            if (!x) {\n                console.log(\"purging dialogs\");\n            }\n            x++;\n            verto.dialogs[i].setState($.verto.enum.state.purge);\n        }\n\n        for (i in verto.eventSUBS) {\n            if (verto.eventSUBS[i]) {\n                console.log(\"purging subscription: \" + i);\n                delete verto.eventSUBS[i];\n            }\n        }\n    };\n\n    $.verto.prototype.hangup = function(callID) {\n        var verto = this;\n        if (callID) {\n            var dialog = verto.dialogs[callID];\n\n            if (dialog) {\n                dialog.hangup();\n            }\n        } else {\n            for (var i in verto.dialogs) {\n                verto.dialogs[i].hangup();\n            }\n        }\n    };\n\n    $.verto.prototype.newCall = function(args, callbacks) {\n        var verto = this;\n\n        if (!verto.rpcClient.socketReady()) {\n            console.error(\"Not Connected...\");\n            return;\n        }\n\n        if (args[\"useCamera\"]) {\n            verto.options.deviceParams[\"useCamera\"] = args[\"useCamera\"];\n            verto.options.deviceParams[\"useCameraLabel\"] = args[\"useCameraLabel\"];\n        }\n\n        var dialog = new $.verto.dialog($.verto.enum.direction.outbound, this, args);\n\n        if (callbacks) {\n            dialog.callbacks = callbacks;\n        }\n\n        dialog.invite();\n\n        return dialog;\n    };\n\n    $.verto.prototype.handleMessage = function(data) {\n        var verto = this;\n\n        if (!(data && data.method)) {\n            console.error(\"Invalid Data\", data);\n            return;\n        }\n\n        if (data.params.callID) {\n            var dialog = verto.dialogs[data.params.callID];\n\t    \n\t    if (data.method === \"verto.attach\" && dialog) {\n\t\tdelete dialog.verto.dialogs[dialog.callID];\n\t\tdialog.rtc.stop();\n\t\tdialog = null;\n\t    }\n\n            if (dialog) {\n\n                switch (data.method) {\n                case 'verto.bye':\n                    dialog.hangup(data.params);\n                    break;\n                case 'verto.answer':\n                    dialog.handleAnswer(data.params);\n                    break;\n                case 'verto.media':\n                    dialog.handleMedia(data.params);\n                    break;\n                case 'verto.display':\n                    dialog.handleDisplay(data.params);\n                    break;\n                case 'verto.info':\n                    dialog.handleInfo(data.params);\n                    break;\n                default:\n                    console.debug(\"INVALID METHOD OR NON-EXISTANT CALL REFERENCE IGNORED\", dialog, data.method);\n                    break;\n                }\n            } else {\n\n                switch (data.method) {\n                case 'verto.attach':\n                    data.params.attach = true;\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"m=video\") > 0) {\n                        data.params.useVideo = true;\n                    }\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"stereo=1\") > 0) {\n                        data.params.useStereo = true;\n                    }\n\n                    dialog = new $.verto.dialog($.verto.enum.direction.inbound, verto, data.params);\n                    dialog.setState($.verto.enum.state.recovering);\n\n                    break;\n                case 'verto.invite':\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"m=video\") > 0) {\n                        data.params.wantVideo = true;\n                    }\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"stereo=1\") > 0) {\n                        data.params.useStereo = true;\n                    }\n\n                    dialog = new $.verto.dialog($.verto.enum.direction.inbound, verto, data.params);\n                    break;\n                default:\n                    console.debug(\"INVALID METHOD OR NON-EXISTANT CALL REFERENCE IGNORED\");\n                    break;\n                }\n            }\n\n            return {\n                method: data.method\n            };\n        } else {\n            switch (data.method) {\n            case 'verto.punt':\n                verto.purge();\n\t\tverto.logout();\n\t\tbreak;\n            case 'verto.event':\n                var list = null;\n                var key = null;\n\n                if (data.params) {\n                    key = data.params.eventChannel;\n                }\n\n                if (key) {\n                    list = verto.eventSUBS[key];\n\n                    if (!list) {\n                        list = verto.eventSUBS[key.split(\".\")[0]];\n                    }\n                }\n\n                if (!list && key && key === verto.sessid) {\n                    if (verto.callbacks.onMessage) {\n                        verto.callbacks.onMessage(verto, null, $.verto.enum.message.pvtEvent, data.params);\n                    }\n                } else if (!list && key && verto.dialogs[key]) {\n                    verto.dialogs[key].sendMessage($.verto.enum.message.pvtEvent, data.params);\n                } else if (!list) {\n                    if (!key) {\n                        key = \"UNDEFINED\";\n                    }\n                    console.error(\"UNSUBBED or invalid EVENT \" + key + \" IGNORED\");\n                } else {\n                    for (var i in list) {\n                        var sub = list[i];\n\n                        if (!sub || !sub.ready) {\n                            console.error(\"invalid EVENT for \" + key + \" IGNORED\");\n                        } else if (sub.handler) {\n                            sub.handler(verto, data.params, sub.userData);\n                        } else if (verto.callbacks.onEvent) {\n                            verto.callbacks.onEvent(verto, data.params, sub.userData);\n                        } else {\n                            console.log(\"EVENT:\", data.params);\n                        }\n                    }\n                }\n\n                break;\n\n            case \"verto.info\":\n                if (verto.callbacks.onMessage) {\n                    verto.callbacks.onMessage(verto, null, $.verto.enum.message.info, data.params.msg);\n                }\n                //console.error(data);\n                console.debug(\"MESSAGE from: \" + data.params.msg.from, data.params.msg.body);\n\n                break;\n\n            case 'verto.clientReady':\n                if (verto.callbacks.onMessage) {\n                    verto.callbacks.onMessage(verto, null, $.verto.enum.message.clientReady, data.params);\n                }\n                console.debug(\"CLIENT READY\", data.params);\n                break;\n\n            default:\n                console.error(\"INVALID METHOD OR NON-EXISTANT CALL REFERENCE IGNORED\", data.method);\n                break;\n            }\n        }\n    };\n\n    var del_array = function(array, name) {\n        var r = [];\n        var len = array.length;\n\n        for (var i = 0; i < len; i++) {\n            if (array[i] != name) {\n                r.push(array[i]);\n            }\n        }\n\n        return r;\n    };\n\n    var hashArray = function() {\n        var vha = this;\n\n        var hash = {};\n        var array = [];\n\n        vha.reorder = function(a) {\n            array = a;\n            var h = hash;\n            hash = {};\n\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                var key = array[i];\n                if (h[key]) {\n                    hash[key] = h[key];\n                    delete h[key];\n                }\n            }\n            h = undefined;\n        };\n\n        vha.clear = function() {\n            hash = undefined;\n            array = undefined;\n            hash = {};\n            array = [];\n        };\n\n        vha.add = function(name, val, insertAt) {\n            var redraw = false;\n\n            if (!hash[name]) {\n                if (insertAt === undefined || insertAt < 0 || insertAt >= array.length) {\n                    array.push(name);\n                } else {\n                    var x = 0;\n                    var n = [];\n                    var len = array.length;\n\n                    for (var i = 0; i < len; i++) {\n                        if (x++==insertAt) {\n                            n.push(name);\n                        }\n                        n.push(array[i]);\n                    }\n\n                    array = undefined;\n                    array = n;\n                    n = undefined;\n                    redraw = true;\n                }\n            }\n\n            hash[name] = val;\n\n            return redraw;\n        };\n\n        vha.del = function(name) {\n            var r = false;\n\n            if (hash[name]) {\n                array = del_array(array, name);\n                delete hash[name];\n                r = true;\n            } else {\n                console.error(\"can't del nonexistant key \" + name);\n            }\n\n            return r;\n        };\n\n        vha.get = function(name) {\n            return hash[name];\n        };\n\n        vha.order = function() {\n            return array;\n        };\n\n        vha.hash = function() {\n            return hash;\n        };\n\n        vha.indexOf = function(name) {\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                if (array[i] == name) {\n                    return i;\n                }\n            }\n        };\n\n        vha.arrayLen = function() {\n            return array.length;\n        };\n\n        vha.asArray = function() {\n            var r = [];\n\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                var key = array[i];\n                r.push(hash[key]);\n            }\n\n            return r;\n        };\n\n        vha.each = function(cb) {\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                cb(array[i], hash[array[i]]);\n            }\n        };\n\n        vha.dump = function(html) {\n            var str = \"\";\n\n            vha.each(function(name, val) {\n                str += \"name: \" + name + \" val: \" + JSON.stringify(val) + (html ? \"<br>\" : \"\\n\");\n            });\n\n            return str;\n        };\n\n    };\n\n    $.verto.liveArray = function(verto, context, name, config) {\n        var la = this;\n        var lastSerno = 0;\n        var binding = null;\n        var user_obj = config.userObj;\n        var local = false;\n\n        // Inherit methods of hashArray\n        hashArray.call(la);\n\n        // Save the hashArray add, del, reorder, clear methods so we can make our own.\n        la._add = la.add;\n        la._del = la.del;\n        la._reorder = la.reorder;\n        la._clear = la.clear;\n\n        la.context = context;\n        la.name = name;\n        la.user_obj = user_obj;\n\n        la.verto = verto;\n        la.broadcast = function(channel, obj) {\n            verto.broadcast(channel, obj);\n        };\n        la.errs = 0;\n\n        la.clear = function() {\n            la._clear();\n            lastSerno = 0;\n\n            if (la.onChange) {\n                la.onChange(la, {\n                    action: \"clear\"\n                });\n            }\n        };\n\n        la.checkSerno = function(serno) {\n            if (serno < 0) {\n                return true;\n            }\n\n            if (lastSerno > 0 && serno != (lastSerno + 1)) {\n                if (la.onErr) {\n                    la.onErr(la, {\n                        lastSerno: lastSerno,\n                        serno: serno\n                    });\n                }\n                la.errs++;\n                console.debug(la.errs);\n                if (la.errs < 3) {\n                    la.bootstrap(la.user_obj);\n                }\n                return false;\n            } else {\n                lastSerno = serno;\n                return true;\n            }\n        };\n\n        la.reorder = function(serno, a) {\n            if (la.checkSerno(serno)) {\n                la._reorder(a);\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"reorder\"\n                    });\n                }\n            }\n        };\n\n        la.init = function(serno, val, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"init\",\n                        index: index,\n                        key: key,\n                        data: val\n                    });\n                }\n            }\n        };\n\n        la.bootObj = function(serno, val) {\n            if (la.checkSerno(serno)) {\n\n                //la.clear();\n                for (var i in val) {\n                    la._add(val[i][0], val[i][1]);\n                }\n\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"bootObj\",\n                        data: val,\n                        redraw: true\n                    });\n                }\n            }\n        };\n\n        // @param serno  La is the serial number for la particular request.\n        // @param key    If looking at it as a hash table, la represents the key in the hashArray object where you want to store the val object.\n        // @param index  If looking at it as an array, la represents the position in the array where you want to store the val object.\n        // @param val    La is the object you want to store at the key or index location in the hash table / array.\n        la.add = function(serno, val, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                var redraw = la._add(key, val, index);\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"add\",\n                        index: index,\n                        key: key,\n                        data: val,\n                        redraw: redraw\n                    });\n                }\n            }\n        };\n\n        la.modify = function(serno, val, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                la._add(key, val, index);\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"modify\",\n                        key: key,\n                        data: val,\n                        index: index\n                    });\n                }\n            }\n        };\n\n        la.del = function(serno, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                if (index === null || index < 0 || index === undefined) {\n                    index = la.indexOf(key);\n                }\n                var ok = la._del(key);\n\n                if (ok && la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"del\",\n                        key: key,\n                        index: index\n                    });\n                }\n            }\n        };\n\n        var eventHandler = function(v, e, la) {\n            var packet = e.data;\n\n            //console.error(\"READ:\", packet);\n\n            if (packet.name != la.name) {\n                return;\n            }\n\n            switch (packet.action) {\n\n            case \"init\":\n                la.init(packet.wireSerno, packet.data, packet.hashKey, packet.arrIndex);\n                break;\n\n            case \"bootObj\":\n                la.bootObj(packet.wireSerno, packet.data);\n                break;\n            case \"add\":\n                la.add(packet.wireSerno, packet.data, packet.hashKey, packet.arrIndex);\n                break;\n\n            case \"modify\":\n                if (! (packet.arrIndex || packet.hashKey)) {\n                    console.error(\"Invalid Packet\", packet);\n                } else {\n                    la.modify(packet.wireSerno, packet.data, packet.hashKey, packet.arrIndex);\n                }\n                break;\n            case \"del\":\n                if (! (packet.arrIndex || packet.hashKey)) {\n                    console.error(\"Invalid Packet\", packet);\n                } else {\n                    la.del(packet.wireSerno, packet.hashKey, packet.arrIndex);\n                }\n                break;\n\n            case \"clear\":\n                la.clear();\n                break;\n\n            case \"reorder\":\n                la.reorder(packet.wireSerno, packet.order);\n                break;\n\n            default:\n                if (la.checkSerno(packet.wireSerno)) {\n                    if (la.onChange) {\n                        la.onChange(la, {\n                            serno: packet.wireSerno,\n                            action: packet.action,\n                            data: packet.data\n                        });\n                    }\n                }\n                break;\n            }\n        };\n\n        if (la.context) {\n            binding = la.verto.subscribe(la.context, {\n                handler: eventHandler,\n                userData: la,\n                subParams: config.subParams\n            });\n        }\n\n        la.destroy = function() {\n            la._clear();\n            la.verto.unsubscribe(binding);\n        };\n\n        la.sendCommand = function(cmd, obj) {\n            var self = la;\n            self.broadcast(self.context, {\n                liveArray: {\n                    command: cmd,\n                    context: self.context,\n                    name: self.name,\n                    obj: obj\n                }\n            });\n        };\n\n        la.bootstrap = function(obj) {\n            var self = la;\n            la.sendCommand(\"bootstrap\", obj);\n            //self.heartbeat();\n        };\n\n        la.changepage = function(obj) {\n            var self = la;\n            self.clear();\n            self.broadcast(self.context, {\n                liveArray: {\n                    command: \"changepage\",\n                    context: la.context,\n                    name: la.name,\n                    obj: obj\n                }\n            });\n        };\n\n        la.heartbeat = function(obj) {\n            var self = la;\n\n            var callback = function() {\n                self.heartbeat.call(self, obj);\n            };\n            self.broadcast(self.context, {\n                liveArray: {\n                    command: \"heartbeat\",\n                    context: self.context,\n                    name: self.name,\n                    obj: obj\n                }\n            });\n            self.hb_pid = setTimeout(callback, 30000);\n        };\n\n        la.bootstrap(la.user_obj);\n    };\n\n    $.verto.liveTable = function(verto, context, name, jq, config) {\n        var dt;\n        var la = new $.verto.liveArray(verto, context, name, {\n            subParams: config.subParams\n        });\n        var lt = this;\n\n        lt.liveArray = la;\n        lt.dataTable = dt;\n        lt.verto = verto;\n\n        lt.destroy = function() {\n            if (dt) {\n                dt.fnDestroy();\n            }\n            if (la) {\n                la.destroy();\n            }\n\n            dt = null;\n            la = null;\n        };\n\n        la.onErr = function(obj, args) {\n            console.error(\"Error: \", obj, args);\n        };\n\n\t/* back compat so jsonstatus can always be enabled */\n\tfunction genRow(data) {\n\t    if (typeof(data[4]) === \"string\" && data[4].indexOf(\"{\") > -1) {\n\t\tvar tmp = $.parseJSON(data[4]);\n\t\tdata[4] = tmp.oldStatus;\n\t\tdata[5] = null;\n\t    }\n\t    return data;\n\t}\n\n\tfunction genArray(obj) {\n\t    var data = obj.asArray();\n\n            for (var i in data) {\n\t\tdata[i] = genRow(data[i]);\n\t    }\n\n\t    return data;\n\t}\n\n\n        la.onChange = function(obj, args) {\n            var index = 0;\n            var iserr = 0;\n\n            if (!dt) {\n                if (!config.aoColumns) {\n                    if (args.action != \"init\") {\n                        return;\n                    }\n\n                    config.aoColumns = [];\n\n                    for (var i in args.data) {\n                        config.aoColumns.push({\n                            \"sTitle\": args.data[i]\n                        });\n                    }\n                }\n\n                dt = jq.dataTable(config);\n            }\n\n            if (dt && (args.action == \"del\" || args.action == \"modify\")) {\n                index = args.index;\n\n                if (index === undefined && args.key) {\n                    index = la.indexOf(args.key);\n                }\n\n                if (index === undefined) {\n                    console.error(\"INVALID PACKET Missing INDEX\\n\", args);\n                    return;\n                }\n            }\n\n            if (config.onChange) {\n                config.onChange(obj, args);\n            }\n\n            try {\n                switch (args.action) {\n                case \"bootObj\":\n                    if (!args.data) {\n                        console.error(\"missing data\");\n                        return;\n                    }\n                    dt.fnClearTable();\n                    dt.fnAddData(genArray(obj));\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"add\":\n                    if (!args.data) {\n                        console.error(\"missing data\");\n                        return;\n                    }\n                    if (args.redraw > -1) {\n                        // specific position, more costly\n                        dt.fnClearTable();\n                        dt.fnAddData(genArray(obj));\n                    } else {\n                        dt.fnAddData(genRow(args.data));\n                    }\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"modify\":\n                    if (!args.data) {\n                        return;\n                    }\n                    //console.debug(args, index);\n                    dt.fnUpdate(genRow(args.data), index);\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"del\":\n                    dt.fnDeleteRow(index);\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"clear\":\n                    dt.fnClearTable();\n                    break;\n                case \"reorder\":\n                    // specific position, more costly\n                    dt.fnClearTable();\n                    dt.fnAddData(genArray(obj));\n                    break;\n                case \"hide\":\n                    jq.hide();\n                    break;\n\n                case \"show\":\n                    jq.show();\n                    break;\n\n                }\n            } catch(err) {\n                console.error(\"ERROR: \" + err);\n                iserr++;\n            }\n\n            if (iserr) {\n                obj.errs++;\n                if (obj.errs < 3) {\n                    obj.bootstrap(obj.user_obj);\n                }\n            } else {\n                obj.errs = 0;\n            }\n\n        };\n\n        la.onChange(la, {\n            action: \"init\"\n        });\n\n    };\n\n    var CONFMAN_SERNO = 1;\n\n    /*\n        Conference Manager without jQuery table.\n     */\n\n    $.verto.conf = function(verto, params) {\n        var conf = this;\n\n        conf.params = $.extend({\n            dialog: null,\n            hasVid: false,\n            laData: null,\n            onBroadcast: null,\n            onLaChange: null,\n            onLaRow: null\n        }, params);\n\n        conf.verto = verto;\n        conf.serno = CONFMAN_SERNO++;\n\n        createMainModeratorMethods();\n\n        verto.subscribe(conf.params.laData.modChannel, {\n            handler: function(v, e) {\n                if (conf.params.onBroadcast) {\n                    conf.params.onBroadcast(verto, conf, e.data);\n                }\n            }\n        });\n\n        verto.subscribe(conf.params.laData.infoChannel, {\n            handler: function(v, e) {\n                if (typeof(conf.params.infoCallback) === \"function\") {\n                    conf.params.infoCallback(v,e);\n                }\n            }\n        });\n\n        verto.subscribe(conf.params.laData.chatChannel, {\n            handler: function(v, e) {\n                if (typeof(conf.params.chatCallback) === \"function\") {\n                    conf.params.chatCallback(v,e);\n                }\n            }\n        });\n    };\n\n    $.verto.conf.prototype.modCommand = function(cmd, id, value) {\n        var conf = this;\n\n        conf.verto.rpcClient.call(\"verto.broadcast\", {\n            \"eventChannel\": conf.params.laData.modChannel,\n            \"data\": {\n                \"application\": \"conf-control\",\n                \"command\": cmd,\n                \"id\": id,\n                \"value\": value\n            }\n        });\n    };\n\n    $.verto.conf.prototype.destroy = function() {\n        var conf = this;\n\n        conf.destroyed = true;\n        conf.params.onBroadcast(conf.verto, conf, 'destroy');\n\n        if (conf.params.laData.modChannel) {\n            conf.verto.unsubscribe(conf.params.laData.modChannel);\n        }\n\n        if (conf.params.laData.chatChannel) {\n            conf.verto.unsubscribe(conf.params.laData.chatChannel);\n        }\n\n        if (conf.params.laData.infoChannel) {\n            conf.verto.unsubscribe(conf.params.laData.infoChannel);\n        }\n    };\n\n    function createMainModeratorMethods() {\n        $.verto.conf.prototype.listVideoLayouts = function() {\n            this.modCommand(\"list-videoLayouts\", null, null);\n        };\n\n        $.verto.conf.prototype.play = function(file) {\n            this.modCommand(\"play\", null, file);\n        };\n\n        $.verto.conf.prototype.stop = function() {\n            this.modCommand(\"stop\", null, \"all\");\n        };\n\n        $.verto.conf.prototype.deaf = function(memberID) {\n            this.modCommand(\"deaf\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.undeaf = function(memberID) {\n            this.modCommand(\"undeaf\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.record = function(file) {\n            this.modCommand(\"recording\", null, [\"start\", file]);\n        };\n\n        $.verto.conf.prototype.stopRecord = function() {\n            this.modCommand(\"recording\", null, [\"stop\", \"all\"]);\n        };\n\n        $.verto.conf.prototype.snapshot = function(file) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-write-png\", null, file);\n        };\n\n        $.verto.conf.prototype.setVideoLayout = function(layout, canvasID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n\t    if (canvasID) {\n\t\tthis.modCommand(\"vid-layout\", null, [layout, canvasID]);\n\t    } else {\n\t\tthis.modCommand(\"vid-layout\", null, layout);\n\t    }\n        };\n\n        $.verto.conf.prototype.kick = function(memberID) {\n            this.modCommand(\"kick\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.muteMic = function(memberID) {\n            this.modCommand(\"tmute\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.muteVideo = function(memberID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"tvmute\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.presenter = function(memberID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-res-id\", parseInt(memberID), \"presenter\");\n        };\n\n        $.verto.conf.prototype.videoFloor = function(memberID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-floor\", parseInt(memberID), \"force\");\n        };\n\n        $.verto.conf.prototype.banner = function(memberID, text) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-banner\", parseInt(memberID), escape(text));\n        };\n\n        $.verto.conf.prototype.volumeDown = function(memberID) {\n            this.modCommand(\"volume_out\", parseInt(memberID), \"down\");\n        };\n\n        $.verto.conf.prototype.volumeUp = function(memberID) {\n            this.modCommand(\"volume_out\", parseInt(memberID), \"up\");\n        };\n\n        $.verto.conf.prototype.gainDown = function(memberID) {\n            this.modCommand(\"volume_in\", parseInt(memberID), \"down\");\n        };\n\n        $.verto.conf.prototype.gainUp = function(memberID) {\n            this.modCommand(\"volume_in\", parseInt(memberID), \"up\");\n        };\n\n        $.verto.conf.prototype.transfer = function(memberID, exten) {\n            this.modCommand(\"transfer\", parseInt(memberID), exten);\n        };\n\n        $.verto.conf.prototype.sendChat = function(message, type) {\n            var conf = this;\n            conf.verto.rpcClient.call(\"verto.broadcast\", {\n                \"eventChannel\": conf.params.laData.chatChannel,\n                \"data\": {\n                    \"action\": \"send\",\n                    \"message\": message,\n                    \"type\": type\n                }\n            });\n        };\n            \n    }\n\n    $.verto.modfuncs = {};\n\n    $.verto.confMan = function(verto, params) {\n        var confMan = this;\n\n        confMan.params = $.extend({\n            tableID: null,\n            statusID: null,\n            mainModID: null,\n            dialog: null,\n            hasVid: false,\n            laData: null,\n            onBroadcast: null,\n            onLaChange: null,\n            onLaRow: null\n        }, params);\n\n        confMan.verto = verto;\n        confMan.serno = CONFMAN_SERNO++;\n\tconfMan.canvasCount = confMan.params.laData.canvasCount;\n\t\n        function genMainMod(jq) {\n            var play_id = \"play_\" + confMan.serno;\n            var stop_id = \"stop_\" + confMan.serno;\n            var recording_id = \"recording_\" + confMan.serno;\n            var snapshot_id = \"snapshot_\" + confMan.serno;\n            var rec_stop_id = \"recording_stop\" + confMan.serno;\n            var div_id = \"confman_\" + confMan.serno;\n\n            var html =  \"<div id='\" + div_id + \"'><br>\" +\n\t\t\"<button class='ctlbtn' id='\" + play_id + \"'>Play</button>\" +\n\t\t\"<button class='ctlbtn' id='\" + stop_id + \"'>Stop</button>\" +\n\t\t\"<button class='ctlbtn' id='\" + recording_id + \"'>Record</button>\" +\n\t\t\"<button class='ctlbtn' id='\" + rec_stop_id + \"'>Record Stop</button>\" +\n\t\t(confMan.params.hasVid ? \"<button class='ctlbtn' id='\" + snapshot_id + \"'>PNG Snapshot</button>\" : \"\") +\n\t\t\"<br><br></div>\";\n\n            jq.html(html);\n\n\t    $.verto.modfuncs.change_video_layout = function(id, canvas_id) {\t    \n\t\tvar val = $(\"#\" + id + \" option:selected\").text();\n\t\tif (val !== \"none\") {\n                    confMan.modCommand(\"vid-layout\", null, [val, canvas_id]);\n\t\t}\n\t    };\n\n\t    if (confMan.params.hasVid) {\n\t\tfor (var j = 0; j < confMan.canvasCount; j++) {\n\t\t    var vlayout_id = \"confman_vid_layout_\" + j + \"_\" + confMan.serno;\n\t\t    var vlselect_id = \"confman_vl_select_\" + j + \"_\" + confMan.serno;\n\t\t\n\n\t\t    var vlhtml =  \"<div id='\" + vlayout_id + \"'><br>\" +\n\t\t\t\"<b>Video Layout Canvas \" + (j+1) + \n\t\t\t\"</b> <select onChange='$.verto.modfuncs.change_video_layout(\\\"\" + vlayout_id + \"\\\", \\\"\" + (j+1) + \"\\\")' id='\" + vlselect_id + \"'></select> \" +\n\t\t\t\"<br><br></div>\";\n\t\t    jq.append(vlhtml);\n\t\t}\n\n\t\t$(\"#\" + snapshot_id).click(function() {\n                    var file = prompt(\"Please enter file name\", \"\");\n\t\t    if (file) {\n\t\t\tconfMan.modCommand(\"vid-write-png\", null, file);\n\t\t    }\n\t\t});\n\t    }\n\n            $(\"#\" + play_id).click(function() {\n                var file = prompt(\"Please enter file name\", \"\");\n\t\tif (file) {\n                    confMan.modCommand(\"play\", null, file);\n\t\t}\n            });\n\n            $(\"#\" + stop_id).click(function() {\n                confMan.modCommand(\"stop\", null, \"all\");\n            });\n\n            $(\"#\" + recording_id).click(function() {\n                var file = prompt(\"Please enter file name\", \"\");\n\t\tif (file) {\n                    confMan.modCommand(\"recording\", null, [\"start\", file]);\n\t\t}\n            });\n\n            $(\"#\" + rec_stop_id).click(function() {\n                confMan.modCommand(\"recording\", null, [\"stop\", \"all\"]);\n            });\n\n        }\n\n        function genControls(jq, rowid) {\n            var x = parseInt(rowid);\n            var kick_id = \"kick_\" + x;\n            var canvas_in_next_id = \"canvas_in_next_\" + x;\n            var canvas_in_prev_id = \"canvas_in_prev_\" + x;\n            var canvas_out_next_id = \"canvas_out_next_\" + x;\n            var canvas_out_prev_id = \"canvas_out_prev_\" + x;\n\n            var canvas_in_set_id = \"canvas_in_set_\" + x;\n            var canvas_out_set_id = \"canvas_out_set_\" + x;\n\n            var layer_set_id = \"layer_set_\" + x;\n            var layer_next_id = \"layer_next_\" + x;\n            var layer_prev_id = \"layer_prev_\" + x;\n\t    \n            var tmute_id = \"tmute_\" + x;\n            var tvmute_id = \"tvmute_\" + x;\n            var vbanner_id = \"vbanner_\" + x;\n            var tvpresenter_id = \"tvpresenter_\" + x;\n            var tvfloor_id = \"tvfloor_\" + x;\n            var box_id = \"box_\" + x;\n            var gainup_id = \"gain_in_up\" + x;\n            var gaindn_id = \"gain_in_dn\" + x;\n            var volup_id = \"vol_in_up\" + x;\n            var voldn_id = \"vol_in_dn\" + x;\n            var transfer_id = \"transfer\" + x;\n\t    \n\n            var html = \"<div id='\" + box_id + \"'>\";\n\n\t    html += \"<b>General Controls</b><hr noshade>\";\n\n            html += \"<button class='ctlbtn' id='\" + kick_id + \"'>Kick</button>\" +\n                \"<button class='ctlbtn' id='\" + tmute_id + \"'>Mute</button>\" +\n                \"<button class='ctlbtn' id='\" + gainup_id + \"'>Gain -</button>\" +\n                \"<button class='ctlbtn' id='\" + gaindn_id + \"'>Gain +</button>\" +\n                \"<button class='ctlbtn' id='\" + voldn_id + \"'>Vol -</button>\" +\n                \"<button class='ctlbtn' id='\" + volup_id + \"'>Vol +</button>\" +\n                \"<button class='ctlbtn' id='\" + transfer_id + \"'>Transfer</button>\";\n\t\t\n\t    if (confMan.params.hasVid) {\n\t\thtml += \"<br><br><b>Video Controls</b><hr noshade>\";\n\n\n                html += \"<button class='ctlbtn' id='\" + tvmute_id + \"'>VMute</button>\" +\n                    \"<button class='ctlbtn' id='\" + tvpresenter_id + \"'>Presenter</button>\" +\n                    \"<button class='ctlbtn' id='\" + tvfloor_id + \"'>Vid Floor</button>\" +\n                    \"<button class='ctlbtn' id='\" + vbanner_id + \"'>Banner</button>\";\n\n\t\tif (confMan.canvasCount > 1) {\n                    html += \"<br><br><b>Canvas Controls</b><hr noshade>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_in_set_id + \"'>Set Input Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_in_prev_id + \"'>Prev Input Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_in_next_id + \"'>Next Input Canvas</button>\" +\n\t\t\t\n\t\t    \"<br>\" +\n\t\t\t\n\t\t    \"<button class='ctlbtn' id='\" + canvas_out_set_id + \"'>Set Watching Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_out_prev_id + \"'>Prev Watching Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_out_next_id + \"'>Next Watching Canvas</button>\";\n\t\t}\n\t\t\n\t\thtml += \"<br>\" +\n\n                \"<button class='ctlbtn' id='\" + layer_set_id + \"'>Set Layer</button>\" +\n                    \"<button class='ctlbtn' id='\" + layer_prev_id + \"'>Prev Layer</button>\" +\n                    \"<button class='ctlbtn' id='\" + layer_next_id + \"'>Next Layer</button>\" +\n\n\n\n                    \"</div>\";\n            }\n\n            jq.html(html);\n\n\n            if (!jq.data(\"mouse\")) {\n                $(\"#\" + box_id).hide();\n            }\n\n            jq.mouseover(function(e) {\n                jq.data({\"mouse\": true});\n                $(\"#\" + box_id).show();\n            });\n\n            jq.mouseout(function(e) {\n                jq.data({\"mouse\": false});\n                $(\"#\" + box_id).hide();\n            });\n\n            $(\"#\" + transfer_id).click(function() {\n                var xten = prompt(\"Enter Extension\");\n\t\tif (xten) {\n                    confMan.modCommand(\"transfer\", x, xten);\n\t\t}\n            });\n\n            $(\"#\" + kick_id).click(function() {\n                confMan.modCommand(\"kick\", x);\n            });\n\n\n            $(\"#\" + layer_set_id).click(function() {\n                var cid = prompt(\"Please enter layer ID\", \"\");\n\t\tif (cid) {\n                    confMan.modCommand(\"vid-layer\", x, cid);\n\t\t}\n            });\n\n            $(\"#\" + layer_next_id).click(function() {\n                confMan.modCommand(\"vid-layer\", x, \"next\");\n            });\n            $(\"#\" + layer_prev_id).click(function() {\n                confMan.modCommand(\"vid-layer\", x, \"prev\");\n            });\n\n            $(\"#\" + canvas_in_set_id).click(function() {\n                var cid = prompt(\"Please enter canvas ID\", \"\");\n\t\tif (cid) {\n                    confMan.modCommand(\"vid-canvas\", x, cid);\n\t\t}\n            });\n\n            $(\"#\" + canvas_out_set_id).click(function() {\n                var cid = prompt(\"Please enter canvas ID\", \"\");\n\t\tif (cid) {\n                    confMan.modCommand(\"vid-watching-canvas\", x, cid);\n\t\t}\n            });\n\n            $(\"#\" + canvas_in_next_id).click(function() {\n                confMan.modCommand(\"vid-canvas\", x, \"next\");\n            });\n            $(\"#\" + canvas_in_prev_id).click(function() {\n                confMan.modCommand(\"vid-canvas\", x, \"prev\");\n            });\n\n\n            $(\"#\" + canvas_out_next_id).click(function() {\n                confMan.modCommand(\"vid-watching-canvas\", x, \"next\");\n            });\n            $(\"#\" + canvas_out_prev_id).click(function() {\n                confMan.modCommand(\"vid-watching-canvas\", x, \"prev\");\n            });\n\t    \n            $(\"#\" + tmute_id).click(function() {\n                confMan.modCommand(\"tmute\", x);\n            });\n\n\t    if (confMan.params.hasVid) {\n\t\t$(\"#\" + tvmute_id).click(function() {\n                    confMan.modCommand(\"tvmute\", x);\n\t\t});\n\t\t$(\"#\" + tvpresenter_id).click(function() {\n                    confMan.modCommand(\"vid-res-id\", x, \"presenter\");\n\t\t});\n\t\t$(\"#\" + tvfloor_id).click(function() {\n                    confMan.modCommand(\"vid-floor\", x, \"force\");\n\t\t});\n\t\t$(\"#\" + vbanner_id).click(function() {\n                    var text = prompt(\"Please enter text\", \"\");\n\t\t    if (text) {\n\t\t\tconfMan.modCommand(\"vid-banner\", x, escape(text));\n\t\t    }\n\t\t});\n\t    }\n\n            $(\"#\" + gainup_id).click(function() {\n                confMan.modCommand(\"volume_in\", x, \"up\");\n            });\n\n            $(\"#\" + gaindn_id).click(function() {\n                confMan.modCommand(\"volume_in\", x, \"down\");\n            });\n\n            $(\"#\" + volup_id).click(function() {\n                confMan.modCommand(\"volume_out\", x, \"up\");\n            });\n\n            $(\"#\" + voldn_id).click(function() {\n                confMan.modCommand(\"volume_out\", x, \"down\");\n            });\n\n            return html;\n        }\n\n        var atitle = \"\";\n        var awidth = 0;\n\n        //$(\".jsDataTable\").width(confMan.params.hasVid ? \"900px\" : \"800px\");\n\n        verto.subscribe(confMan.params.laData.infoChannel, {\n            handler: function(v, e) {\n                if (typeof(confMan.params.infoCallback) === \"function\") {\n                    confMan.params.infoCallback(v,e);\n                }\n            }\n        });\n\n\tverto.subscribe(confMan.params.laData.chatChannel, {\n\t    handler: function(v, e) {\n\t\tif (typeof(confMan.params.chatCallback) === \"function\") {\n\t\t    confMan.params.chatCallback(v,e);\n\t\t}\n\t    }\n\t});\n\n        if (confMan.params.laData.role === \"moderator\") {\n            atitle = \"Action\";\n            awidth = 600;\n\n            if (confMan.params.mainModID) {\n                genMainMod($(confMan.params.mainModID));\n                $(confMan.params.displayID).html(\"Moderator Controls Ready<br><br>\");\n            } else {\n                $(confMan.params.mainModID).html(\"\");\n            }\n\n            verto.subscribe(confMan.params.laData.modChannel, {\n                handler: function(v, e) {\n                    //console.error(\"MODDATA:\", e.data);\n                    if (confMan.params.onBroadcast) {\n                        confMan.params.onBroadcast(verto, confMan, e.data);\n                    }\n\n\t\t    if (e.data[\"conf-command\"] === \"list-videoLayouts\") {\n\t\t\tfor (var j = 0; j < confMan.canvasCount; j++) {\n\t\t\t    var vlselect_id = \"#confman_vl_select_\" + j + \"_\" + confMan.serno;\n\t\t\t    var vlayout_id = \"#confman_vid_layout_\" + j + \"_\" + confMan.serno;\n\t\t\t    \n\t\t\t    var x = 0;\n\t\t\t    var options;\n\t\t\t    \n\t\t\t    $(vlselect_id).selectmenu({});\n\t\t\t    $(vlselect_id).selectmenu(\"enable\");\n\t\t\t    $(vlselect_id).empty();\n\t\t\t    \n\t\t\t    $(vlselect_id).append(new Option(\"Choose a Layout\", \"none\"));\n\n\t\t\t    if (e.data.responseData) {\n\t\t\t\tvar rdata = [];\n\n\t\t\t\tfor (var i in e.data.responseData) {\n\t\t\t\t    rdata.push(e.data.responseData[i].name);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\toptions = rdata.sort(function(a, b) {\n\t\t\t\t    var ga = a.substring(0, 6) == \"group:\" ? true : false;\n\t\t\t\t    var gb = b.substring(0, 6) == \"group:\" ? true : false;\n\t\t\t\t    \n\t\t\t\t    if ((ga || gb) && ga != gb) {\n\t\t\t\t\treturn ga ? -1 : 1;\n\t\t\t\t    }\n\t\t\t\t    \n\t\t\t\t    return ( ( a == b ) ? 0 : ( ( a > b ) ? 1 : -1 ) );\n\t\t\t\t});\n\n\t\t\t\tfor (var i in options) {\n\t\t\t\t    $(vlselect_id).append(new Option(options[i], options[i]));\n\t\t\t\t    x++;\n\t\t\t\t}\n\t\t\t    }\n\n\t\t\t    if (x) {\n\t\t\t\t$(vlselect_id).selectmenu('refresh', true);\n\t\t\t    } else {\n\t\t\t\t$(vlayout_id).hide();\n\t\t\t    }\n\t\t\t}\n\t\t    } else {\n\n\t\t\tif (!confMan.destroyed && confMan.params.displayID) {\n                            $(confMan.params.displayID).html(e.data.response + \"<br><br>\");\n                            if (confMan.lastTimeout) {\n\t\t\t\tclearTimeout(confMan.lastTimeout);\n\t\t\t\tconfMan.lastTimeout = 0;\n                            }\n                            confMan.lastTimeout = setTimeout(function() { $(confMan.params.displayID).html(confMan.destroyed ? \"\" : \"Moderator Controls Ready<br><br>\");}, 4000);\n\t\t\t}\n\t\t    }\n                }\n            });\n\n\n\t    if (confMan.params.hasVid) {\n\t\tconfMan.modCommand(\"list-videoLayouts\", null, null);\n\t    }\n        }\n\n        var row_callback = null;\n\n        if (confMan.params.laData.role === \"moderator\") {\n            row_callback = function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n                if (!aData[5]) {\n                    var $row = $('td:eq(5)', nRow);\n                    genControls($row, aData);\n\n                    if (confMan.params.onLaRow) {\n                        confMan.params.onLaRow(verto, confMan, $row, aData);\n                    }\n                }\n            };\n        }\n\n        confMan.lt = new $.verto.liveTable(verto, confMan.params.laData.laChannel, confMan.params.laData.laName, $(confMan.params.tableID), {\n            subParams: {\n                callID: confMan.params.dialog ? confMan.params.dialog.callID : null\n            },\n\n            \"onChange\": function(obj, args) {\n                $(confMan.params.statusID).text(\"Conference Members: \" + \" (\" + obj.arrayLen() + \" Total)\");\n                if (confMan.params.onLaChange) {\n                    confMan.params.onLaChange(verto, confMan, $.verto.enum.confEvent.laChange, obj, args);\n                }\n            },\n\n            \"aaData\": [],\n            \"aoColumns\": [\n                {\n                    \"sTitle\": \"ID\",\n                    \"sWidth\": \"50\"\n                },\n                {\n                    \"sTitle\": \"Number\",\n\t\t    \"sWidth\": \"250\"\n                },\n                {\n                    \"sTitle\": \"Name\",\n\t\t    \"sWidth\": \"250\"\n                },\n                {\n                    \"sTitle\": \"Codec\",\n                    \"sWidth\": \"100\"\n                },\n                {\n                    \"sTitle\": \"Status\",\n                    \"sWidth\": confMan.params.hasVid ? \"200px\" : \"150px\"\n                },\n                {\n                    \"sTitle\": atitle,\n                    \"sWidth\": awidth,\n                }\n            ],\n            \"bAutoWidth\": true,\n            \"bDestroy\": true,\n            \"bSort\": false,\n            \"bInfo\": false,\n            \"bFilter\": false,\n            \"bLengthChange\": false,\n            \"bPaginate\": false,\n            \"iDisplayLength\": 1400,\n\n            \"oLanguage\": {\n                \"sEmptyTable\": \"The Conference is Empty.....\"\n            },\n\n            \"fnRowCallback\": row_callback\n\n        });\n    };\n\n    $.verto.confMan.prototype.modCommand = function(cmd, id, value) {\n        var confMan = this;\n\n        confMan.verto.rpcClient.call(\"verto.broadcast\", {\n            \"eventChannel\": confMan.params.laData.modChannel,\n            \"data\": {\n\t\t\"application\": \"conf-control\",\n\t\t\"command\": cmd,\n\t\t\"id\": id,\n\t\t\"value\": value\n            }\n\t});\n    };\n\n    $.verto.confMan.prototype.sendChat = function(message, type) {\n        var confMan = this;\n        confMan.verto.rpcClient.call(\"verto.broadcast\", {\n            \"eventChannel\": confMan.params.laData.chatChannel,\n            \"data\": {\n\t\t\"action\": \"send\",\n\t\t\"message\": message,\n\t\t\"type\": type\n            }\n\t});\n    };\n\n\n    $.verto.confMan.prototype.destroy = function() {\n        var confMan = this;\n\n        confMan.destroyed = true;\n\n        if (confMan.lt) {\n            confMan.lt.destroy();\n        }\n\n        if (confMan.params.laData.chatChannel) {\n            confMan.verto.unsubscribe(confMan.params.laData.chatChannel);\n        }\n\n        if (confMan.params.laData.modChannel) {\n            confMan.verto.unsubscribe(confMan.params.laData.modChannel);\n        }\n\n        if (confMan.params.mainModID) {\n            $(confMan.params.mainModID).html(\"\");\n        }\n    };\n\n    $.verto.dialog = function(direction, verto, params) {\n        var dialog = this;\n\n        dialog.params = $.extend({\n            useVideo: verto.options.useVideo,\n            useStereo: verto.options.useStereo,\n\t    screenShare: false,\n\t    useCamera: false,\n\t    useMic: verto.options.deviceParams.useMic,\n\t    useMicLabel: verto.options.deviceParams.useMicLabel,\n\t    useSpeak: verto.options.deviceParams.useSpeak,\n            tag: verto.options.tag,\n            localTag: verto.options.localTag,\n            login: verto.options.login,\n      videoParams: verto.options.videoParams,\n      useStream: verto.options.useStream,\n        }, params);\n\t\n\n\tif (!dialog.params.screenShare) {\n\t    dialog.params.useCamera = verto.options.deviceParams.useCamera;\n\t    dialog.params.useCameraLabel = verto.options.deviceParams.useCameraLabel;\n\t}\n\n        dialog.verto = verto;\n        dialog.direction = direction;\n        dialog.lastState = null;\n        dialog.state = dialog.lastState = $.verto.enum.state.new;\n        dialog.callbacks = verto.callbacks;\n        dialog.answered = false;\n        dialog.attach = params.attach || false;\n\tdialog.screenShare = params.screenShare || false;\n\tdialog.useCamera = dialog.params.useCamera;\n\tdialog.useCameraLabel = dialog.params.useCameraLabel;\n\tdialog.useMic = dialog.params.useMic;\n\tdialog.useMicLabel = dialog.params.useMicLabel;\n\tdialog.useSpeak = dialog.params.useSpeak;\n\t\n        if (dialog.params.callID) {\n            dialog.callID = dialog.params.callID;\n        } else {\n            dialog.callID = dialog.params.callID = generateGUID();\n        }\n\n\tif (typeof(dialog.params.tag) === \"function\") {\n\t\tdialog.params.tag = dialog.params.tag();\n\t}\n\t\n        if (dialog.params.tag) {\n            dialog.audioStream = document.getElementById(dialog.params.tag);\n\n            if (dialog.params.useVideo) {\n                dialog.videoStream = dialog.audioStream;\n            }\n        } //else conjure one TBD\n\n        if (dialog.params.localTag) {\n\t    dialog.localVideo = document.getElementById(dialog.params.localTag);\n\t}\n\n        dialog.verto.dialogs[dialog.callID] = dialog;\n\n        var RTCcallbacks = {};\n\n        if (dialog.direction == $.verto.enum.direction.inbound) {\n            if (dialog.params.display_direction === \"outbound\") {\n                dialog.params.remote_caller_id_name = dialog.params.caller_id_name;\n                dialog.params.remote_caller_id_number = dialog.params.caller_id_number;\n            } else {\n                dialog.params.remote_caller_id_name = dialog.params.callee_id_name;\n                dialog.params.remote_caller_id_number = dialog.params.callee_id_number;\n            }\n\n            if (!dialog.params.remote_caller_id_name) {\n                dialog.params.remote_caller_id_name = \"Nobody\";\n            }\n\n            if (!dialog.params.remote_caller_id_number) {\n                dialog.params.remote_caller_id_number = \"UNKNOWN\";\n            }\n\n            RTCcallbacks.onMessage = function(rtc, msg) {\n                console.debug(msg);\n            };\n\n            RTCcallbacks.onAnswerSDP = function(rtc, sdp) {\n                console.error(\"answer sdp\", sdp);\n            };\n        } else {\n            dialog.params.remote_caller_id_name = \"Outbound Call\";\n            dialog.params.remote_caller_id_number = dialog.params.destination_number;\n        }\n\n        RTCcallbacks.onICESDP = function(rtc) {\n            console.log(\"RECV \" + rtc.type + \" SDP\", rtc.mediaData.SDP);\n\n\t    if (dialog.state == $.verto.enum.state.requesting || dialog.state == $.verto.enum.state.answering || dialog.state == $.verto.enum.state.active) {\n\t\tlocation.reload();\n\t\treturn;\n\t    }\n\n            if (rtc.type == \"offer\") {\n\t\tif (dialog.state == $.verto.enum.state.active) {\n                    dialog.setState($.verto.enum.state.requesting);\n\t\t    dialog.sendMethod(\"verto.attach\", {\n\t\t\tsdp: rtc.mediaData.SDP\n                    });\n\t\t} else {\n                    dialog.setState($.verto.enum.state.requesting);\n\t\t    \n                    dialog.sendMethod(\"verto.invite\", {\n\t\t\tsdp: rtc.mediaData.SDP\n                    });\n\t\t}\n            } else { //answer\n                dialog.setState($.verto.enum.state.answering);\n\n                dialog.sendMethod(dialog.attach ? \"verto.attach\" : \"verto.answer\", {\n                    sdp: dialog.rtc.mediaData.SDP\n                });\n            }\n        };\n\n        RTCcallbacks.onICE = function(rtc) {\n            //console.log(\"cand\", rtc.mediaData.candidate);\n            if (rtc.type == \"offer\") {\n                console.log(\"offer\", rtc.mediaData.candidate);\n                return;\n            }\n        };\n\n        RTCcallbacks.onStream = function(rtc, stream) {\n            if (dialog.callbacks.permissionCallback &&\n                typeof dialog.callbacks.permissionCallback.onGranted === 'function') {\n                dialog.callbacks.permissionCallback.onGranted(stream);\n            }\n            else if (dialog.verto.options.permissionCallback &&\n                typeof dialog.verto.options.permissionCallback.onGranted === 'function'){\n                dialog.verto.options.permissionCallback.onGranted(stream);\n            }\n            console.log(\"stream started\");\n        };\n\n        RTCcallbacks.onRemoteStream = function(rtc, stream) {\n          if (typeof dialog.callbacks.onRemoteStream === 'function') {\n            dialog.callbacks.onRemoteStream(stream, dialog);\n          }\n          console.log(\"remote stream started\");\n        };\n\n        RTCcallbacks.onError = function(e) {\n            if (dialog.callbacks.permissionCallback &&\n                typeof dialog.callbacks.permissionCallback.onDenied === 'function') {\n                dialog.callbacks.permissionCallback.onDenied();\n            }\n            else if (dialog.verto.options.permissionCallback &&\n                typeof dialog.verto.options.permissionCallback.onDenied === 'function'){\n                dialog.verto.options.permissionCallback.onDenied();\n            }\n            console.error(\"ERROR:\", e);\n            dialog.hangup({cause: \"Device or Permission Error\"});\n        };\n\n        dialog.rtc = new $.FSRTC({\n            callbacks: RTCcallbacks,\n\t    localVideo: dialog.screenShare ? null : dialog.localVideo,\n            useVideo: dialog.params.useVideo ? dialog.videoStream : null,\n            useAudio: dialog.audioStream,\n            useStereo: dialog.params.useStereo,\n            videoParams: dialog.params.videoParams,\n            audioParams: verto.options.audioParams,\n            iceServers: verto.options.iceServers,\n            screenShare: dialog.screenShare,\n            useCamera: dialog.useCamera,\n            useCameraLabel: dialog.useCameraLabel,\n            useMic: dialog.useMic,\n            useMicLabel: dialog.useMicLabel,\n            useSpeak: dialog.useSpeak,\n      turnServer: verto.options.turnServer,\n      useStream: dialog.params.useStream\n        });\n\n        dialog.rtc.verto = dialog.verto;\n\n        if (dialog.direction == $.verto.enum.direction.inbound) {\n            if (dialog.attach) {\n                dialog.answer();\n            } else {\n                dialog.ring();\n            }\n        }\n    };\n\n    $.verto.dialog.prototype.invite = function() {\n        var dialog = this;\n        dialog.rtc.call();\n    };\n\n    $.verto.dialog.prototype.sendMethod = function(method, obj) {\n        var dialog = this;\n        obj.dialogParams = {};\n\n        for (var i in dialog.params) {\n\t    if (i == \"sdp\" && method != \"verto.invite\" && method != \"verto.attach\") {\n                continue;\n\t    }\n\t    \n\t    if ((obj.noDialogParams && i != \"callID\")) {\n\t\tcontinue;\n\t    }\n\n\t    obj.dialogParams[i] = dialog.params[i];\n        }\n\t\n\tdelete obj.noDialogParams;\n\n        dialog.verto.rpcClient.call(method, obj,\n\n        function(e) {\n            /* Success */\n            dialog.processReply(method, true, e);\n        },\n\n        function(e) {\n            /* Error */\n            dialog.processReply(method, false, e);\n        });\n    };\n\n    function checkStateChange(oldS, newS) {\n\n        if (newS == $.verto.enum.state.purge || $.verto.enum.states[oldS.name][newS.name]) {\n            return true;\n        }\n\n        return false;\n    }\n\n\n    // Attach audio output device to video element using device/sink ID.                                                                                           \n    function find_name(id) {\n\tfor (var i in $.verto.audioOutDevices) {\n\t    var source = $.verto.audioOutDevices[i];\n\t    if (source.id === id) {\n\t\treturn(source.label);\n\t    }\n\t}\n\n\treturn id;\n    }\n\n    $.verto.dialog.prototype.setAudioPlaybackDevice = function(sinkId, callback, arg) {\n\tvar dialog = this;\n\tvar element = dialog.audioStream;\n\n\tif (typeof element.sinkId !== 'undefined') {\n\t    var devname = find_name(sinkId);\n\t    console.info(\"Dialog: \" + dialog.callID + \" Setting speaker:\", element, devname);\n\n\t    element.setSinkId(sinkId)\n\t\t.then(function() {\n\t\t    console.log(\"Dialog: \" + dialog.callID + ' Success, audio output device attached: ' + sinkId);\n\t\t    if (callback) {\n\t\t\tcallback(true, devname, arg);\n\t\t    }\n\t\t})\n\t\t.catch(function(error) {\n\t\t    var errorMessage = error;\n\t\t    if (error.name === 'SecurityError') {\n\t\t\terrorMessage = \"Dialog: \" + dialog.callID + ' You need to use HTTPS for selecting audio output ' +\n\t\t\t    'device: ' + error;\n\t\t    }\n\t\t    if (callback) {\n\t\t\tcallback(false, null, arg);\n\t\t    }\n\t\t    console.error(errorMessage);\n\t\t});\n\t} else {\n\t    console.warn(\"Dialog: \" + dialog.callID + ' Browser does not support output device selection.');\n\t    if (callback) {\n\t\tcallback(false, null, arg);\n\t    }\n\t}\n    }\n\n    $.verto.dialog.prototype.setState = function(state) {\n        var dialog = this;\n\n        if (dialog.state == $.verto.enum.state.ringing) {\n            dialog.stopRinging();\n        }\n\n        if (dialog.state == state || !checkStateChange(dialog.state, state)) {\n            console.error(\"Dialog \" + dialog.callID + \": INVALID state change from \" + dialog.state.name + \" to \" + state.name);\n            dialog.hangup();\n            return false;\n        }\n\n        console.log(\"Dialog \" + dialog.callID + \": state change from \" + dialog.state.name + \" to \" + state.name);\n\n        dialog.lastState = dialog.state;\n        dialog.state = state;\n\n        if (dialog.callbacks.onDialogState) {\n            dialog.callbacks.onDialogState(this);\n        }\n\n        switch (dialog.state) {\n\n        case $.verto.enum.state.early:\n        case $.verto.enum.state.active:\n\n\t    var speaker = dialog.useSpeak;\n\t    console.info(\"Using Speaker: \", speaker);\n\n\t    if (speaker && speaker !== \"any\" && speaker !== \"none\") {\n\t\tsetTimeout(function() {\n\t\t    dialog.setAudioPlaybackDevice(speaker);\n\t\t}, 500);\n\t    }\n\n\t    break;\n\n        case $.verto.enum.state.trying:\n            setTimeout(function() {\n                if (dialog.state == $.verto.enum.state.trying) {\n                    dialog.setState($.verto.enum.state.hangup);\n                }\n            }, 30000);\n            break;\n        case $.verto.enum.state.purge:\n            dialog.setState($.verto.enum.state.destroy);\n            break;\n        case $.verto.enum.state.hangup:\n\n            if (dialog.lastState.val > $.verto.enum.state.requesting.val && dialog.lastState.val < $.verto.enum.state.hangup.val) {\n                dialog.sendMethod(\"verto.bye\", {});\n            }\n\n            dialog.setState($.verto.enum.state.destroy);\n            break;\n        case $.verto.enum.state.destroy:\n\n            if (typeof(dialog.verto.options.tag) === \"function\") {\n              $('#' + dialog.params.tag).remove();\n            }\n\n            delete dialog.verto.dialogs[dialog.callID];\n\t    if (dialog.params.screenShare) {\n\t\tdialog.rtc.stopPeer();\n\t    } else {\n\t\tdialog.rtc.stop();\n\t    }\n            break;\n        }\n\n        return true;\n    };\n\n    $.verto.dialog.prototype.processReply = function(method, success, e) {\n        var dialog = this;\n\n        //console.log(\"Response: \" + method + \" State:\" + dialog.state.name, success, e);\n\n        switch (method) {\n\n        case \"verto.answer\":\n        case \"verto.attach\":\n            if (success) {\n                dialog.setState($.verto.enum.state.active);\n            } else {\n                dialog.hangup();\n            }\n            break;\n        case \"verto.invite\":\n            if (success) {\n                dialog.setState($.verto.enum.state.trying);\n            } else {\n                dialog.setState($.verto.enum.state.destroy);\n            }\n            break;\n\n        case \"verto.bye\":\n            dialog.hangup();\n            break;\n\n        case \"verto.modify\":\n            if (e.holdState) {\n                if (e.holdState == \"held\") {\n                    if (dialog.state != $.verto.enum.state.held) {\n                        dialog.setState($.verto.enum.state.held);\n                    }\n                } else if (e.holdState == \"active\") {\n                    if (dialog.state != $.verto.enum.state.active) {\n                        dialog.setState($.verto.enum.state.active);\n                    }\n                }\n            }\n\n            if (success) {}\n\n            break;\n\n        default:\n            break;\n        }\n\n    };\n\n    $.verto.dialog.prototype.hangup = function(params) {\n        var dialog = this;\n\n        if (params) {\n            if (params.causeCode) {\n\t\tdialog.causeCode = params.causeCode;\n            }\n\n            if (params.cause) {\n\t\tdialog.cause = params.cause;\n            }\n        }\n\n\tif (!dialog.cause && !dialog.causeCode) {\n\t    dialog.cause = \"NORMAL_CLEARING\";\n\t}\n\n        if (dialog.state.val >= $.verto.enum.state.new.val && dialog.state.val < $.verto.enum.state.hangup.val) {\n            dialog.setState($.verto.enum.state.hangup);\n        } else if (dialog.state.val < $.verto.enum.state.destroy) {\n            dialog.setState($.verto.enum.state.destroy);\n        }\n    };\n\n    $.verto.dialog.prototype.stopRinging = function() {\n        var dialog = this;\n        if (dialog.verto.ringer) {\n            dialog.verto.ringer.stop();\n        }\n    };\n\n    $.verto.dialog.prototype.indicateRing = function() {\n        var dialog = this;\n\n        if (dialog.verto.ringer) {\n            dialog.verto.ringer.attr(\"src\", dialog.verto.options.ringFile)[0].play();\n\n            setTimeout(function() {\n                dialog.stopRinging();\n                if (dialog.state == $.verto.enum.state.ringing) {\n                    dialog.indicateRing();\n                }\n            },\n            dialog.verto.options.ringSleep);\n        }\n    };\n\n    $.verto.dialog.prototype.ring = function() {\n        var dialog = this;\n\n        dialog.setState($.verto.enum.state.ringing);\n        dialog.indicateRing();\n    };\n\n    $.verto.dialog.prototype.useVideo = function(on) {\n        var dialog = this;\n\n        dialog.params.useVideo = on;\n\n        if (on) {\n            dialog.videoStream = dialog.audioStream;\n        } else {\n            dialog.videoStream = null;\n        }\n\n        dialog.rtc.useVideo(dialog.videoStream, dialog.localVideo);\n\n    };\n\n    $.verto.dialog.prototype.setMute = function(what) {\n\tvar dialog = this;\n\treturn dialog.rtc.setMute(what);\n    };\n\n    $.verto.dialog.prototype.getMute = function() {\n\tvar dialog = this; \n\treturn dialog.rtc.getMute();\n    };\n\n    $.verto.dialog.prototype.setVideoMute = function(what) {\n\tvar dialog = this;\n\treturn dialog.rtc.setVideoMute(what);\n    };\n\n    $.verto.dialog.prototype.getVideoMute = function() {\n\tvar dialog = this; \n\treturn dialog.rtc.getVideoMute();\n    };\n\n    $.verto.dialog.prototype.useStereo = function(on) {\n        var dialog = this;\n\n        dialog.params.useStereo = on;\n        dialog.rtc.useStereo(on);\n    };\n\n    $.verto.dialog.prototype.dtmf = function(digits) {\n        var dialog = this;\n        if (digits) {\n            dialog.sendMethod(\"verto.info\", {\n                dtmf: digits\n            });\n        }\n    };\n\n    $.verto.dialog.prototype.rtt = function(obj) {\n        var dialog = this;\n\tvar pobj = {};\n\n\tif (!obj) {\n\t    return false;\n\t}\n\n\tpobj.code = obj.code;\n\tpobj.chars = obj.chars;\n\n\n        if (pobj.chars || pobj.code) {\n            dialog.sendMethod(\"verto.info\", {\n                txt: obj,\n\t\tnoDialogParams: true\n            });\n        }\n    };\n\n    $.verto.dialog.prototype.transfer = function(dest, params) {\n        var dialog = this;\n        if (dest) {\n            dialog.sendMethod(\"verto.modify\", {\n                action: \"transfer\",\n                destination: dest,\n                params: params\n            });\n        }\n    };\n\n    $.verto.dialog.prototype.replace = function(replaceCallID, params) {\n        var dialog = this;\n        if (replaceCallID) {\n            dialog.sendMethod(\"verto.modify\", {\n                action: \"replace\",\n                replaceCallID: replaceCallID,\n                params: params\n            });\n        }\n    };\n\n    $.verto.dialog.prototype.hold = function(params) {\n        var dialog = this;\n\n        dialog.sendMethod(\"verto.modify\", {\n            action: \"hold\",\n            params: params\n        });\n    };\n\n    $.verto.dialog.prototype.unhold = function(params) {\n        var dialog = this;\n\n        dialog.sendMethod(\"verto.modify\", {\n            action: \"unhold\",\n            params: params\n        });\n    };\n\n    $.verto.dialog.prototype.toggleHold = function(params) {\n        var dialog = this;\n\n        dialog.sendMethod(\"verto.modify\", {\n            action: \"toggleHold\",\n            params: params\n        });\n    };\n\n    $.verto.dialog.prototype.message = function(msg) {\n        var dialog = this;\n        var err = 0;\n\n        msg.from = dialog.params.login;\n\n        if (!msg.to) {\n            console.error(\"Missing To\");\n            err++;\n        }\n\n        if (!msg.body) {\n            console.error(\"Missing Body\");\n            err++;\n        }\n\n        if (err) {\n            return false;\n        }\n\n        dialog.sendMethod(\"verto.info\", {\n            msg: msg\n        });\n\n        return true;\n    };\n\n    $.verto.dialog.prototype.answer = function(params) {\n        var dialog = this;\n\t\n        if (!dialog.answered) {\n\t    if (!params) {\n\t\tparams = {};\n\t    }\n\n\t    params.sdp = dialog.params.sdp;\n\n            if (params) {\n                if (params.useVideo) {\n                    dialog.useVideo(true);\n                }\n\t\tdialog.params.callee_id_name = params.callee_id_name;\n\t\tdialog.params.callee_id_number = params.callee_id_number;\n\n\t\tif (params.useCamera) {\n            dialog.useCamera = params.useCamera;\n            dialog.useCameraLabel = params.useCameraLabel;\n\t\t}\n\n\t\tif (params.useMic) {\n            dialog.useMic = params.useMic;\n            dialog.useMic = params.useMicLabel;\n\t\t}\n\n\t\tif (params.useSpeak) {\n\t\t    dialog.useSpeak = params.useSpeak;\n\t\t}\n            }\n\t    \n            dialog.rtc.createAnswer(params);\n            dialog.answered = true;\n        }\n    };\n\n    $.verto.dialog.prototype.handleAnswer = function(params) {\n        var dialog = this;\n\n        dialog.gotAnswer = true;\n\n        if (dialog.state.val >= $.verto.enum.state.active.val) {\n            return;\n        }\n\n        if (dialog.state.val >= $.verto.enum.state.early.val) {\n            dialog.setState($.verto.enum.state.active);\n        } else {\n            if (dialog.gotEarly) {\n                console.log(\"Dialog \" + dialog.callID + \" Got answer while still establishing early media, delaying...\");\n            } else {\n                console.log(\"Dialog \" + dialog.callID + \" Answering Channel\");\n                dialog.rtc.answer(params.sdp, function() {\n                    dialog.setState($.verto.enum.state.active);\n                }, function(e) {\n                    console.error(e);\n                    dialog.hangup();\n                });\n                console.log(\"Dialog \" + dialog.callID + \"ANSWER SDP\", params.sdp);\n            }\n        }\n\n\n    };\n\n    $.verto.dialog.prototype.cidString = function(enc) {\n        var dialog = this;\n        var party = dialog.params.remote_caller_id_name + (enc ? \" &lt;\" : \" <\") + dialog.params.remote_caller_id_number + (enc ? \"&gt;\" : \">\");\n        return party;\n    };\n\n    $.verto.dialog.prototype.sendMessage = function(msg, params) {\n        var dialog = this;\n\n        if (dialog.callbacks.onMessage) {\n            dialog.callbacks.onMessage(dialog.verto, dialog, msg, params);\n        }\n    };\n\n    $.verto.dialog.prototype.handleInfo = function(params) {\n        var dialog = this;\n\n        dialog.sendMessage($.verto.enum.message.info, params);\n\n    };\n\n    $.verto.dialog.prototype.handleDisplay = function(params) {\n        var dialog = this;\n\n        if (params.display_name) {\n            dialog.params.remote_caller_id_name = params.display_name;\n        }\n        if (params.display_number) {\n            dialog.params.remote_caller_id_number = params.display_number;\n        }\n\n        dialog.sendMessage($.verto.enum.message.display, {});\n    };\n\n    $.verto.dialog.prototype.handleMedia = function(params) {\n        var dialog = this;\n\n        if (dialog.state.val >= $.verto.enum.state.early.val) {\n            return;\n        }\n\n        dialog.gotEarly = true;\n\n        dialog.rtc.answer(params.sdp, function() {\n            console.log(\"Dialog \" + dialog.callID + \"Establishing early media\");\n            dialog.setState($.verto.enum.state.early);\n\n            if (dialog.gotAnswer) {\n                console.log(\"Dialog \" + dialog.callID + \"Answering Channel\");\n                dialog.setState($.verto.enum.state.active);\n            }\n        }, function(e) {\n            console.error(e);\n            dialog.hangup();\n        });\n        console.log(\"Dialog \" + dialog.callID + \"EARLY SDP\", params.sdp);\n    };\n\n    $.verto.ENUM = function(s) {\n        var i = 0,\n        o = {};\n        s.split(\" \").map(function(x) {\n            o[x] = {\n                name: x,\n                val: i++\n            };\n        });\n        return Object.freeze(o);\n    };\n\n    $.verto.enum = {};\n\n    $.verto.enum.states = Object.freeze({\n        new: {\n            requesting: 1,\n            recovering: 1,\n            ringing: 1,\n            destroy: 1,\n            answering: 1,\n\t    hangup: 1\n        },\n        requesting: {\n            trying: 1,\n            hangup: 1,\n\t    active: 1\n        },\n        recovering: {\n            answering: 1,\n            hangup: 1\n        },\n        trying: {\n            active: 1,\n            early: 1,\n            hangup: 1\n        },\n        ringing: {\n            answering: 1,\n            hangup: 1\n        },\n        answering: {\n            active: 1,\n            hangup: 1\n        },\n        active: {\n            answering: 1,\n            requesting: 1,\n            hangup: 1,\n            held: 1\n        },\n        held: {\n            hangup: 1,\n            active: 1\n        },\n        early: {\n            hangup: 1,\n            active: 1\n        },\n        hangup: {\n            destroy: 1\n        },\n        destroy: {},\n        purge: {\n            destroy: 1\n        }\n    });\n\n    $.verto.enum.state = $.verto.ENUM(\"new requesting trying recovering ringing answering early active held hangup destroy purge\");\n    $.verto.enum.direction = $.verto.ENUM(\"inbound outbound\");\n    $.verto.enum.message = $.verto.ENUM(\"display info pvtEvent clientReady\");\n\n    $.verto.enum = Object.freeze($.verto.enum);\n\n    $.verto.saved = [];\n    \n    $.verto.unloadJobs = [];\n\n    var unloadEventName = 'beforeunload';\n    // Hacks for Mobile Safari\n    var iOS = ['iPad', 'iPhone', 'iPod'].indexOf(navigator.platform) >= 0;\n    if (iOS) {\n      unloadEventName = 'pagehide';\n    }\n\n    $(window).bind(unloadEventName, function() {\n        for (var f in $.verto.unloadJobs) {\n          $.verto.unloadJobs[f]();\n        }\n\n        if ($.verto.haltClosure)\n          return $.verto.haltClosure();\n\n        for (var i in $.verto.saved) {\n            var verto = $.verto.saved[i];\n            if (verto) {\n                verto.purge();\n                verto.logout();\n            }\n        }\n\n        return $.verto.warnOnUnload;\n    });\n\n    $.verto.videoDevices = [];\n    $.verto.audioInDevices = [];\n    $.verto.audioOutDevices = [];\n\n    var checkDevices = function(runtime) {\n\tconsole.info(\"enumerating devices\");\n\tvar aud_in = [], aud_out = [], vid = [];\t\n\tvar has_video = 0, has_audio = 0;\n\tvar Xstream;\n\n\tfunction gotDevices(deviceInfos) {\n\t      // Handles being called several times to update labels. Preserve values.\n\t    for (var i = 0; i !== deviceInfos.length; ++i) {\n\t\tvar deviceInfo = deviceInfos[i];\n\t\tvar text = \"\";\n\n\t\tconsole.log(deviceInfo);\n\t\tconsole.log(deviceInfo.kind + \": \" + deviceInfo.label + \" id = \" + deviceInfo.deviceId);\n\n\t\tif (deviceInfo.kind === 'audioinput') {\n\t\t    text = deviceInfo.label || 'microphone ' + (aud_in.length + 1);\n\t\t    aud_in.push({id: deviceInfo.deviceId, kind: \"audio_in\", label: text});\n\t\t} else if (deviceInfo.kind === 'audiooutput') {\n\t\t    text = deviceInfo.label || 'speaker ' + (aud_out.length + 1);\n\t\t    aud_out.push({id: deviceInfo.deviceId, kind: \"audio_out\", label: text});\n\t\t} else if (deviceInfo.kind === 'videoinput') {\n\t\t    text = deviceInfo.label || 'camera ' + (vid.length + 1);\n\t\t    vid.push({id: deviceInfo.deviceId, kind: \"video\", label: text});\n\t\t} else {\n\t\t    console.log('Some other kind of source/device: ', deviceInfo);\n\t\t}\n\t    }\n\n\n\t    $.verto.videoDevices = vid;\n\t    $.verto.audioInDevices = aud_in;\n\t    $.verto.audioOutDevices = aud_out;\n\t    \n\t    console.info(\"Audio IN Devices\", $.verto.audioInDevices);\n\t    console.info(\"Audio Out Devices\", $.verto.audioOutDevices);\n\t    console.info(\"Video Devices\", $.verto.videoDevices);\n\n\t    if (Xstream) {\n\t\tXstream.getTracks().forEach(function(track) {track.stop();});\n\t    }\n\n\t    if (runtime) {\n\t\truntime(true);\n\t    }\n\t}\n\n\n\t\n\n\tfunction handleError(error) {\n\t    console.log('device enumeration error: ', error);\n\t    if (runtime) runtime(false);\n\t}\n\n\n\tfunction checkTypes(devs) {\n\t    for (var i = 0; i !== devs.length; ++i) {\n\n\t\tif (devs[i].kind === 'audioinput') {\n\t\t    has_audio++;\n\t\t} else if (devs[i].kind === 'videoinput') {\n\t\t    has_video++;\n\t\t}\n\t    }\n\n\t    navigator.getUserMedia({ audio: (has_audio > 0 ? true : false), video: (has_video > 0 ? true : false)},\n\t\t\t\t   function(stream) {\n\t\t\t\t       Xstream = stream;\n\t\t\t\t       navigator.mediaDevices.enumerateDevices().then(gotDevices).catch(handleError);\n\t\t\t\t   },\n\t\t\t\t   function(err) {\n\t\t\t\t       console.log(\"The following error occurred: \" + err.name);\n\t\t\t\t   }\n\t\t\t\t  );\n\t}\n\n\tnavigator.mediaDevices.enumerateDevices().then(checkTypes).catch(handleError);\n\n  };\n\n    $.verto.refreshDevices = function(runtime) {\n\tcheckDevices(runtime);\n    }\n\n    $.verto.init = function(obj, runtime) {\n\tif (!obj) {\n\t    obj = {};\n\t}\n\n\tif (!obj.skipPermCheck && !obj.skipDeviceCheck) {\n\t    $.FSRTC.checkPerms(function(status) {\n\t\tcheckDevices(runtime);\n\t    }, true, true);\n\t} else if (obj.skipPermCheck && !obj.skipDeviceCheck) {\n\t    checkDevices(runtime);\n\t} else if (!obj.skipPermCheck && obj.skipDeviceCheck) {\n\t    $.FSRTC.checkPerms(function(status) {\n\t\truntime(status);\n\t    }, true, true);\n\t} else {\n\t    runtime(null);\n\t}\n\n    }\n\n    $.verto.genUUID = function () {\n\treturn generateGUID();\n    }\n\n\n})(jQuery);\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nvar _adapter_factory = require('./adapter_factory.js');\n\nvar adapter = (0, _adapter_factory.adapterFactory)({ window: window });\nmodule.exports = adapter; // this is the difference from adapter_core.\n\n},{\"./adapter_factory.js\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.adapterFactory = adapterFactory;\n\nvar _utils = require('./utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _chrome_shim = require('./chrome/chrome_shim');\n\nvar chromeShim = _interopRequireWildcard(_chrome_shim);\n\nvar _edge_shim = require('./edge/edge_shim');\n\nvar edgeShim = _interopRequireWildcard(_edge_shim);\n\nvar _firefox_shim = require('./firefox/firefox_shim');\n\nvar firefoxShim = _interopRequireWildcard(_firefox_shim);\n\nvar _safari_shim = require('./safari/safari_shim');\n\nvar safariShim = _interopRequireWildcard(_safari_shim);\n\nvar _common_shim = require('./common_shim');\n\nvar commonShim = _interopRequireWildcard(_common_shim);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Shimming starts here.\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nfunction adapterFactory() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      window = _ref.window;\n\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    shimChrome: true,\n    shimFirefox: true,\n    shimEdge: true,\n    shimSafari: true\n  };\n\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n\n  var adapter = {\n    browserDetails: browserDetails,\n    commonShim: commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n      chromeShim.shimSenderReceiverGetStats(window);\n      chromeShim.fixNegotiationNeeded(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n      firefoxShim.shimSenderGetStats(window);\n      firefoxShim.shimReceiverGetStats(window);\n      firefoxShim.shimRTCDataChannel(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimGetDisplayMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCreateOfferLegacy(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n\n// Browser shims.\n\n},{\"./chrome/chrome_shim\":3,\"./common_shim\":6,\"./edge/edge_shim\":7,\"./firefox/firefox_shim\":11,\"./safari/safari_shim\":14,\"./utils\":15}],3:[function(require,module,exports){\n\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimMediaStream = shimMediaStream;\nexports.shimOnTrack = shimOnTrack;\nexports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\nexports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\nexports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\nexports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.fixNegotiationNeeded = fixNegotiationNeeded;\n\nvar _utils = require('../utils.js');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/* iterates the stats graph recursively. */\nfunction walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(function (name) {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(function (id) {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nfunction filterStats(result, track, outbound) {\n  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  var filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  var trackStats = [];\n  result.forEach(function (value) {\n    if (value.type === 'track' && value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(function (trackStat) {\n    result.forEach(function (stats) {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\nfunction shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get: function get() {\n        return this._ontrack;\n      },\n      set: function set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n\n      enumerable: true,\n      configurable: true\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function () {\n      var _this = this;\n\n      if (!this._ontrackpoly) {\n        this._ontrackpoly = function (e) {\n          // onaddstream does not fire when a track is added to an existing\n          // stream. But stream.onaddtrack is implemented so we use that.\n          e.stream.addEventListener('addtrack', function (te) {\n            var receiver = void 0;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === te.track.id;\n              });\n            } else {\n              receiver = { track: te.track };\n            }\n\n            var event = new Event('track');\n            event.track = te.track;\n            event.receiver = receiver;\n            event.transceiver = { receiver: receiver };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n          e.stream.getTracks().forEach(function (track) {\n            var receiver = void 0;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === track.id;\n              });\n            } else {\n              receiver = { track: track };\n            }\n            var event = new Event('track');\n            event.track = track;\n            event.receiver = receiver;\n            event.transceiver = { receiver: receiver };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n        };\n        this.addEventListener('addstream', this._ontrackpoly);\n      }\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver', { value: { receiver: e.receiver } });\n      }\n      return e;\n    });\n  }\n}\n\nfunction shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    var shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\n      return {\n        track: track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function () {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n        var sender = origAddTrack.apply(this, arguments);\n        if (!sender) {\n          sender = shimSenderWithDtmf(this, track);\n          this._senders.push(sender);\n        }\n        return sender;\n      };\n\n      var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack = function (sender) {\n        origRemoveTrack.apply(this, arguments);\n        var idx = this._senders.indexOf(sender);\n        if (idx !== -1) {\n          this._senders.splice(idx, 1);\n        }\n      };\n    }\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function (stream) {\n      var _this2 = this;\n\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(function (track) {\n        _this2._senders.push(shimSenderWithDtmf(_this2, track));\n      });\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function (stream) {\n      var _this3 = this;\n\n      this._senders = this._senders || [];\n      origRemoveStream.apply(this, [stream]);\n\n      stream.getTracks().forEach(function (track) {\n        var sender = _this3._senders.find(function (s) {\n          return s.track === track;\n        });\n        if (sender) {\n          // remove sender\n          _this3._senders.splice(_this3._senders.indexOf(sender), 1);\n        }\n      });\n    };\n  } else if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function () {\n      var _this4 = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this4;\n      });\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nfunction shimSenderReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function () {\n        var _this5 = this;\n\n        var senders = origGetSenders.apply(this, []);\n        senders.forEach(function (sender) {\n          return sender._pc = _this5;\n        });\n        return senders;\n      };\n    }\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function () {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function () {\n      var sender = this;\n      return this._pc.getStats().then(function (result) {\n        return (\n          /* Note: this will include stats of all senders that\n           *   send a track with the same id as sender.track as\n           *   it is not possible to identify the RTCRtpSender.\n           */\n          filterStats(result, sender.track, true)\n        );\n      });\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function () {\n        var _this6 = this;\n\n        var receivers = origGetReceivers.apply(this, []);\n        receivers.forEach(function (receiver) {\n          return receiver._pc = _this6;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function () {\n      var receiver = this;\n      return this._pc.getStats().then(function (result) {\n        return filterStats(result, receiver.track, false);\n      });\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function () {\n    if (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\n      var track = arguments[0];\n      var sender = void 0;\n      var receiver = void 0;\n      var err = void 0;\n      this.getSenders().forEach(function (s) {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(function (r) {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || sender && receiver) {\n        return Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nfunction shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams = function () {\n    var _this7 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    return Object.keys(this._shimmedLocalStreams).map(function (streamId) {\n      return _this7._shimmedLocalStreams[streamId][0];\n    });\n  };\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n    if (!stream) {\n      return origAddTrack.apply(this, arguments);\n    }\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    var sender = origAddTrack.apply(this, arguments);\n    if (!this._shimmedLocalStreams[stream.id]) {\n      this._shimmedLocalStreams[stream.id] = [stream, sender];\n    } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n      this._shimmedLocalStreams[stream.id].push(sender);\n    }\n    return sender;\n  };\n\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function (stream) {\n    var _this8 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this8.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    var existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    var newSenders = this.getSenders().filter(function (newSender) {\n      return existingSenders.indexOf(newSender) === -1;\n    });\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function (stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    delete this._shimmedLocalStreams[stream.id];\n    return origRemoveStream.apply(this, arguments);\n  };\n\n  var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack = function (sender) {\n    var _this9 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    if (sender) {\n      Object.keys(this._shimmedLocalStreams).forEach(function (streamId) {\n        var idx = _this9._shimmedLocalStreams[streamId].indexOf(sender);\n        if (idx !== -1) {\n          _this9._shimmedLocalStreams[streamId].splice(idx, 1);\n        }\n        if (_this9._shimmedLocalStreams[streamId].length === 1) {\n          delete _this9._shimmedLocalStreams[streamId];\n        }\n      });\n    }\n    return origRemoveTrack.apply(this, arguments);\n  };\n}\n\nfunction shimAddTrackRemoveTrack(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  var origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams = function () {\n    var _this10 = this;\n\n    var nativeStreams = origGetLocalStreams.apply(this);\n    this._reverseStreams = this._reverseStreams || {};\n    return nativeStreams.map(function (stream) {\n      return _this10._reverseStreams[stream.id];\n    });\n  };\n\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function (stream) {\n    var _this11 = this;\n\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this11.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      var newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function (stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    origRemoveStream.apply(this, [this._streams[stream.id] || stream]);\n    delete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\n    delete this._streams[stream.id];\n  };\n\n  window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n    var _this12 = this;\n\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    var streams = [].slice.call(arguments, 1);\n    if (streams.length !== 1 || !streams[0].getTracks().find(function (t) {\n      return t === track;\n    })) {\n      // this is not fully correct but all we can manage without\n      // [[associated MediaStreams]] internal slot.\n      throw new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\n    }\n\n    var alreadyExists = this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n    if (alreadyExists) {\n      throw new DOMException('Track already exists.', 'InvalidAccessError');\n    }\n\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n    var oldStream = this._streams[stream.id];\n    if (oldStream) {\n      // this is using odd Chrome behaviour, use with caution:\n      // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n      // Note: we rely on the high-level addTrack/dtmf shim to\n      // create the sender with a dtmf sender.\n      oldStream.addTrack(track);\n\n      // Trigger ONN async.\n      Promise.resolve().then(function () {\n        _this12.dispatchEvent(new Event('negotiationneeded'));\n      });\n    } else {\n      var newStream = new window.MediaStream([track]);\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      this.addStream(newStream);\n    }\n    return this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n  };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    window.RTCPeerConnection.prototype[method] = function () {\n      var _this13 = this;\n\n      var args = arguments;\n      var isLegacyCall = arguments.length && typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [function (description) {\n          var desc = replaceInternalStreamId(_this13, description);\n          args[0].apply(null, [desc]);\n        }, function (err) {\n          if (args[1]) {\n            args[1].apply(null, err);\n          }\n        }, arguments[2]]);\n      }\n      return nativeMethod.apply(this, arguments).then(function (description) {\n        return replaceInternalStreamId(_this13, description);\n      });\n    };\n  });\n\n  var origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription = function () {\n    if (!arguments.length || !arguments[0].type) {\n      return origSetLocalDescription.apply(this, arguments);\n    }\n    arguments[0] = replaceExternalStreamId(this, arguments[0]);\n    return origSetLocalDescription.apply(this, arguments);\n  };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  var origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\n    get: function get() {\n      var description = origLocalDescription.get.apply(this);\n      if (description.type === '') {\n        return description;\n      }\n      return replaceInternalStreamId(this, description);\n    }\n  });\n\n  window.RTCPeerConnection.prototype.removeTrack = function (sender) {\n    var _this14 = this;\n\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    // We can not yet check for sender instanceof RTCRtpSender\n    // since we shim RTPSender. So we check if sender._pc is set.\n    if (!sender._pc) {\n      throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\n    }\n    var isLocal = sender._pc === this;\n    if (!isLocal) {\n      throw new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\n    }\n\n    // Search for the native stream the senders track belongs to.\n    this._streams = this._streams || {};\n    var stream = void 0;\n    Object.keys(this._streams).forEach(function (streamid) {\n      var hasTrack = _this14._streams[streamid].getTracks().find(function (track) {\n        return sender.track === track;\n      });\n      if (hasTrack) {\n        stream = _this14._streams[streamid];\n      }\n    });\n\n    if (stream) {\n      if (stream.getTracks().length === 1) {\n        // if this is the last track of the stream, remove the stream. This\n        // takes care of any shimmed _senders.\n        this.removeStream(this._reverseStreams[stream.id]);\n      } else {\n        // relying on the same odd chrome behaviour as above.\n        stream.removeTrack(sender.track);\n      }\n      this.dispatchEvent(new Event('negotiationneeded'));\n    }\n  };\n}\n\nfunction shimPeerConnection(window) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function (selector, successCallback, errorCallback) {\n    var _this15 = this;\n\n    var args = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 || typeof arguments[0] !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    var fixChromeStats_ = function fixChromeStats_(response) {\n      var standardReport = {};\n      var reports = response.result();\n      reports.forEach(function (report) {\n        var standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(function (name) {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function makeMapStats(stats) {\n      return new Map(Object.keys(stats).map(function (key) {\n        return [key, stats[key]];\n      }));\n    };\n\n    if (arguments.length >= 2) {\n      var successCallbackWrapper_ = function successCallbackWrapper_(response) {\n        args[1](makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_, arguments[0]]);\n    }\n\n    // promise-support\n    return new Promise(function (resolve, reject) {\n      origGetStats.apply(_this15, [function (response) {\n        resolve(makeMapStats(fixChromeStats_(response)));\n      }, reject]);\n    }).then(successCallback, errorCallback);\n  };\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    window.RTCPeerConnection.prototype[method] = function () {\n      arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // support for addIceCandidate(null or undefined)\n  var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n  window.RTCPeerConnection.prototype.addIceCandidate = function () {\n    if (!arguments[0]) {\n      if (arguments[1]) {\n        arguments[1].apply(null);\n      }\n      return Promise.resolve();\n    }\n    return nativeAddIceCandidate.apply(this, arguments);\n  };\n}\n\nfunction fixNegotiationNeeded(window) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function (e) {\n    var pc = e.target;\n    if (pc.signalingState !== 'stable') {\n      return;\n    }\n    return e;\n  });\n}\n\n},{\"../utils.js\":15,\"./getdisplaymedia\":4,\"./getusermedia\":5}],4:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function (constraints) {\n    return getSourceId(constraints).then(function (sourceId) {\n      var widthSpecified = constraints.video && constraints.video.width;\n      var heightSpecified = constraints.video && constraints.video.height;\n      var frameRateSpecified = constraints.video && constraints.video.frameRate;\n      constraints.video = {\n        mandatory: {\n          chromeMediaSource: 'desktop',\n          chromeMediaSourceId: sourceId,\n          maxFrameRate: frameRateSpecified || 3\n        }\n      };\n      if (widthSpecified) {\n        constraints.video.mandatory.maxWidth = widthSpecified;\n      }\n      if (heightSpecified) {\n        constraints.video.mandatory.maxHeight = heightSpecified;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    });\n  };\n}\n\n},{}],5:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimGetUserMedia = shimGetUserMedia;\n\nvar _utils = require('../utils.js');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar logging = utils.log;\n\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  var browserDetails = utils.detectBrowser(window);\n\n  var constraintsToChrome_ = function constraintsToChrome_(c) {\n    if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function (key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = _typeof(c[key]) === 'object' ? c[key] : { ideal: c[key] };\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function oldname_(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return name === 'deviceId' ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function (mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function shimConstraints_(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && _typeof(constraints.audio) === 'object') {\n      var remap = function remap(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && _typeof(constraints.video) === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'undefined' ? 'undefined' : _typeof(face)) === 'object' ? face : { ideal: face });\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches = void 0;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices().then(function (devices) {\n            devices = devices.filter(function (d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function (d) {\n              return matches.some(function (match) {\n                return d.label.toLowerCase().includes(match);\n              });\n            });\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? { exact: dev.deviceId } : { ideal: dev.deviceId };\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function shimError_(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString: function toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function (c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function (e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function (cs) {\n    return shimConstraints_(cs, function (c) {\n      return origGetUserMedia(c).then(function (stream) {\n        if (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function (track) {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, function (e) {\n        return Promise.reject(shimError_(e));\n      });\n    });\n  };\n}\n\n},{\"../utils.js\":15}],6:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimRTCIceCandidate = shimRTCIceCandidate;\nexports.shimMaxMessageSize = shimMaxMessageSize;\nexports.shimSendThrowTypeError = shimSendThrowTypeError;\nexports.shimConnectionState = shimConnectionState;\nexports.removeAllowExtmapMixed = removeAllowExtmapMixed;\n\nvar _sdp = require('sdp');\n\nvar _sdp2 = _interopRequireDefault(_sdp);\n\nvar _utils = require('./utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\n    return;\n  }\n\n  var NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function (args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if ((typeof args === 'undefined' ? 'undefined' : _typeof(args)) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      var nativeCandidate = new NativeRTCIceCandidate(args);\n      var parsedCandidate = _sdp2.default.parseCandidate(args.candidate);\n      var augmentedCandidate = Object.assign(nativeCandidate, parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function () {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nfunction shimMaxMessageSize(window) {\n  if (window.RTCSctpTransport || !window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get: function get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  var sctpInDescription = function sctpInDescription(description) {\n    var sections = _sdp2.default.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(function (mediaSection) {\n      var mLine = _sdp2.default.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  var getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    var version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  var getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    var canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  var getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    var maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    var match = _sdp2.default.matchPrefix(description.sdp, 'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function () {\n    this._sctp = null;\n\n    if (sctpInDescription(arguments[0])) {\n      // Check if the remote is FF.\n      var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n      // Get the maximum message size the local peer is capable of sending\n      var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n      // Get the maximum message size of the remote peer.\n      var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n      // Determine final maximum message size\n      var maxMessageSize = void 0;\n      if (canSendMMS === 0 && remoteMMS === 0) {\n        maxMessageSize = Number.POSITIVE_INFINITY;\n      } else if (canSendMMS === 0 || remoteMMS === 0) {\n        maxMessageSize = Math.max(canSendMMS, remoteMMS);\n      } else {\n        maxMessageSize = Math.min(canSendMMS, remoteMMS);\n      }\n\n      // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n      // attribute.\n      var sctp = {};\n      Object.defineProperty(sctp, 'maxMessageSize', {\n        get: function get() {\n          return maxMessageSize;\n        }\n      });\n      this._sctp = sctp;\n    }\n\n    return origSetRemoteDescription.apply(this, arguments);\n  };\n}\n\nfunction shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    var origDataChannelSend = dc.send;\n    dc.send = function () {\n      var data = arguments[0];\n      var length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' + pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  var origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel = function () {\n    var dataChannel = origCreateDataChannel.apply(this, arguments);\n    wrapDcSend(dataChannel, this);\n    return dataChannel;\n  };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', function (e) {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nfunction shimConnectionState(window) {\n  if (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get: function get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get: function get() {\n      return this._onconnectionstatechange || null;\n    },\n    set: function set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange', this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\n      }\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach(function (method) {\n    var origMethod = proto[method];\n    proto[method] = function () {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = function (e) {\n          var pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            var newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nfunction removeAllowExtmapMixed(window) {\n  /* remove a=extmap-allow-mixed for Chrome < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  var nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function (desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      desc.sdp = desc.sdp.split('\\n').filter(function (line) {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\n},{\"./utils\":15,\"sdp\":17}],7:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimReplaceTrack = shimReplaceTrack;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _filtericeservers = require('./filtericeservers');\n\nvar _rtcpeerconnectionShim = require('rtcpeerconnection-shim');\n\nvar _rtcpeerconnectionShim2 = _interopRequireDefault(_rtcpeerconnectionShim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function (args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function (args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      var origMSTEnabled = Object.getOwnPropertyDescriptor(window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set: function set(value) {\n          origMSTEnabled.set.call(this, value);\n          var ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  var RTCPeerConnectionShim = (0, _rtcpeerconnectionShim2.default)(window, browserDetails.version);\n  window.RTCPeerConnection = function (config) {\n    if (config && config.iceServers) {\n      config.iceServers = (0, _filtericeservers.filterIceServers)(config.iceServers, browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nfunction shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender && !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack = window.RTCRtpSender.prototype.setTrack;\n  }\n}\n\n},{\"../utils\":15,\"./filtericeservers\":8,\"./getdisplaymedia\":9,\"./getusermedia\":10,\"rtcpeerconnection-shim\":16}],8:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.filterIceServers = filterIceServers;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function (server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function (url) {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        var validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n},{\"../utils\":15}],9:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = window.navigator.getDisplayMedia.bind(window.navigator.mediaDevices);\n}\n\n},{}],10:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetUserMedia = shimGetUserMedia;\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  var shimError_ = function shimError_(e) {\n    return {\n      name: { PermissionDeniedError: 'NotAllowedError' }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function (c) {\n    return origGetUserMedia(c).catch(function (e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n}\n\n},{}],11:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimSenderGetStats = shimSenderGetStats;\nexports.shimReceiverGetStats = shimReceiverGetStats;\nexports.shimRemoveStream = shimRemoveStream;\nexports.shimRTCDataChannel = shimRTCDataChannel;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n  ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    window.RTCPeerConnection.prototype[method] = function () {\n      arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // support for addIceCandidate(null or undefined)\n  var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n  window.RTCPeerConnection.prototype.addIceCandidate = function () {\n    if (!arguments[0]) {\n      if (arguments[1]) {\n        arguments[1].apply(null);\n      }\n      return Promise.resolve();\n    }\n    return nativeAddIceCandidate.apply(this, arguments);\n  };\n\n  var modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function (selector, onSucc, onErr) {\n    return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n      if (browserDetails.version < 53 && !onSucc) {\n        // Shim only promise getStats with spec-hyphens in type names\n        // Leave callback version alone; misc old uses of forEach before Map\n        try {\n          stats.forEach(function (stat) {\n            stat.type = modernStatsTypes[stat.type] || stat.type;\n          });\n        } catch (e) {\n          if (e.name !== 'TypeError') {\n            throw e;\n          }\n          // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n          stats.forEach(function (stat, i) {\n            stats.set(i, Object.assign({}, stat, {\n              type: modernStatsTypes[stat.type] || stat.type\n            }));\n          });\n        }\n      }\n      return stats;\n    }).then(onSucc, onErr);\n  };\n}\n\nfunction shimSenderGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function () {\n      var _this = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this;\n      });\n      return senders;\n    };\n  }\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function () {\n      var sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function () {\n    return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n  };\n}\n\nfunction shimReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function () {\n      var _this2 = this;\n\n      var receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(function (receiver) {\n        return receiver._pc = _this2;\n      });\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function () {\n    return this._pc.getStats(this.track);\n  };\n}\n\nfunction shimRemoveStream(window) {\n  if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream = function (stream) {\n    var _this3 = this;\n\n    utils.deprecated('removeStream', 'removeTrack');\n    this.getSenders().forEach(function (sender) {\n      if (sender.track && stream.getTracks().includes(sender.track)) {\n        _this3.removeTrack(sender);\n      }\n    });\n  };\n}\n\nfunction shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\n},{\"../utils\":15,\"./getdisplaymedia\":12,\"./getusermedia\":13}],12:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function (constraints) {\n    if (!(constraints && constraints.video)) {\n      var err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\n      err.name = 'NotFoundError';\n      // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n      err.code = 8;\n      return Promise.reject(err);\n    }\n    if (constraints.video === true) {\n      constraints.video = { mediaSource: preferredMediaSource };\n    } else {\n      constraints.video.mediaSource = preferredMediaSource;\n    }\n    return window.navigator.mediaDevices.getUserMedia(constraints);\n  };\n}\n\n},{}],13:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimGetUserMedia = shimGetUserMedia;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimGetUserMedia(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function (constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function remap(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (c) {\n      if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object' && _typeof(c.audio) === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function () {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function (c) {\n        if (this.kind === 'audio' && (typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n\n},{\"../utils\":15}],14:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimLocalStreamsAPI = shimLocalStreamsAPI;\nexports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\nexports.shimCallbacksAPI = shimCallbacksAPI;\nexports.shimGetUserMedia = shimGetUserMedia;\nexports.shimConstraints = shimConstraints;\nexports.shimRTCIceServerUrls = shimRTCIceServerUrls;\nexports.shimTrackEventTransceiver = shimTrackEventTransceiver;\nexports.shimCreateOfferLegacy = shimCreateOfferLegacy;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimLocalStreamsAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams = function () {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      return this._localStreams;\n    };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function (stream) {\n      var _this = this;\n\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      stream.getTracks().forEach(function (track) {\n        return _addTrack.call(_this, track, stream);\n      });\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n      if (stream) {\n        if (!this._localStreams) {\n          this._localStreams = [stream];\n        } else if (!this._localStreams.includes(stream)) {\n          this._localStreams.push(stream);\n        }\n      }\n      return _addTrack.call(this, track, stream);\n    };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream = function (stream) {\n      var _this2 = this;\n\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      var index = this._localStreams.indexOf(stream);\n      if (index === -1) {\n        return;\n      }\n      this._localStreams.splice(index, 1);\n      var tracks = stream.getTracks();\n      this.getSenders().forEach(function (sender) {\n        if (tracks.includes(sender.track)) {\n          _this2.removeTrack(sender);\n        }\n      });\n    };\n  }\n}\n\nfunction shimRemoteStreamsAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams = function () {\n      return this._remoteStreams ? this._remoteStreams : [];\n    };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get: function get() {\n        return this._onaddstream;\n      },\n      set: function set(f) {\n        var _this3 = this;\n\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!_this3._remoteStreams) {\n              _this3._remoteStreams = [];\n            }\n            if (_this3._remoteStreams.includes(stream)) {\n              return;\n            }\n            _this3._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            _this3.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function () {\n      var pc = this;\n      if (!this._onaddstreampoly) {\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!pc._remoteStreams) {\n              pc._remoteStreams = [];\n            }\n            if (pc._remoteStreams.indexOf(stream) >= 0) {\n              return;\n            }\n            pc._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            pc.dispatchEvent(event);\n          });\n        });\n      }\n      return origSetRemoteDescription.apply(pc, arguments);\n    };\n  }\n}\n\nfunction shimCallbacksAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  var prototype = window.RTCPeerConnection.prototype;\n  var createOffer = prototype.createOffer;\n  var createAnswer = prototype.createAnswer;\n  var setLocalDescription = prototype.setLocalDescription;\n  var setRemoteDescription = prototype.setRemoteDescription;\n  var addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer = function (successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = createOffer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n\n  prototype.createAnswer = function (successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = createAnswer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n\n  var withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function withCallback(candidate, successCallback, failureCallback) {\n    var promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    var mediaDevices = navigator.mediaDevices;\n    var _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function (constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nfunction shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({}, constraints, { video: utils.compactObject(constraints.video) });\n  }\n\n  return constraints;\n}\n\nfunction shimRTCIceServerUrls(window) {\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  var OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection = function (pcConfig, pcConstraints) {\n    if (pcConfig && pcConfig.iceServers) {\n      var newIceServers = [];\n      for (var i = 0; i < pcConfig.iceServers.length; i++) {\n        var server = pcConfig.iceServers[i];\n        if (!server.hasOwnProperty('urls') && server.hasOwnProperty('url')) {\n          utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n          server = JSON.parse(JSON.stringify(server));\n          server.urls = server.url;\n          delete server.url;\n          newIceServers.push(server);\n        } else {\n          newIceServers.push(pcConfig.iceServers[i]);\n        }\n      }\n      pcConfig.iceServers = newIceServers;\n    }\n    return new OrigPeerConnection(pcConfig, pcConstraints);\n  };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in window.RTCPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get: function get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nfunction shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'receiver' in window.RTCTrackEvent.prototype &&\n  // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is\n  // defined for some reason even when window.RTCTransceiver is not.\n  !window.RTCTransceiver) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimCreateOfferLegacy(window) {\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function (offerOptions) {\n    if (offerOptions) {\n      if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n      }\n      var audioTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.sender.track && transceiver.sender.track.kind === 'audio';\n      });\n      if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n        if (audioTransceiver.direction === 'sendrecv') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('sendonly');\n          } else {\n            audioTransceiver.direction = 'sendonly';\n          }\n        } else if (audioTransceiver.direction === 'recvonly') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('inactive');\n          } else {\n            audioTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\n        this.addTransceiver('audio');\n      }\n\n      if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n      }\n      var videoTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.sender.track && transceiver.sender.track.kind === 'video';\n      });\n      if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n        if (videoTransceiver.direction === 'sendrecv') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('sendonly');\n          } else {\n            videoTransceiver.direction = 'sendonly';\n          }\n        } else if (videoTransceiver.direction === 'recvonly') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('inactive');\n          } else {\n            videoTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\n        this.addTransceiver('video');\n      }\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\n},{\"../utils\":15}],15:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.extractVersion = extractVersion;\nexports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\nexports.disableLog = disableLog;\nexports.disableWarnings = disableWarnings;\nexports.log = log;\nexports.deprecated = deprecated;\nexports.detectBrowser = detectBrowser;\nexports.compactObject = compactObject;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nfunction extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function wrappedCallback(e) {\n      var modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        cb(modifiedEvent);\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\n  };\n\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap, this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap, this['_on' + eventNameToWrap] = cb);\n      }\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n}\n\nfunction disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nfunction disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nfunction log() {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nfunction deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod + ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nfunction detectBrowser(window) {\n  var navigator = window.navigator;\n\n  // Returned result object.\n\n  var result = { browser: null, version: null };\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  if (navigator.mozGetUserMedia) {\n    // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n    // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n    // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n  } else {\n    // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nfunction compactObject(data) {\n  if ((typeof data === 'undefined' ? 'undefined' : _typeof(data)) !== 'object') {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function (accumulator, key) {\n    var isObject = _typeof(data[key]) === 'object';\n    var value = isObject ? compactObject(data[key]) : data[key];\n    var isEmptyObject = isObject && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n\n    return Object.assign(accumulator, _defineProperty({}, key, value));\n  }, {});\n}\n\n},{}],16:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all field are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // dpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n\n},{\"sdp\":17}],17:[function(require,module,exports){\n /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.substr(17).split(' ');\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(msidParts) {\n    return msidParts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n\n},{}]},{},[1])(1)\n});\n\n// Last time updated at Oct 24, 2015, 08:32:23\n\n// Latest file can be found here: https://cdn.webrtc-experiment.com/getScreenId.js\n\n// Muaz Khan         - www.MuazKhan.com\n// MIT License       - www.WebRTC-Experiment.com/licence\n// Documentation     - https://github.com/muaz-khan/getScreenId.\n\n// ______________\n// getScreenId.js\n\n/*\ngetScreenId(function (error, sourceId, screen_constraints) {\n    // error    == null || 'permission-denied' || 'not-installed' || 'installed-disabled' || 'not-chrome'\n    // sourceId == null || 'string' || 'firefox'\n\n    if(sourceId == 'firefox') {\n        navigator.mozGetUserMedia(screen_constraints, onSuccess, onFailure);\n    }\n    else navigator.webkitGetUserMedia(screen_constraints, onSuccess, onFailure);\n});\n*/\n\n(function() {\n    window.getScreenId = function(callback) {\n        // for Firefox:\n        // sourceId == 'firefox'\n        // screen_constraints = {...}\n        if (!!navigator.mozGetUserMedia) {\n            callback(null, 'firefox', {\n                video: {\n                    mozMediaSource: 'window',\n                    mediaSource: 'window'\n                }\n            });\n            return;\n        }\n\n        postMessage();\n\n        window.addEventListener('message', onIFrameCallback);\n\n        function onIFrameCallback(event) {\n            if (!event.data) return;\n\n            if (event.data.chromeMediaSourceId) {\n                if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\n                    callback('permission-denied');\n                } else callback(null, event.data.chromeMediaSourceId, getScreenConstraints(null, event.data.chromeMediaSourceId));\n            }\n\n            if (event.data.chromeExtensionStatus) {\n                callback(event.data.chromeExtensionStatus, null, getScreenConstraints(event.data.chromeExtensionStatus));\n            }\n\n            // this event listener is no more needed\n            window.removeEventListener('message', onIFrameCallback);\n        }\n    };\n\n    function getScreenConstraints(error, sourceId) {\n        var screen_constraints = {\n            audio: false,\n            video: {\n                mandatory: {\n                    chromeMediaSource: error ? 'screen' : 'desktop',\n                    maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                    maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                },\n                optional: []\n            }\n        };\n\n        if (sourceId) {\n            screen_constraints.video.mandatory.chromeMediaSourceId = sourceId;\n        }\n\n        return screen_constraints;\n    }\n\n    function postMessage() {\n        if (!iframe) {\n            loadIFrame(postMessage);\n            return;\n        }\n\n        if (!iframe.isLoaded) {\n            setTimeout(postMessage, 100);\n            return;\n        }\n\n        iframe.contentWindow.postMessage({\n            captureSourceId: true\n        }, '*');\n    }\n\n    function loadIFrame(loadCallback) {\n        if (iframe) {\n            loadCallback();\n            return;\n        }\n\n        iframe = document.createElement('iframe');\n        iframe.onload = function() {\n            iframe.isLoaded = true;\n\n            loadCallback();\n        };\n        iframe.src = 'https://www.webrtc-experiment.com/getSourceId/'; // https://wwww.yourdomain.com/getScreenId.html\n        iframe.style.display = 'none';\n        (document.body || document.documentElement).appendChild(iframe);\n    }\n\n    var iframe;\n\n    // this function is used in v3.0\n    window.getScreenConstraints = function(callback) {\n        loadIFrame(function() {\n            getScreenId(function(error, sourceId, screen_constraints) {\n                callback(error, screen_constraints.video);\n            });\n        });\n    };\n})();\n\n(function() {\n    if(document.domain.indexOf('webrtc-experiment.com') === -1) {\n        return;\n    }\n\n    window.getScreenId = function(callback) {\n        // for Firefox:\n        // sourceId == 'firefox'\n        // screen_constraints = {...}\n        if (!!navigator.mozGetUserMedia) {\n            callback(null, 'firefox', {\n                video: {\n                    mozMediaSource: 'window',\n                    mediaSource: 'window'\n                }\n            });\n            return;\n        }\n\n        postMessage();\n\n        window.addEventListener('message', onIFrameCallback);\n\n        function onIFrameCallback(event) {\n            if (!event.data) return;\n\n            if (event.data.chromeMediaSourceId) {\n                if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\n                    callback('permission-denied');\n                } else callback(null, event.data.chromeMediaSourceId, getScreenConstraints(null, event.data.chromeMediaSourceId));\n            }\n\n            if (event.data.chromeExtensionStatus) {\n                callback(event.data.chromeExtensionStatus, null, getScreenConstraints(event.data.chromeExtensionStatus));\n            }\n\n            // this event listener is no more needed\n            window.removeEventListener('message', onIFrameCallback);\n        }\n    };\n\n    function getScreenConstraints(error, sourceId) {\n        var screen_constraints = {\n            audio: false,\n            video: {\n                mandatory: {\n                    chromeMediaSource: error ? 'screen' : 'desktop',\n                    maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                    maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                },\n                optional: []\n            }\n        };\n\n        if (sourceId) {\n            screen_constraints.video.mandatory.chromeMediaSourceId = sourceId;\n        }\n\n        return screen_constraints;\n    }\n\n    function postMessage() {\n        if (!iframe) {\n            loadIFrame(postMessage);\n            return;\n        }\n\n        if (!iframe.isLoaded) {\n            setTimeout(postMessage, 100);\n            return;\n        }\n\n        iframe.contentWindow.postMessage({\n            captureSourceId: true\n        }, '*');\n    }\n\n    function loadIFrame(loadCallback) {\n        if (iframe) {\n            loadCallback();\n            return;\n        }\n\n        iframe = document.createElement('iframe');\n        iframe.onload = function() {\n            iframe.isLoaded = true;\n\n            loadCallback();\n        };\n        iframe.src = 'https://www.webrtc-experiment.com/getSourceId/'; // https://wwww.yourdomain.com/getScreenId.html\n        iframe.style.display = 'none';\n        (document.body || document.documentElement).appendChild(iframe);\n    }\n\n    var iframe;\n\n    // this function is used in v3.0\n    window.getScreenConstraints = function(callback) {\n        loadIFrame(function() {\n            getScreenId(function(error, sourceId, screen_constraints) {\n                callback(error, screen_constraints.video);\n            });\n        });\n    };\n})();\n\n/*\n * JavaScript MD5 1.0.1\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n!function(a){\"use strict\";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c=\"\";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;16>c;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d=\"0123456789abcdef\",e=\"\";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}\"function\"==typeof define&&define.amd?define(function(){return t}):a.md5=t}(this);\n/*\nThe MIT License (MIT)\n\nCopyright (c) 2014 Chris Wilson\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n/*\n\nUsage:\naudioNode = createAudioMeter(audioContext,clipLevel,averaging,clipLag);\n\naudioContext: the AudioContext you're using.\nclipLevel: the level (0 to 1) that you would consider \"clipping\".\n   Defaults to 0.98.\naveraging: how \"smoothed\" you would like the meter to be over time.\n   Should be between 0 and less than 1.  Defaults to 0.95.\nclipLag: how long you would like the \"clipping\" indicator to show\n   after clipping has occured, in milliseconds.  Defaults to 750ms.\n\nAccess the clipping through node.checkClipping(); use node.shutdown to get rid of it.\n*/\n\nfunction createAudioMeter(audioContext,clipLevel,averaging,clipLag) {\n\tvar processor = audioContext.createScriptProcessor(512);\n\tprocessor.onaudioprocess = volumeAudioProcess;\n\tprocessor.clipping = false;\n\tprocessor.lastClip = 0;\n\tprocessor.volume = 0;\n\tprocessor.clipLevel = clipLevel || 0.98;\n\tprocessor.averaging = averaging || 0.95;\n\tprocessor.clipLag = clipLag || 750;\n\n\t// this will have no effect, since we don't copy the input to the output,\n\t// but works around a current Chrome bug.\n\tprocessor.connect(audioContext.destination);\n\n\tprocessor.checkClipping =\n\t\tfunction(){\n\t\t\tif (!this.clipping)\n\t\t\t\treturn false;\n\t\t\tif ((this.lastClip + this.clipLag) < window.performance.now())\n\t\t\t\tthis.clipping = false;\n\t\t\treturn this.clipping;\n\t\t};\n\n\tprocessor.shutdown =\n\t\tfunction(){\n\t\t\tthis.disconnect();\n\t\t\tthis.onaudioprocess = null;\n\t\t};\n\n\treturn processor;\n}\n\nfunction volumeAudioProcess( event ) {\n\tvar buf = event.inputBuffer.getChannelData(0);\n    var bufLength = buf.length;\n\tvar sum = 0;\n    var x;\n\n\t// Do a root-mean-square on the samples: sum up the squares...\n    for (var i=0; i<bufLength; i++) {\n    \tx = buf[i];\n    \tif (Math.abs(x)>=this.clipLevel) {\n    \t\tthis.clipping = true;\n    \t\tthis.lastClip = window.performance.now();\n    \t}\n    \tsum += x * x;\n    }\n\n    // ... then take the square root of the sum.\n    var rms =  Math.sqrt(sum / bufLength);\n\n    // Now smooth this out with the averaging factor applied\n    // to the previous sample - take the max here because we\n    // want \"fast attack, slow release.\"\n    this.volume = Math.max(rms, this.volume*this.averaging);\n}\n\n(function() {\n  'use strict';\n\n  var vertoApp = angular.module('vertoApp', [\n    'timer',\n    'ngRoute',\n    'vertoControllers',\n    'vertoDirectives',\n    'vertoFilters',\n    'ngStorage',\n    'ngAnimate',\n    'ngSanitize',\n    'toastr',\n    'FBAngular',\n    'cgPrompt',\n    '720kb.tooltips',\n    'ui.gravatar',\n    'ui.bootstrap',\n    'directive.g+signin',\n    'pascalprecht.translate',\n    'angular-click-outside',\n  ]);\n\n  vertoApp.constant('configLanguages', {\n    'languages' : [\n         {id: 'en', name: 'English'},\n         {id: 'it', name: 'Italiano'},\n         {id: 'fr', name: 'Franais'},\n         {id: 'de', name: 'Deutsch'},\n         {id: 'pt', name: 'Portugus'},\n         {id: 'pl', name: 'Polski'},\n         {id: 'zh', name: ''},\n         {id: 'ru', name: 'P'},\n         {id: 'sv', name: 'Svenska'},\n         {id: 'da', name: 'Dansk'},\n         {id: 'es', name: 'Espaol'},\n         {id: 'id', name: 'Indonesia'}\n    ],\n\n    'dialects' : {\n        'en': 'en',\n        'en_GB': 'en',\n        'en_US': 'en',\n        'it': 'it',\n        'it_IT': 'it',\n        'fr': 'fr',\n        'fr_FR': 'fr',\n        'fr_CA': 'fr',\n        'pt': 'pt',\n        'pt_BR': 'pt',\n        'pt_PT': 'pt',\n        'de': 'de',\n        'de_DE': 'de',\n        'es': 'es',\n        'es_ES': 'es',\n        'pl': 'pl',\n        'pl_PL': 'pl',\n        'ru': 'ru',\n        'ru_RU': 'ru',\n        'sv': 'sv',\n        'sv_SV': 'sv',\n        'sv_FI': 'sv',\n        'da': 'da',\n        'da_DK': 'da',\n        'id': 'id',\n        'id_ID': 'id',\n        'zh': 'zh',\n        'zh_CN': 'zh',\n        'zh_TW': 'zh',\n        'zh_HK': 'zh'\n    }\n  });\n\n  vertoApp.config(['$routeProvider', 'gravatarServiceProvider', '$translateProvider', 'configLanguages',\n    function($routeProvider, gravatarServiceProvider, $translateProvider, configLanguages) {\n      $routeProvider.\n      when('/', {\n        title: 'Loading',\n        templateUrl: 'partials/splash_screen.html',\n        controller: 'SplashScreenController'\n      }).\n      when('/login', {\n        title: 'Login',\n        templateUrl: 'partials/login.html',\n        controller: 'LoginController'\n      }).\n      when('/dialpad', {\n        title: 'Dialpad',\n        templateUrl: 'partials/dialpad.html',\n        controller: 'DialPadController'\n      }).\n      when('/incall', {\n          title: 'In a Call',\n          templateUrl: 'partials/incall.html',\n          controller: 'InCallController'\n        }).\n      when('/loading', {\n        title: 'Loading Verto Communicator',\n        templateUrl: 'partials/loading.html',\n        controller: 'LoadingController'\n      }).\n      when('/preview', {\n        title: 'Preview Video',\n        templateUrl: 'partials/preview.html',\n        controller: 'PreviewController'\n      }).\n      when('/browser-upgrade', {\n        title: '',\n        templateUrl: 'partials/browser_upgrade.html',\n        controller: 'BrowserUpgradeController'\n      }).\n      otherwise({\n        redirectTo: '/'\n      });\n\n      gravatarServiceProvider.defaults = {\n        default: 'mm'  // Mystery man as default for missing avatars\n      };\n\n      var reg_langs = [];\n      angular.forEach(configLanguages.languages, function(value, key) {\n        reg_langs.push(value.id);\n      });\n\n      $translateProvider\n      .useStaticFilesLoader({\n        prefix: 'locales/locale-',\n        suffix: '.json'\n      })\n      .registerAvailableLanguageKeys(reg_langs, configLanguages.dialects)\n      .preferredLanguage('en')\n      .determinePreferredLanguage()\n      .fallbackLanguage('en')\n      .useSanitizeValueStrategy(null);\n    }\n  ]);\n\n  vertoApp.run(['$rootScope', '$location', 'toastr', 'prompt', 'verto',\n    function($rootScope, $location, toastr, prompt, verto) {\n\n      $rootScope.$on( \"$routeChangeStart\", function(event, next, current) {\n        if (!verto.data.connected) {\n          if ( next.templateUrl === \"partials/login.html\") {\n            // pass\n          } else {\n            $location.path(\"/\");\n          }\n        }\n      });\n\n      $rootScope.$on('$routeChangeSuccess', function(event, current, previous) {\n        $rootScope.title = current.$$route.title;\n      });\n\n      $rootScope.safeProtocol = false;\n\n      if (window.location.protocol == 'https:') {\n        $rootScope.safeProtocol = true;\n      }\n\n\n      $rootScope.promptInput = function(title, message, label, callback) {\n        var ret = prompt({\n          title: title,\n          message: message,\n          input: true,\n          label: label\n        }).then(function(ret) {\n          if (angular.isFunction(callback)) {\n            callback(ret);\n          }\n        }, function() {\n\n        });\n\n      };\n\n    }\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  var vertoControllers = angular.module('vertoControllers', [\n    'ui.bootstrap',\n    'vertoService',\n    'storageService',\n    'ui.gravatar'\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('vertoControllers')\n  .controller('SplashScreenController', ['$scope', '$rootScope', '$location', '$timeout', 'storage', 'splashscreen', 'prompt', 'verto',\n    function($scope, $rootScope, $location, $timeout, storage, splashscreen, prompt, verto) {\n      console.debug('Executing SplashScreenController.');\n\n      $scope.progress_percentage = splashscreen.progress_percentage;\n      $scope.message = '';\n      $scope.interrupt_next = false;\n      $scope.errors = [];\n\n      var redirectTo = function(link, activity) {\n        if(activity) {\n          if(activity == 'browser-upgrade') {\n            link = activity;\n          }\n        }\n\n        $location.path(link);\n      }\n\n      var checkProgressState = function(current_progress, status, promise, activity, soft, interrupt, message) {\n        $scope.progress_percentage = splashscreen.calculate(current_progress);\n        $scope.message = message;\n\n        if(interrupt && status == 'error') {\n          $scope.errors.push(message);\n          if(!soft) {\n            redirectTo('', activity);\n            return;\n          } else {\n            message = message + '. Continue?';\n          };\n\n          if(!confirm(message)) {\n            $scope.interrupt_next = true;\n          };\n        };\n\n        if($scope.interrupt_next) {\n          return;\n        };\n\n        $scope.message = splashscreen.getProgressMessage(current_progress+1);\n\n        return true;\n      };\n\n      $rootScope.$on('progress.next', function(ev, current_progress, status, promise, activity, soft, interrupt, message) {\n        $timeout(function() {\n          if(promise) {\n            promise.then(function(response) {\n              message = response['message'];\n              status = response['status'];\n              if(checkProgressState(current_progress, status, promise, activity, soft, interrupt, message)) {\n                splashscreen.next();\n              };\n            });\n\n            return;\n          }\n\n          if(!checkProgressState(current_progress, status, promise, activity, soft, interrupt, message)) {\n            return;\n          }\n\n          splashscreen.next();\n        }, 400);\n      });\n\n      $rootScope.$on('progress.complete', function(ev, current_progress) {\n        $scope.message = 'Complete';\n        if(verto.data.connected) {\n          if (0 && storage.data.preview) {\n            $location.path('/preview');\n          }\n          else {\n            $location.path('/dialpad');\n          }\n        } else {\n          redirectTo('/login');\n          $location.path('/login');\n        }\n      });\n\n      splashscreen.next();\n\n    }]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('BrowserUpgradeController', ['$scope', '$http',\n      '$location', 'verto', 'storage', 'Fullscreen',\n      function($scope, $http, $location, verto, storage, Fullscreen) {\n        console.debug('Executing BrowserUpgradeController.');\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('vertoControllers')\n  .controller('ChatController', ['$scope', '$rootScope', '$http',\n    '$location', '$anchorScroll', '$timeout', 'verto', 'prompt', '$translate',\n    function($scope, $rootScope, $http, $location, $anchorScroll, $timeout,\n      verto, prompt, $translate) {\n      console.debug('Executing ChatController.');\n\n      function scrollToChatBottom() {\n        // Going to the bottom of chat messages.\n        var obj = document.querySelector('.chat-messages');\n        obj.scrollTop = obj.scrollHeight;\n        //var chat_messages_top = jQuery('.chat-messages').scrollTop();\n        //var marker_position = jQuery('#chat-message-bottom').position().top;\n        //jQuery('.chat-messages').scrollTop(chat_messages_top + marker_position);\n      }\n\n      var CLEAN_MESSAGE = '';\n\n      function clearConferenceChat() {\n        $scope.members = [];\n        $scope.messages = [];\n        $scope.message = CLEAN_MESSAGE;\n      }\n      clearConferenceChat();\n\n      $scope.$watch('activePane', function() {\n        if ($scope.activePane == 'chat') {\n          $rootScope.chat_counter = 0;\n        }\n        $rootScope.activePane = $scope.activePane;\n      });\n\n      $rootScope.$on('chat.newMessage', function(event, data) {\n        data.created_at = new Date();\n        console.log('chat.newMessage', data);\n        $scope.$apply(function() {\n          $scope.messages.push(data);\n          if (data.from != verto.data.name &&\n              (!$scope.chatStatus && $scope.activePane != 'chat')) {\n            ++$rootScope.chat_counter;\n          }\n          $timeout(function() {\n            scrollToChatBottom();\n          }, 300);\n        });\n      });\n\n      $rootScope.$on('call.conference', function(event, data) {\n        $timeout(function() {\n          $scope.conf = verto.data.conf.params.laData;\n        });\n      });\n\n      $rootScope.$on('changedVideoLayout', function(event, layout) {\n        $scope.resIDs = getResByLayout(layout);\n\n        // remove resIDs param to clear every members resID.\n        // passing $scope.resIDs results in preserving resIDs compatible\n        // with the current layout\n        clearMembersResID($scope.resIDs);\n      });\n\n      $rootScope.$on('conference.canvasInfo', function(event, data) {\n        $scope.currentLayout = data[0].layoutName;\n        $scope.resIDs = getResByLayout($scope.currentLayout);\n      });\n\n      function getResByLayout(layout) {\n        var layoutsData = verto.data.confLayoutsData;\n        for (var i = 0; i < layoutsData.length; i++) {\n          if (layoutsData[i].name === layout) {\n            return layoutsData[i].resIDS;\n          }\n        }\n      }\n\n      // @preserve - a array of values to be preserved\n      function clearMembersResID(preserve) {\n        $scope.members.forEach(function(member) {\n          var resID = member.status.video.reservationID;\n          console.debug(\"resID to clear: \" + resID);\n          if (resID && preserve && preserve.indexOf(resID) !== -1) return;\n          if (resID){\n            console.debug(\"clearing resid [\" + resID + \"] from [\" + member.id + \"]\");\n            $scope.confResID(member.id, resID);\n          }\n        });\n      };\n\n      function findMemberByUUID(uuid) {\n        var found = false;\n        for (var idx in $scope.members) {\n          var member = $scope.members[idx];\n          if (member.uuid == uuid) {\n            found = true;\n            break;\n          }\n        }\n        if (found) {\n          return idx;\n        } else {\n          return -1;\n        }\n      }\n\n      function translateMember(member) {\n        return {\n          'uuid': member[0],\n          'id': member[1][0],\n          'number': member[1][1],\n          'name': member[1][2],\n          'codec': member[1][3],\n          'status': JSON.parse(member[1][4]),\n          'email': member[1][5].email\n        };\n      }\n\n      function addMember(member) {\n        $scope.members.push(translateMember(member));\n      }\n\n      $rootScope.$on('hangupCall', function() {\n        $scope.openId = null;\n      });\n\n      $rootScope.$on('members.boot', function(event, members) {\n        $scope.$apply(function() {\n          clearConferenceChat();\n          for (var idx in members) {\n            var member = members[idx];\n            addMember(member);\n          }\n        })\n      });\n\n      $rootScope.$on('members.add', function(event, member) {\n        $scope.$apply(function() {\n          addMember(member);\n        });\n      });\n\n      $rootScope.$on('members.del', function(event, uuid) {\n        if ($rootScope.watcher && $rootScope.master === uuid) {\n          verto.hangup();\n          window.close();\n        }\n\n        $scope.$apply(function() {\n          var memberIdx = findMemberByUUID(uuid);\n          if (memberIdx != -1) {\n            // Removing the member.\n            $scope.members.splice(memberIdx, 1);\n          }\n        });\n      });\n\n      $rootScope.$on('members.update', function(event, member) {\n        member = translateMember(member);\n        var memberIdx = findMemberByUUID(member.uuid);\n        if (memberIdx < 0) {\n          console.log('Didn\\'t find the member uuid ' + member.uuid);\n        } else {\n          $scope.$apply(function() {\n            // console.log('Updating', memberIdx, ' <', $scope.members[memberIdx],\n              // '> with <', member, '>');\n            // Checking if it's me\n            if (parseInt(member.id) == parseInt(verto.data.conferenceMemberID)) {\n              verto.data.mutedMic = member.status.audio.muted;\n              verto.data.mutedVideo = member.status.video.muted;\n\t\t\t  verto.data.call.setMute(member.status.audio.muted ? \"off\" : \"on\");\n\t\t\t  verto.data.call.setVideoMute(member.status.video.muted ? \"off\" : \"on\");\n            }\n            angular.extend($scope.members[memberIdx], member);\n          });\n        }\n      });\n\n      $rootScope.$on('members.clear', function(event) {\n        $scope.$applyAsync(function() {\n          clearConferenceChat();\n          $scope.closeChat();\n        });\n      });\n\n      /**\n       * Public methods.\n       */\n\n      $scope.toggleModMenu = function(index) {\n        if (verto.data.confRole != 'moderator') return;\n        $scope.openId = $scope.openId == index ? null : index;\n      };\n\n      $scope.send = function(event) {\n        // Only conferencing chat is supported for now\n        // but still calling method with the conference prefix\n        // so we know that explicitly.\n        if (event && event.type == 'keydown') {\n          event.preventDefault();\n        }\n        verto.sendConferenceChat($scope.message);\n        $scope.message = CLEAN_MESSAGE;\n      };\n\n      // Participants moderation.\n      $scope.confKick = function(memberID) {\n        console.log('$scope.confKick');\n        verto.data.conf.kick(memberID);\n      };\n\n      $scope.confMuteMic = function(memberID) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confMuteMic');\n          verto.data.conf.muteMic(memberID);\n        }\n      };\n\n      $scope.confMuteVideo = function(memberID) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confMuteVideo');\n          verto.data.conf.muteVideo(memberID);\n        }\n      };\n\n      $scope.confPresenter = function(memberID) {\n        console.log('$scope.confPresenter');\n        verto.data.conf.presenter(memberID);\n      };\n\n      $scope.confResID = function(memberID, resID) {\n        console.log('Set', memberID, 'to', resID);\n        verto.setResevartionId(memberID, resID);\n      };\n\n      $scope.confVideoFloor = function(memberID) {\n        console.log('$scope.confVideoFloor');\n        verto.data.conf.videoFloor(memberID);\n      };\n\n      $scope.confBanner = function(memberID) {\n        console.log('$scope.confBanner');\n\n        prompt({\n          title: $translate.instant('TITLE_INSERT_BANNER'),\n          input: true,\n          label: '',\n          value: '',\n        }).then(function(text) {\n          if (text) {\n            verto.data.conf.banner(memberID, text);\n          }\n        });\n      };\n\n      $scope.confCanvasIn = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setCanvasIn(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_CANVAS_ID'), function(canvasID) {\n          console.log(memberID, canvasID);\n          verto.setCanvasIn(memberID, canvasID);\n        });\n\n      };\n\n      $scope.confCanvasOut = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setCanvasOut(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_CANVAS_ID'), function(canvasID) {\n          verto.setCanvasOut(memberID, canvasID);\n        });\n      };\n\n      $scope.confLayer = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setLayer(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_LAYER'), function(canvasID) {\n          verto.setLayer(memberID, canvasID);\n        });\n      };\n\n      $scope.confResetBanner = function(memberID) {\n        console.log('$scope.confResetBanner');\n        var text = 'reset';\n        verto.data.conf.banner(memberID, text);\n      };\n\n      $scope.confVolumeDown = function(memberID) {\n        console.log('$scope.confVolumeDown');\n        verto.data.conf.volumeDown(memberID);\n      };\n\n      $scope.confVolumeUp = function(memberID) {\n        console.log('$scope.confVolumeUp');\n        verto.data.conf.volumeUp(memberID);\n      };\n\n      $scope.confGainDown = function(memberID) {\n        console.log('$scope.confGainDown');\n        verto.data.conf.gainDown(memberID);\n      };\n\n      $scope.confGainUp = function(memberID) {\n        console.log('$scope.confGainUp');\n        verto.data.conf.gainUp(memberID);\n      };\n\n      $scope.confTransfer = function(memberID) {\n        console.log('$scope.confTransfer');\n        $rootScope.disableOnKeydownDtmf();\n        prompt({\n          title: $translate.instant('TITLE_TRANSFER'),\n          message: $translate.instant('MESSAGE_TRANSFER'),\n          input: true,\n          label: $translate.instant('LABEL_TRANSFER'),\n          value: '',\n        }).then(function(exten) {\n          $rootScope.enableOnKeydownDtmf();\n          if (exten) {\n            verto.data.conf.transfer(memberID, exten);\n          }\n        }).catch(function(){\n          $rootScope.enableOnKeydownDtmf();\n        });\n\n      };\n\n      $scope.confToggleDeaf = function(member) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confToggleDeaf');\n\n          if (member.status.audio.deaf) {\n            verto.data.conf.undeaf(member.id);\n          } else {\n            verto.data.conf.deaf(member.id);\n          }\n        }\n      };\n\n      function shortPrompt(text, cb) {\n        prompt({\n          title: text,\n          input: true,\n          label: '',\n          value: '',\n        }).then(function(val) {\n          if (val && cb) {\n            cb(val);\n          }\n        });\n      }\n    }\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ContributorsController', ['$scope', '$http',\n      'toastr',\n      function($scope, $http, toastr) {\n        var url = window.location.origin + window.location.pathname;\n        $http.get(url + 'contributors.txt')\n          .success(function(data) {\n\n            var contributors = [];\n\n            angular.forEach(data, function(value, key) {\n              var re = /(.*) <(.*)>/;\n              var name = value.replace(re, \"$1\");\n              var email = value.replace(re, \"$2\");\n\n              this.push({\n                'name': name,\n                'email': email\n              });\n            }, contributors);\n\n            $scope.contributors = contributors;\n          })\n          .error(function() {\n            toastr.error('contributors not found.');\n          });\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('AboutController', ['$scope', '$http',\n      'toastr',\n      function($scope, $http, toastr) {\n\t    var githash = '6047ebddfc' || 'something is not right';\n            $scope.githash = githash;\n\n\t/* leave this here for later, but its not needed right now\n        $http.get(window.location.pathname + '/contributors.txt')\n          .success(function(data) {\n\n          })\n          .error(function() {\n            toastr.error('contributors not found.');\n          });\n\t */\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('DialPadController', ['$rootScope', '$scope',\n      '$http', '$location', 'toastr', 'verto', 'storage', 'CallHistory', 'eventQueue', '$timeout',\n      function($rootScope, $scope, $http, $location, toastr, verto, storage, CallHistory, eventQueue, $timeout) {\n        console.debug('Executing DialPadController.');\n\n        eventQueue.process();\n\n        if ($location.search().autocall) {\n            $rootScope.dialpadNumber = $location.search().autocall;\n            delete $location.search().autocall;\n            call($rootScope.dialpadNumber);\n            if($rootScope.watcher) {\n              return;\n            }\n        }\n\n        $scope.call_history = CallHistory.all();\n        $scope.history_control = CallHistory.all_control();\n        $scope.has_history = Object.keys($scope.call_history).length;\n        storage.data.videoCall = false;\n        storage.data.userStatus = 'connecting';\n        storage.data.calling = false;\n\n        $scope.clearCallHistory = function() {\n          CallHistory.clear();\n          $scope.call_history = CallHistory.all();\n          $scope.history_control = CallHistory.all_control();\n          $scope.has_history = Object.keys($scope.call_history).length;\n          return $scope.history_control;\n        };\n\n        $scope.viewCallsList = function(calls) {\n          return $scope.call_list = calls;\n        };\n\n        /**\n         * fill dialpad via querystring [?autocall=\\d+]\n         */\n\n\t/**\n\t * fill in dialpad via config.json\n\t */\n        if ('autocall' in verto.data) {\n          $rootScope.dialpadNumber = verto.data.autocall;\n\t  delete verto.data.autocall;\n          call($rootScope.dialpadNumber);\n        }\n\n        /**\n         * used to bind click on number in call history to fill dialpad\n         * 'cause inside a ng-repeat the angular isnt in ctrl scope\n         */\n        $scope.fillDialpadNumber = function(number) {\n          $rootScope.dialpadNumber = number;\n        };\n\n        $scope.preview = function() {\n          $location.path('/preview');\n        };\n\n        $rootScope.transfer = function() {\n          if (!$rootScope.dialpadNumber) {\n            return false;\n          }\n          verto.data.call.transfer($rootScope.dialpadNumber);\n        };\n\n        function call(extension) {\n          storage.data.onHold = false;\n          storage.data.cur_call = 0;\n          $rootScope.dialpadNumber = extension;\n          if (!$rootScope.dialpadNumber && storage.data.called_number) {\n            $rootScope.dialpadNumber = storage.data.called_number;\n            return false;\n          } else if (!$rootScope.dialpadNumber && !storage.data.called_number) {\n            toastr.warning('Enter an extension, please.');\n            return false;\n          }\n\n          if (verto.data.call) {\n            console.debug('A call is already in progress.');\n            return false;\n          }\n\n          if (extension.indexOf('-canvas-') != -1) {\n            $rootScope.watcher = true;\n            verto.call($rootScope.dialpadNumber, null,\n              {\n                useCamera: \"none\",\n                useMic: \"none\",\n                useSpeak: \"none\",\n                caller_id_name: null,\n                userVariables: {},\n                caller_id_number: null,\n                mirrorInput: false\n              }\n            );\n            $location.path('/incall');\n            return;\n          }\n\n          storage.data.mutedVideo = false;\n          storage.data.mutedMic = false;\n\n          storage.data.videoCall = false;\n          verto.call($rootScope.dialpadNumber);\n\n          storage.data.called_number = $rootScope.dialpadNumber;\n          CallHistory.add($rootScope.dialpadNumber, 'outbound');\n          $location.path('/incall');\n        }\n\n        /**\n         * Call to the number in the $rootScope.dialpadNumber.\n         */\n        $scope.loading = false;\n        $scope.cancelled = false;\n        $rootScope.call = function(extension) {\n          if (!storage.data.testSpeedJoin || !$rootScope.dialpadNumber) {\n            return call(extension);\n          }\n          $scope.loading = true;\n\n          verto.testSpeed(function() {\n            if ($scope.cancelled) {\n              $scope.cancelled = false;\n              $scope.loading = false;\n              return;\n            } else {\n              call(extension);\n            }\n          });\n        }\n\n        $rootScope.cancel = function() {\n          $scope.cancelled = true;\n        }\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('InCallController', ['$rootScope', '$scope',\n      '$http', '$location', '$modal', '$timeout', 'toastr', 'verto', 'storage', 'prompt', 'Fullscreen', '$translate',\n      function($rootScope, $scope, $http, $location, $modal, $timeout, toastr,\n        verto, storage, prompt, Fullscreen, $translate) {\n\n        console.debug('Executing InCallController.');\n        $scope.layout = null;\n        $rootScope.dialpadNumber = '';\n        $scope.callTemplate = 'partials/phone_call.html';\n        $scope.dialpadTemplate = '';\n        $scope.incall = true;\n\n        if (storage.data.videoCall) {\n          $scope.callTemplate = 'partials/video_call.html';\n        }\n\n        $rootScope.$on('call.conference', function(event, data) {\n          $timeout(function() {\n            if($scope.chatStatus) {\n              $scope.openChat();\n            }\n            buildCanvasesData();\n          });\n        });\n\n        $rootScope.$on('call.video', function(event, data) {\n          $timeout(function() {\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        });\n\n        /**\n         * toggle dialpad in incall page\n         */\n        $scope.toggleDialpad = function() {\n          $scope.openModal('partials/dialpad_widget.html',\n            'ModalDialpadController');\n\n          /*\n          if(!$scope.dialpadTemplate) {\n            $scope.dialpadTemplate = 'partials/dialpad_widget.html';\n          } else {\n            $scope.dialpadTemplate = '';\n          }\n          */\n        }\n\n        /**\n         * TODO: useless?\n         */\n        $scope.videoCall = function() {\n          prompt({\n            title: $translate.instant('TITLE_ENABLE_VIDEO'),\n            message: $translate.instant('MESSAGE_ENABLE_VIDEO')\n          }).then(function() {\n            storage.data.videoCall = true;\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        };\n\n        $scope.cbMuteVideo = function(event, data) {\n          storage.data.mutedVideo = !storage.data.mutedVideo;\n        }\n\n        $scope.cbMuteMic = function(event, data) {\n          storage.data.mutedMic = !storage.data.mutedMic;\n        }\n\n        $scope.confChangeVideoLayout = function(layout, canvasID) {\n          verto.data.conf.setVideoLayout(layout, canvasID);\n          $scope.videoLayout = layout;\n          $rootScope.$emit('changedVideoLayout', layout);\n        };\n\n        $scope.confChangeSpeaker = function(speakerId) {\n          storage.data.selectedSpeaker = speakerId;\n          $rootScope.$emit('changedSpeaker', speakerId);\n        };\n\n        $scope.confPopup = function(canvas_id) {\n          var video = document.getElementById('webcam');\n          var s = window.location.href;\n          var curCall = verto.data.call.callID;\n          var extension = verto.data.call.params.remote_caller_id_number;\n          var width = webcam.offsetWidth;\n          var height = webcam.offsetHeight + 100;\n          var x = (screen.width - width)/2\n          var y = (screen.height - height)/2\n\n          s = s.replace(/\\#.*/, '');\n          s += \"#/?sessid=random&master=\" + curCall + \"&watcher=true&extension=\" + extension+ \"&canvas_id=\" + canvas_id;\n\n          console.log(\"opening new window to \" + s);\n          var popup = window.open(s, \"canvas_window_\" + canvas_id, \"toolbar=0,location=0,menubar=0,directories=0,width=\" + width + \",height=\" + height, + ',left=' + x + ',top=' + y);\n          popup.moveTo(x, y);\n        };\n\n        $scope.screenshare = function() {\n          if(verto.data.shareCall) {\n            verto.screenshareHangup();\n            return false;\n          }\n          if (verto.data.conf) {\n            console.log('Screenshare inside conferece: ', verto.data.conf);\n            // Setting the destination of the screenshare call as the conference\n            // number we last joined\n            verto.screenshare(verto.data.conf.params.laData.laName);\n          }\n          else {\n            verto.screenshare(storage.data.called_number);\n          }\n        };\n\n        function buildCanvasesData() {\n          $scope.conf = verto.data.conf.params.laData;\n          $scope.canvases = [{ id: 1, name: 'Super Canvas' }];\n          for (var i = 1; i < $scope.conf.canvasCount; i++) {\n            $scope.canvases.push({ id: i+1, name: 'Canvas ' + (i+1) });\n          }\n        }\n\n        $scope.muteMic = verto.muteMic;\n        $scope.muteVideo = verto.muteVideo;\n\n        $rootScope.$on('ScreenShareExtensionStatus', function(event, error) {\n          var pluginUrl = 'https://chrome.google.com/webstore/detail/screen-capturing/ajhifddimkapgcifgcodmmfdlknahffk';\n          switch(error) {\n            case 'permission-denied':\n              toastr.info('Please allow the plugin in order to use Screen Share', 'Error'); break;\n            case 'not-installed':\n              toastr.warning('Please <a target=\"_blank\" class=\"install\" href=\"'+ pluginUrl +'\">install</a> the plugin in order to use Screen Share', 'Warning', { allowHtml: true }); break;\n            case 'installed-disabled':\n              toastr.info('Please enable the plugin in order to use Screen Share', 'Error'); break;\n            // case 'not-chrome'\n            //   toastr.info('Chrome', 'Error');\n          }\n        });\n\n        $timeout(function() {\n          console.log('broadcast time-start incall');\n          $scope.$broadcast('timer-start');\n        }, 1000);\n\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('LoginController', ['$scope', '$http', '$location', 'verto', \n      function($scope, $http, $location, verto) {\n        var preRoute = function() {\n          if(verto.data.connected) {\n            $location.path('/dialpad');\n          }\n        }\n        preRoute();\n\n        var name = $location.search().name;\n        var email = $location.search().email;\n        var skipPreview = $location.search().skipPreview;\n\n        if (name && email) {\n          verto.data.name = name;\n          verto.data.email = email;\n          $scope.login(true, skipPreview);\n          return;\n        }\n\n        verto.data.name = $scope.storage.data.name;\n        verto.data.email = $scope.storage.data.email;\n\n        console.debug('Executing LoginController.');\n      }\n    ]);\n\n})();\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('MainController',\n      [\"$scope\", \"$rootScope\", \"$location\", \"$modal\", \"$timeout\", \"$q\", \"verto\", \"storage\", \"CallHistory\", \"toastr\", \"Fullscreen\", \"prompt\", \"eventQueue\", \"$translate\", \"$window\", function($scope, $rootScope, $location, $modal, $timeout, $q, verto, storage, CallHistory, toastr, Fullscreen, prompt, eventQueue, $translate, $window) {\n\n      console.debug('Executing MainController.');\n      $rootScope.dtmfHistory = { value: '' };\n      $rootScope.onKeydownDtmfEnabled = true;\n\n      $.verto.haltClosure = function() {\n        if (verto.data.callState == 'active') {\n          return true;\n        }\n      };\n\n      if (storage.data.language && storage.data.language !== 'browser') {\n        $translate.use(storage.data.language);\n      } else {\n        storage.data.language = 'browser';\n      }\n\n      $rootScope.master = $location.search().master;\n      if ($location.search().watcher === 'true') {\n        $rootScope.watcher = true;\n        angular.element(document.body).addClass('watcher');\n        var dialpad;\n        var extension = dialpad = $location.search().extension;\n        var canvasID = $location.search().canvas_id;\n\n        if (dialpad) {\n          if (canvasID) {\n            dialpad += '-canvas-' + canvasID;\n          }\n          $rootScope.extension = extension;\n          $rootScope.canvasID = canvasID;\n          $location.search().autocall = dialpad;\n        }\n      }\n\n      var myVideo = document.getElementById(\"webcam\");\n      $scope.verto = verto;\n      $scope.storage = storage;\n      $scope.call_history = angular.element(\"#call_history\").hasClass('active');\n      $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n      $scope.showReconnectModal = true;\n      /**\n       * (explanation) scope in another controller extends rootScope (singleton)\n       */\n      $rootScope.chat_counter = 0;\n      $rootScope.activePane = 'members';\n      /**\n       * The number that will be called.\n       * @type {string}\n       */\n      $rootScope.dialpadNumber = '';\n\n      // If verto is not connected, redirects to login page.\n      if (!verto.data.connected) {\n        console.debug('MainController: WebSocket not connected. Redirecting to login.');\n        $location.path('/');\n      }\n\n      $rootScope.$on('config.http.success', function(ev) {\n        $scope.login(false);\n      });\n\n      $rootScope.$on('changedSpeaker', function(event, speakerId) {\n        if (verto.data.call) {\n          verto.data.call.setAudioPlaybackDevice(speakerId, sinkIdCallback);\n        }\n      });\n\n      /**\n       * Login the user to verto server and\n       * redirects him to dialpad page.\n       */\n      $rootScope.login = function(redirect, skipPreview) {\n        if(redirect == undefined) {\n          redirect = true;\n        }\n\n        if(skipPreview == undefined) {\n          skipPreview = false;\n        }\n\n        var connectCallback = function(v, connected) {\n          $scope.$apply(function() {\n          verto.data.connecting = false;\n          if (connected) {\n            storage.data.hostname = verto.data.hostname;\n            storage.data.wsURL = verto.data.wsURL;\n            storage.data.ui_connected = verto.data.connected;\n            storage.data.ws_connected = verto.data.connected;\n            storage.data.name = verto.data.name;\n            storage.data.email = verto.data.email;\n            storage.data.login = verto.data.login;\n            storage.data.password = verto.data.password;\n            if (storage.data.autoBand) {\n              verto.testSpeed();\n            }\n\n            if (redirect && storage.data.preview && !skipPreview) {\n              $location.path('/loading');\n            } else if (redirect) {\n              $location.path('/dialpad');\n            }\n          }\n          });\n        };\n\n        verto.data.connecting = true;\n        verto.connect(connectCallback);\n      };\n\n      /**\n       * Logout the user from verto server and\n       * redirects him to login page.\n       */\n      $rootScope.logout = function() {\n        var disconnect = function() {\n          var disconnectCallback = function(v, connected) {\n            console.debug('Redirecting to login page.');\n            storage.reset();\n\t\t\tif (typeof gapi !== 'undefined'){\n\t\t\t\tconsole.debug(gapi);\n\t\t\t\tgapi.auth.signOut();\n\t\t\t}\n            $location.path('/login');\n          };\n\n          if (verto.data.call) {\n            verto.hangup();\n          }\n\n          $scope.closeChat();\n          $scope.showReconnectModal = false;\n          verto.disconnect(disconnectCallback);\n\n          verto.hangup();\n        };\n\n        if (verto.data.call) {\n          prompt({\n            title: $translate.instant('TITLE_ACTIVE_CALL'),\n            message: $translate.instant('MESSAGE_ACTIVE_CALL_HANGUP')\n          }).then(function() {\n            disconnect();\n          });\n        } else {\n          disconnect();\n        }\n\n      };\n\n      /**\n       * Shows a modal with the settings.\n       */\n      $scope.openModalSettings = function() {\n        var modalInstance = $modal.open({\n          animation: $scope.animationsEnabled,\n          templateUrl: 'partials/modal_settings.html',\n          controller: 'ModalSettingsController',\n        });\n\n        modalInstance.result.then(\n          function(result) {\n            console.log(result);\n          },\n          function() {\n            console.info('Modal dismissed at: ' + new Date());\n          }\n        );\n\n        modalInstance.rendered.then(\n          function() {\n            jQuery.material.init();\n          }\n        );\n      };\n\n      $rootScope.openModal = function(templateUrl, controller, _options) {\n        var options = {\n          animation: $scope.animationsEnabled,\n          templateUrl: templateUrl,\n          controller: controller,\n        };\n\n        angular.extend(options, _options);\n\n        var modalInstance = $modal.open(options);\n\n        modalInstance.result.then(\n          function(result) {\n            console.log(result);\n          },\n          function() {\n            console.info('Modal dismissed at: ' + new Date());\n          }\n        );\n\n        modalInstance.rendered.then(\n          function() {\n            jQuery.material.init();\n          }\n        );\n\n        return modalInstance;\n      };\n\n      $rootScope.$on('ws.close', onWSClose);\n      $rootScope.$on('ws.login', onWSLogin);\n\n      $rootScope.ws_modalInstance;\n\n      function onWSClose(ev, data) {\n        if($rootScope.ws_modalInstance) {\n          return;\n        };\n        var options = {\n          backdrop: 'static',\n          keyboard: false\n        };\n          if ($scope.showReconnectModal) {\n            $rootScope.ws_modalInstance = $scope.openModal('partials/ws_reconnect.html', 'ModalWsReconnectController', options);\n          };\n      };\n\n      function onWSLogin(ev, data) {\n        if(storage.data.autoBand) {\n          verto.testSpeed();\n        }\n        if(!$rootScope.ws_modalInstance) {\n          return;\n        };\n\n        $rootScope.ws_modalInstance.close();\n        $rootScope.ws_modalInstance = null;\n      };\n\n      $scope.showAbout = function() {\n        $scope.openModal('partials/about.html', 'AboutController');\n      };\n\n      $scope.showContributors = function() {\n        $scope.openModal('partials/contributors.html', 'ContributorsController');\n      };\n\n      /**\n       * Updates the display adding the new number touched.\n       *\n       * @param {String} number - New touched number.\n       */\n      $rootScope.dtmf = function(number) {\n        console.log('dtmf', number);\n        $rootScope.dialpadNumber = $rootScope.dialpadNumber + number;\n        if (verto.data.call) {\n          verto.dtmf(number);\n        }\n      };\n\n      /**\n       * Removes the last character from the number.\n       */\n      $rootScope.backspace = function() {\n        var number = $rootScope.dialpadNumber;\n        var len = number.length;\n        $rootScope.dialpadNumber = number.substring(0, len - 1);\n      };\n\n\n      $scope.toggleCallHistory = function() {\n        if (!$scope.call_history) {\n          angular.element(\"#call_history\").addClass('active');\n          angular.element(\"#call-history-wrapper\").addClass('active');\n        } else {\n          angular.element(\"#call_history\").removeClass('active');\n          angular.element(\"#call-history-wrapper\").removeClass('active');\n        }\n        $scope.call_history = angular.element(\"#call_history\").hasClass('active');\n      };\n\n      $scope.toggleChat = function() {\n        if ($rootScope.chatStatus && $rootScope.activePane === 'chat') {\n          $rootScope.chat_counter = 0;\n        }\n        angular.element('#wrapper').toggleClass('toggled');\n        $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n        updateVideoSize();\n      };\n\n      $rootScope.openChat = function() {\n        $rootScope.chatStatus = false;\n        angular.element('#wrapper').removeClass('toggled');\n      };\n\n      $scope.closeChat = function() {\n        $rootScope.chatStatus = true;\n        angular.element('#wrapper').addClass('toggled');\n      };\n\n      $scope.toggleSettings = function() {\n        var settingsEl = angular.element(document.querySelector('#settings'));\n        settingsEl.toggleClass('toggled');\n        $rootScope.$emit('toggledSettings', settingsEl.hasClass('toggled'));\n      };\n\n      $scope.closeSettings = function() {\n        var settingsEl = angular.element(document.querySelector('#settings'));\n        if (settingsEl.hasClass('toggled')) {\n          settingsEl.removeClass('toggled');\n          $rootScope.$emit('toggledSettings', settingsEl.hasClass('toggled'));\n        }\n      };\n\n      $scope.goFullscreen = function() {\n        if (storage.data.userStatus !== 'connected') {\n          return;\n        }\n        $rootScope.fullscreenEnabled = !Fullscreen.isEnabled();\n        if (Fullscreen.isEnabled()) {\n          Fullscreen.cancel();\n        } else {\n          Fullscreen.enable(document.getElementsByTagName('body')[0]);\n        }\n      };\n\n      $rootScope.$on('call.video', function(event) {\n        storage.data.videoCall = true;\n      });\n\n      $rootScope.$on('call.hangup', function(event, data) {\n        if (Fullscreen.isEnabled()) {\n          Fullscreen.cancel();\n        }\n\n        if (!$rootScope.chatStatus) {\n          angular.element('#wrapper').toggleClass('toggled');\n          $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n        }\n\n        $rootScope.dialpadNumber = '';\n        console.debug('Redirecting to dialpad page.');\n        $location.path('/dialpad');\n\n        try {\n          $rootScope.$digest();\n        } catch (e) {\n          console.log('not digest');\n        }\n      });\n\n      $rootScope.$on('page.incall', function(event, data) {\n        var page_incall = function() {\n          return $q(function(resolve, reject) {\n            if (storage.data.askRecoverCall) {\n              prompt({\n                title: $translate.instant('TITLE_ACTIVE_CALL'),\n                message: $translate.instant('MESSAGE_ACTIVE_CALL_BACK')\n              }).then(function() {\n                console.log('redirect to incall page');\n                $location.path('/incall');\n              }, function() {\n                storage.data.userStatus = 'connecting';\n                verto.hangup();\n              });\n            } else {\n              console.log('redirect to incall page');\n              $location.path('/incall');\n            }\n            resolve();\n          });\n        };\n        eventQueue.events.push(page_incall);\n      });\n\n      $scope.$on('event:google-plus-signin-success', function (event,authResult) {\n        // Send login to server or save into cookie\n        console.log('Google+ Login Success');\n\tconsole.log(authResult);\n\tgapi.client.load('plus', 'v1', gapiClientLoaded);\n      });\n\n      function gapiClientLoaded() {\n\tgapi.client.plus.people.get({userId: 'me'}).execute(handleEmailResponse);\n      }\n\n      function handleEmailResponse(resp){\n        var primaryEmail;\n\tfor (var i=0; i < resp.emails.length; i++) {\n\t  if (resp.emails[i].type === 'account') primaryEmail = resp.emails[i].value;\n        }\n\tconsole.debug(\"Primary Email: \" + primaryEmail );\n\tconsole.debug(\"display name: \" + resp.displayName);\n\tconsole.debug(\"imageurl: \" + resp.image.url);\n\tconsole.debug(resp);\n\tconsole.debug(verto.data);\n\tverto.data.email = primaryEmail;\n\tverto.data.name = resp.displayName;\n\tstorage.data.name = verto.data.name;\n\tstorage.data.email = verto.data.email;\n\n\t$scope.login();\n      }\n\n      $scope.$on('event:google-plus-signin-failure', function (event,authResult) {\n        // Auth failure or signout detected\n        console.log('Google+ Login Failure');\n      });\n\n      $rootScope.callActive = function(data, params) {\n        verto.data.mutedMic = storage.data.mutedMic;\n        verto.data.mutedVideo = storage.data.mutedVideo;\n\n        if (!storage.data.cur_call) {\n          storage.data.call_start = new Date();\n        }\n        storage.data.userStatus = 'connected';\n        var call_start = new Date(storage.data.call_start);\n        $rootScope.start_time = call_start;\n\n        $timeout(function() {\n          $scope.$broadcast('timer-start');\n        });\n        myVideo.play();\n        storage.data.calling = false;\n\n        storage.data.cur_call = 1;\n\n        $location.path('/incall');\n\n        if(params.useVideo) {\n          $rootScope.$emit('call.video', 'video');\n        }\n      };\n\n      $rootScope.$on('call.active', function(event, data, params) {\n        $rootScope.callActive(data, params);\n      });\n\n      $rootScope.$on('call.calling', function(event, data) {\n        storage.data.calling = true;\n      });\n\n      $rootScope.$on('call.incoming', function(event, data) {\n        console.log('Incoming call from: ' + data);\n\n        storage.data.cur_call = 0;\n        $scope.incomingCall = true;\n        storage.data.videoCall = false;\n        storage.data.mutedVideo = false;\n        storage.data.mutedMic = false;\n\n        prompt({\n          title: $translate.instant('TITLE_INCOMING_CALL'),\n          message: $translate.instant('MESSAGE_INCOMING_CALL') + data\n        }).then(function() {\n          var call_start = new Date(storage.data.call_start);\n          $rootScope.start_time = call_start;\n          console.log($rootScope.start_time);\n\n          $scope.answerCall();\n          storage.data.called_number = data;\n          CallHistory.add(data, 'inbound', true);\n          $location.path('/incall');\n        }, function() {\n          $scope.declineCall();\n          CallHistory.add(data, 'inbound', false);\n        });\n      });\n\n      $scope.hold = function() {\n        storage.data.onHold = !storage.data.onHold;\n        verto.data.call.toggleHold();\n      };\n\n      /**\n       * Hangup the current call.\n       */\n      $scope.hangup = function() {\n        if (!verto.data.call) {\n          toastr.warning($translate.instant('MESSAGE_NO_HANGUP_CALL'));\n          $location.path('/dialpad');\n          return;\n        }\n\n        if ($rootScope.watcher) {\n          window.close();\n          return;\n        }\n\n        //var hangupCallback = function(v, hangup) {\n        //  if (hangup) {\n        //    $location.path('/dialpad');\n        //  } else {\n        //    console.debug('The call could not be hangup.');\n        //  }\n        //};\n        //\n        //verto.hangup(hangupCallback);\n        if (verto.data.shareCall) {\n          verto.screenshareHangup();\n        }\n\n        verto.hangup();\n\n        $rootScope.$emit('hangupCall');\n        $location.path('/dialpad');\n      };\n\n      $scope.answerCall = function() {\n        storage.data.onHold = false;\n\n        verto.data.call.answer({\n          useStereo: storage.data.useStereo,\n          useCamera: storage.data.selectedVideo,\n          useVideo: storage.data.useVideo,\n          useMic: storage.data.useMic,\n          callee_id_name: verto.data.name,\n          callee_id_number: verto.data.login\n        });\n\n\n        $location.path('/incall');\n      };\n\n      $scope.declineCall = function() {\n        $scope.hangup();\n        $scope.incomingCall = false;\n      };\n\n      $scope.play = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.play(file);\n            console.log('play file :', file);\n          });\n\n      };\n\n      $scope.stop = function() {\n        verto.data.conf.stop();\n      };\n\n      $scope.record = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.record(file);\n            console.log('recording file :', file);\n          });\n      };\n\n      $scope.stopRecord = function() {\n        verto.data.conf.stopRecord();\n      };\n\n      $scope.snapshot = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.snapshot(file);\n            console.log('snapshot file :', file);\n          });\n      };\n\n      function sinkIdCallback(success, deviceName) {\n        if (success) {\n          toastr.info('Speaker is now <span class=\"install\">' + deviceName + '</a>', 'Success', { allowHtml: true });\n        } else {\n          toastr.error('Your browser doesn\\'t seem to support this feature', 'Error');\n        }\n      }\n\n      $rootScope.dtmfWidget = function(number) {\n        $rootScope.dtmfHistory.value = $rootScope.dtmfHistory.value + number;\n        if (verto.data.call) {\n          verto.dtmf(number);\n        }\n      }\n\n      $rootScope.disableOnKeydownDtmf = function() {\n        $rootScope.onKeydownDtmfEnabled = false;\n      };\n\n      $rootScope.enableOnKeydownDtmf = function() {\n        $rootScope.onKeydownDtmfEnabled = true;\n      };\n\n      $rootScope.$on(\"$routeChangeStart\", function(event, next, current) {\n        if (next.$$route.originalPath === '/incall') {\n          $rootScope.dtmfHistory.value = '';\n          angular.element($window).bind('keydown', onKeydownDtmfHistory);\n        } else {\n          angular.element($window).unbind('keydown', onKeydownDtmfHistory);\n        }\n      });\n\n      function onKeydownDtmfHistory(event) {\n        var caracter = event.key;\n        if ($rootScope.onKeydownDtmfEnabled && caracter.match(/^(\\*|\\#|[0-9a-dA-D])$/g)) {\n          $rootScope.dtmfWidget(caracter);\n          $scope.$applyAsync();\n        }\n      }\n\n    }]\n  );\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n\t.controller('MenuController', ['$scope', '$http', '$location',\n\t  'verto', 'storage', '$rootScope',\n\t  function($scope, $http, $location, verto, storage, $rootScope) {\n\t    console.debug('Executing MenuController.');\n      $scope.storage = storage;\n\n      $rootScope.$on('testSpeed', function(e, data) {\n        var vidQual = storage.data.vidQual;\n\tvar bwp = 4;\n\n        $scope.bandDown = data.downKPS;\n        $scope.bandUp = data.upKPS;\n\n        if (data.downKPS < 2000) {\n          bwp--;\n        }\n\n        if (data.upKPS < 2000) {\n           bwp--;\n        }\n\n        $scope.iconClass = 'mdi-device-signal-wifi-4-bar green';                      \n\n        if (bwp < 4) {\n           $scope.iconClass = 'mdi-device-signal-wifi-3-bar yellow';\n        } else if (bwp < 2) {\n           $scope.iconClass = 'mdi-device-signal-wifi-1-bar red';\n        }\n\n        verto.videoQuality.forEach(function(vid) {\n          if (vid.id == vidQual){\n            $scope.vidRes = vid.label;\n          }\n        });\n\n        $scope.$apply();\n      });\n    }\n\t]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalDialpadController', ['$scope',\n      '$modalInstance',\n      function($scope, $modalInstance) {\n\n        $scope.ok = function() {\n          $modalInstance.close('Ok.');\n        };\n\n        $scope.cancel = function() {\n          $modalInstance.dismiss('cancel');\n        };\n\n      }\n    ]);\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalWsReconnectController', ModalWsReconnectController);\n\n    ModalWsReconnectController.$inject = ['$rootScope', '$scope', 'storage', 'verto'];\n\n    function ModalWsReconnectController($rootScope, $scope, storage, verto) {\n      console.debug('Executing ModalWsReconnectController'); \n\n      $scope.closeReconnect = closeReconnect;\n\n      function closeReconnect() {\n        if ($rootScope.ws_modalInstance && verto.data.instance) {\n          verto.data.instance.rpcClient.stopRetrying();\n          $rootScope.ws_modalInstance.close();\n          delete verto.data.instance;\n        }\n      };\n    };\n                \n                \n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalLoginInformationController', ['$scope',\n      '$http', '$location', '$modalInstance', 'verto', 'storage',\n      function($scope, $http, $location, $modalInstance, verto, storage) {\n        console.debug('Executing ModalLoginInformationController.');\n\n        $scope.verto = verto;\n        $scope.storage = storage;\n\n        $scope.ok = function() {\n          $modalInstance.close('Ok.');\n        };\n\n        $scope.cancel = function() {\n          $modalInstance.dismiss('cancel');\n        };\n\n        verto.data.name = storage.data.name;\n        verto.data.email = storage.data.email;\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('SettingsController', ['$scope', '$http',\n      '$location', '$rootScope', 'storage', 'verto', '$translate', 'toastr', 'configLanguages',\n      function($scope, $http, $location, $rootScope, storage, verto, $translate, toastr, configLanguages) {\n        console.debug('Executing ModalSettingsController.');\n\n        $.material.init();\n\n        $scope.speakerFeature = typeof document.getElementById('webcam').sinkId !== 'undefined';\n        $scope.storage = storage;\n        $scope.verto = verto;\n        $scope.mydata = angular.copy(storage.data);\n        $scope.languages = configLanguages.languages;\n        $scope.languages.unshift({id: 'browser', name : $translate.instant('BROWSER_LANGUAGE')});\n        $scope.mydata.language = storage.data.language || 'browser';\n\n        $rootScope.$on('$translateChangeSuccess', function () {\n          $translate('BROWSER_LANGUAGE').then(function (translation) {\n          $scope.languages[0].name = translation;\n          });\n        });\n\n        $rootScope.$on('toggledSettings', function(e, status) {\n          if (status) {\n            $scope.mydata = angular.copy(storage.data);\n          } else {\n            $scope.ok();\n          }\n        });\n\n        $scope.ok = function() {\n          console.log('Camera Selected is', $scope.mydata.selectedVideo, $scope.verto.data.videoDevices);\n\n          angular.forEach(verto.data.videoDevices, function(video) {\n            console.log('checking video ', video);\n            if (video.id == $scope.mydata.selectedVideo) {\n              $scope.mydata.selectedVideoName = video.label;\n              console.log('Setting selectedVideoName to ', video.label);\n            }\n          })\n          if ($scope.mydata.selectedSpeaker != storage.data.selectedSpeaker) {\n            $rootScope.$emit('changedSpeaker', $scope.mydata.selectedSpeaker);\n          }\n          storage.changeData($scope.mydata);\n          verto.data.instance.iceServers(storage.data.useSTUN);\n\n          if (storage.data.autoBand) {\n            $scope.testSpeed();\n          }\n\n          var audioParams = {\n            googEchoCancellation: storage.data.googEchoCancellation === undefined ? true : storage.data.googEchoCancellation,\n            googNoiseSuppression: storage.data.googNoiseSuppression === undefined ? true : storage.data.googNoiseSuppression,\n            googHighpassFilter: storage.data.googHighpassFilter === undefined ? true : storage.data.googHighpassFilter,\n            googAutoGainControl: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl,\n            googAutoGainControl2: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl\n          };\n          verto.data.instance.options.audioParams = audioParams;\n\n        };\n\n        $scope.changedLanguage = function(langKey){\n          if (langKey === 'browser'){\n           storage.data.language = 'browser';\n            var browserlang = $translate.preferredLanguage();\n            $translate.use(browserlang).then(\n              function(lang) {}, function(fail_lang) {\n                $translate.use('en');\n               });\n          } else {\n            $translate.use(langKey);\n            storage.data.language = langKey;\n          }\n        };\n\n        $scope.refreshDeviceList = function() {\n          return verto.refreshDevices();\n        };\n\n        $scope.showPreview = function() {\n          var settingsEl = angular.element(document.querySelector('#settings'));\n          settingsEl.toggleClass('toggled');\n          if (!verto.data.call) {\n            $location.path('/preview');\n            return;\n          }\n          else {\n            toastr.warning($translate.instant('MESSAGE_DISPLAY_SETTINGS'));\n          }\n        };\n\n        $scope.testSpeed = function() {\n          $scope.isTestingSpeed = true;\n          return verto.testSpeed(cb);\n\n          function cb(data) {\n            $scope.mydata.vidQual = storage.data.vidQual;\n            $scope.speedMsg = 'Up: ' + data.upKPS + ' Down: ' + data.downKPS;\n            $scope.isTestingSpeed = false;\n            $scope.$apply();\n          }\n        };\n\n        $scope.resetSettings = function() {\n\t  if (confirm('Factory Reset Settings?')) {\n            storage.factoryReset();\n            $scope.logout();\n\t    window.location.reload();\n\t  };\n        };\n\n        $scope.checkAutoBand = function(option) {\n          $scope.mydata.useDedenc = false;\n          var bestres = videoQuality[videoQuality.length-1];\n          $scope.mydata.vidQual = bestres.id;\n          storage.data.vidQual = bestres.id;\n          verto.data.instance.videoParams({\n            minWidth: bestres.width,\n            minHeight: bestres.height,\n            maxWidth: bestres.width,\n            maxHeight: bestres.height,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n          storage.data.vidQual = bestres.id;\n          if (!option) {\n            $scope.mydata.outgoingBandwidth = 'default';\n            $scope.mydata.incomingBandwidth = 'default';\n            $scope.mydata.testSpeedJoin = false;\n\n          } else {\n            $scope.mydata.testSpeedJoin = true;\n          }\n        };\n\n        $scope.checkUseDedRemoteEncoder = function(option) {\n          if (['0', 'default', '5120'].indexOf(option) != -1) {\n            $scope.mydata.useDedenc = false;\n          } else {\n            $scope.mydata.useDedenc = true;\n          }\n        };\n\n        $scope.checkVideoQuality = function(resolution) {\n          var w = videoResolution[resolution]['width'];\n          var h = videoResolution[resolution]['height'];\n          storage.data.vidQual = resolution;\n          verto.data.instance.videoParams({\n            minWidth: w,\n            minHeight: h,\n            maxWidth: w,\n            maxHeight: h,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n\n        };\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('PreviewController', ['$rootScope', '$scope',\n      '$http', '$location', '$modal', '$timeout', 'toastr', 'verto', 'storage', 'prompt', 'Fullscreen', '$translate',\n      function($rootScope, $scope, $http, $location, $modal, $timeout, toastr,\n        verto, storage, prompt, Fullscreen, $translate) {\n\n        $scope.storage = storage;\n        console.debug('Executing PreviewController.');\n        var localVideo = document.getElementById('videopreview');\n        var volumes = document.querySelector('#mic-meter .volumes');\n        if (volumes) {\n          volumes = volumes.children;\n        }\n\n        $scope.localVideo = function() {\n          var constraints = {\n            mirrored: true,\n            audio: {\n              optional: [{ sourceId: storage.data.selectedAudio }]\n            }\n          };\n\n          var newDevice = verto.data.videoDevices.find(function(device) {\n            return device.id == storage.data.selectedVideo;\n          });\n\n          storage.data.selectedVideo = newDevice.id;\n          storage.data.selectedVideoName = newDevice.label;\n\n          if (newDevice.id !== 'none') {\n            constraints.video = {\n              optional: [{ sourceId: newDevice.id }]\n            };\n          }\n\n          navigator.getUserMedia(constraints, handleMedia, function(err, data) {\n\n          });\n        };\n        var audioContext = null;\n        if (typeof AudioContext !== \"undefined\") {\n          audioContext = new AudioContext();\n        }\n\n        var mediaStreamSource = null;\n        var meter = null;\n        var streamObj = {};\n\n        function stopMedia(stream) {\n          if (typeof stream == 'function') {\n            stream.stop();\n          } else {\n            if (stream.active) {\n              var tracks = stream.getTracks();\n              tracks.forEach(function(track, index) {\n                track.stop();\n              })\n            }\n          }\n        }\n        function handleMedia(stream) {\n          if (streamObj) {\n            stopMedia(streamObj);\n          }\n\n          streamObj = stream;\n          FSRTCattachMediaStream(localVideo, stream);\n          if (audioContext) {\n            mediaStreamSource = audioContext.createMediaStreamSource(stream);\n            meter = createAudioMeter(audioContext);\n            mediaStreamSource.connect(meter);\n          };\n        }\n\n        function renderMic() {\n          // meter.volume;\n          var n = Math.round(meter.volume * 25);\n          for(var i = volumes.length -1, j = 0; i >= 0; i--, j++) {\n            var el = angular.element(volumes[j]);\n            if (i >= n) el.removeClass('active');\n            else        el.addClass('active');\n          }\n\n          if(!verto.data.call) {\n            window.requestAnimationFrame(renderMic);\n          }\n        }\n        /**\n         * TODO: useless?\n         */\n\n        $scope.refreshDeviceList = function() {\n         return verto.refreshDevices();\n        };\n\n        $scope.videoCall = function() {\n          prompt({\n            title: $translate.instant('TITLE_ENABLE_VIDEO'),\n            message: $translate.instant('MESSAGE_ENABLE_VIDEO')\n          }).then(function() {\n            storage.data.videoCall = true;\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        };\n\n        $scope.cbMuteVideo = function(event, data) {\n          storage.data.mutedVideo = !storage.data.mutedVideo;\n        }\n\n        $scope.cbMuteMic = function(event, data) {\n          storage.data.mutedMic = !storage.data.mutedMic;\n        }\n\n        $scope.confChangeVideoLayout = function(layout) {\n          verto.data.conf.setVideoLayout(layout);\n        };\n\n        $scope.endPreview = function() {\n          localVideo.src = null;\n          if (audioContext) {\n            meter.shutdown();\n            meter.onaudioprocess = null;\n          };\n          stopMedia(streamObj);\n          $location.path('/dialpad');\n          storage.data.preview = false;\n        };\n\n        $scope.localVideo();\n      }\n    ]);\n})();\n\n(function() {\n    'use strict';\n\n    angular\n        .module('vertoControllers')\n        .controller('LoadingController', ['$rootScope', '$scope', '$location', '$interval', 'verto',\n            function($rootScope, $scope, $location, $interval, verto) {\n                console.log('Loading controller');\n                var int_id;\n\n                $scope.stopInterval = function() {\n                    $interval.cancel(int_id);\n                };\n\n                int_id = $interval(function() {\n                  if (verto.data.resCheckEnded) {\n                    $scope.stopInterval();\n                    $location.path('/preview');\n                  }\n                }, 1000);\n\n            }\n        ]);\n})();\n\n(function() {\n  'use strict';\n  var vertoDirectives = angular.module('vertoDirectives', []);\n})();\n\n/*\nSometimes autofocus HTML5 directive just isn't enough with SPAs.\nThis directive will force autofocus to work properly under those circumstances.\n*/\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('autofocus', ['$timeout',\n    function ($timeout) {\n      return {\n        restrict: 'A',\n        link: function ($scope, $element) {\n          $timeout(function () {\n            $element[0].focus();\n          });\n        }\n      };\n    }\n  ]);\n})();\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('showControls',\n  [\"Fullscreen\", function(Fullscreen) {\n    var link = function(scope, element, attrs) {\n      var i = null;\n      jQuery('.video-footer').fadeIn('slow');\n      jQuery('.video-hover-buttons').fadeIn('slow');\n      element.parent().bind('mousemove', function() {\n        if (Fullscreen.isEnabled()) {\n          clearTimeout(i);\n          jQuery('.video-footer').fadeIn('slow');\n          jQuery('.video-hover-buttons').fadeIn(500);\n          i = setTimeout(function() {\n            if (Fullscreen.isEnabled()) {\n              jQuery('.video-footer').fadeOut('slow');\n              jQuery('.video-hover-buttons').fadeOut(500);\n            }\n          }, 3000);\n        }\n      });\n      element.parent().bind('mouseleave', function() {\n        jQuery('.video-footer').fadeIn();\n        jQuery('.video-hover-buttons').fadeIn();\n      });\n    }\n\n\n    return {\n      link: link\n    };\n  }]);\n\n})();\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives').directive('userStatus',\n  function() {\n    var link = function(scope, element, attrs) {\n      scope.$watch('condition', function(condition) {\n        element.removeClass('connected');\n        element.removeClass('disconnected');\n        element.removeClass('connecting');\n\n        element.addClass(condition);\n\n      });\n    }\n\n    return {\n      scope: {\n        'condition': '='\n      },\n      link: link\n    };\n\n  });\n\n})();\n/**\n * To RTC work properly we need to give a <video> tag as soon as possible\n * because it needs to attach the video and audio stream to the tag.\n *\n * This directive is responsible for moving the video tag from the body to\n * the right place when a call start and move back to the body when the\n * call ends. It also hides and display the tag when its convenient.\n */\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('videoTag',\n  function() {\n\n    function link(scope, element, attrs) {\n      // Moving the video tag to the new place inside the incall page.\n      console.log('Moving the video to element.');\n      var videoElem = jQuery('#webcam');\n\n      var newParent = document.getElementsByClassName('video-tag-wrapper');\n\tnewParent[0].appendChild(document.getElementById('webcam'));\n\n\t$(\"#webcam\").resize(function() {\n\t    updateVideoSize();\n\t});\n\n\t$(window).resize(function() {\n\t    updateVideoSize();\n\t});\n\n\tupdateVideoSize();\n\t\n\tvideoElem.removeClass('hide');\n\tvideoElem.css('display', 'block');\n\n      scope.callActive(\"\", {useVideo: true});\n\n      element.on('$destroy', function() {\n        // Move the video back to the body.\n        console.log('Moving the video back to body.');\n        videoElem.addClass('hide').appendTo(jQuery('body'));\n        $(window).unbind('resize');\n      });\n    }\n\n    return {\n      link: link\n    }\n  });\n\n})();\n\n(function() {\n  'use strict';\n  var vertoFilters = angular.module('vertoFilters', []);\n})();\n\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoFilters')\n  .filter('picturify', function() {\n    var regex = /<a (|target=\"\\s*\\S*\" )href=\"(\\s*\\S*.(png|jpg|svg|gif|webp|bmp))\">\\s*\\S*<\\/a>/i;\n    var regex64 = /data:image\\/(\\s*\\S*);base64,((?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=))/g;\n\n    return function (text, width, n) {\n      var i = 0;\n      width = width || 150; //default width\n      if(regex64.test(text)) {\n        text = text.replace(regex64, '<a href=\"$1\" target=\"_blank\"><img class=\"chat-img\" width=\"'+ width +'\" src=\"data:image/png;base64,$2\"/></a>')\n      }\n\n      do {\n        text = text.replace(regex, '<a $1href=\"$2\"><img class=\"chat-img\" width=\"'+ width +'\" src=\"$2\"/></a>');\n      } while((!n || (n && i++ < n)) && regex.test(text));\n\n      return text;\n    }\n\n  });\n\n})();\n\n(function() {\n  'use strict';\n  var vertoService = angular.module('vertoService', []);\n})();\n\n'use strict';\n\n/* Controllers */\nvar videoQuality = [];\nvar videoQualitySource = [{\n  id: 'qqvga',\n  label: 'QQVGA 160x120',\n  width: 160,\n  height: 120\n}, {\n  id: 'qvga',\n  label: 'QVGA 320x240',\n  width: 320,\n  height: 240\n}, {\n  id: 'vga',\n  label: 'VGA 640x480',\n  width: 640,\n  height: 480\n}, {\n  id: 'qvga_wide',\n  label: 'QVGA WIDE 320x180',\n  width: 320,\n  height: 180\n}, {\n  id: 'vga_wide',\n  label: 'VGA WIDE 640x360',\n  width: 640,\n  height: 360\n}, {\n  id: 'hd',\n  label: 'HD 1280x720',\n  width: 1280,\n  height: 720\n}, {\n  id: 'hhd',\n  label: 'HHD 1920x1080',\n  width: 1920,\n  height: 1080\n}, ];\n\nvar videoResolution = {\n  qqvga: {\n    width: 160,\n    height: 120\n  },\n  qvga: {\n    width: 320,\n    height: 240\n  },\n  vga: {\n    width: 640,\n    height: 480\n  },\n  qvga_wide: {\n    width: 320,\n    height: 180\n  },\n  vga_wide: {\n    width: 640,\n    height: 360\n  },\n  hd: {\n    width: 1280,\n    height: 720\n  },\n  hhd: {\n    width: 1920,\n    height: 1080\n  },\n};\n\nvar bandwidth = [{\n  id: '250',\n  label: '250kb'\n}, {\n  id: '500',\n  label: '500kb'\n}, {\n  id: '1024',\n  label: '1mb'\n}, {\n  id: '1536',\n  label: '1.5mb'\n}, {\n  id: '2048',\n  label: '2mb'\n}, {\n  id: '3196',\n  label: '3mb'\n}, {\n  id: '4192',\n  label: '4mb'\n}, {\n  id: '5120',\n  label: '5mb'\n}, {\n  id: '0',\n  label: 'No Limit'\n}, {\n  id: 'default',\n  label: 'Server Default'\n}, ];\n\nvar framerate = [{\n  id: '15',\n  label: '15 FPS'\n}, {\n  id: '20',\n  label: '20 FPS'\n}, {\n  id: '30',\n  label: '30 FPS'\n}, ];\n\nvar updateReq;\n\nvar updateVideoSize = function(ms) {\n    if (!ms) ms = 500;\n\n    clearTimeout(updateReq);\n    updateReq = setTimeout(function () {\n        var videoElem = jQuery('#webcam');\n        videoElem.width(\"\");\n        videoElem.height(\"\");\n\n        var w = videoElem.width();\n        var h = videoElem.height();\n        var new_w, new_h;\n        var aspect = w / h;\n        var videoContainer = jQuery('div.video-wrapper');\n        if (w > h) {\n            new_w = videoContainer.width();\n            new_h = Math.round(videoContainer.width() / aspect);\n        } else {\n            new_h = videoContainer.height();\n            new_w = Math.round(videoContainer.height() / aspect);\n        }\n        videoElem.width(new_w);\n        videoElem.height(new_h);\n        console.log('Setting video size to ' + new_w + '/' + new_h);\n    }, ms);\n}\n\nvar vertoService = angular.module('vertoService', ['ngCookies']);\n\nvertoService.service('verto', ['$rootScope', '$cookieStore', '$location', 'storage',\n  function($rootScope, $cookieStore, $location, storage) {\n    var data = {\n      // Connection data.\n      instance: null,\n      connected: false,\n\n      // Call data.\n      call: null,\n      shareCall: null,\n      callState: null,\n      conf: null,\n      confLayouts: [],\n      confRole: null,\n      chattingWith: null,\n      liveArray: null,\n\n      // Settings data.\n      videoDevices: [],\n      audioDevices: [],\n      shareDevices: [],\n      videoQuality: [],\n      extension: $cookieStore.get('verto_demo_ext'),\n      name: $cookieStore.get('verto_demo_name'),\n      email: $cookieStore.get('verto_demo_email'),\n      cid: $cookieStore.get('verto_demo_cid'),\n      textTo: $cookieStore.get('verto_demo_textto') || \"1000\",\n      login: $cookieStore.get('verto_demo_login') || \"1008\",\n      password: $cookieStore.get('verto_demo_passwd') || \"1234\",\n      hostname: window.location.hostname,\n      wsURL: (\"wss://\" + window.location.hostname + \":8082\"),\n      wsFallbackURL: null,\n      turnServer: null,\n      resCheckEnded: false\n    };\n\n    function cleanShareCall(that) {\n      data.shareCall = null;\n      data.callState = 'active';\n      that.refreshDevices();\n    }\n\n    function cleanCall() {\n      data.call = null;\n      data.callState = null;\n      data.conf = null;\n      data.confLayouts = [];\n      data.confRole = null;\n      data.chattingWith = null;\n\n      $rootScope.$emit('call.hangup', 'hangup');\n    }\n\n    function inCall() {\n      $rootScope.$emit('page.incall', 'call');\n    }\n\n    function callActive(last_state, params) {\n      $rootScope.$emit('call.active', last_state, params);\n    }\n\n    function calling() {\n      $rootScope.$emit('call.calling', 'calling');\n    }\n\n    function incomingCall(number) {\n      $rootScope.$emit('call.incoming', number);\n    }\n\n    function updateResolutions(supportedResolutions) {\n      console.debug('Attempting to sync supported and available resolutions');\n\n      //var removed = 0;\n\n      console.debug(\"VQ length: \" + videoQualitySource.length);\n      console.debug(supportedResolutions);\n\n      angular.forEach(videoQualitySource, function(resolution, id) {\n        angular.forEach(supportedResolutions, function(res) {\n          var width = res[0];\n          var height = res[1];\n\n          if(resolution.width == width && resolution.height == height) {\n            videoQuality.push(resolution);\n          }\n        });\n      });\n\n      // videoQuality.length = videoQuality.length - removed;\n      console.debug(\"VQ length 2: \" + videoQuality.length);\n      data.videoQuality = videoQuality;\n      console.debug(videoQuality);\n      data.vidQual = (videoQuality.length > 0) ? videoQuality[videoQuality.length - 1].id : null;\n      console.debug(data.vidQual);\n\n      return videoQuality;\n    };\n\n    var callState = {\n      muteMic: false,\n      muteVideo: false\n    };\n\n    return {\n      data: data,\n      callState: callState,\n\n      // Options to compose the interface.\n      videoQuality: videoQuality,\n      videoResolution: videoResolution,\n      bandwidth: bandwidth,\n      framerate: framerate,\n\n      refreshDevicesCallback : function refreshDevicesCallback(callback) {\n        data.videoDevices = [{\n          id: 'none',\n          label: 'No Camera'\n        }];\n        data.shareDevices = [{\n          id: 'screen',\n          label: 'Screen'\n        }];\n        data.audioDevices = [{\n          id: 'any',\n          label: 'Default Microphone'\n\t},\n\t{\n\t    id: 'none',\n\t    label: 'No Microphone'\n        }];\n        data.speakerDevices = [{\n\t    id: 'any',\n\t    label: 'Default Speaker'\n\t}];\n\n        if(!storage.data.selectedShare) {\n          storage.data.selectedShare = data.shareDevices[0]['id'];\n        }\n\n        for (var i in jQuery.verto.videoDevices) {\n          var device = jQuery.verto.videoDevices[i];\n          if (!device.label) {\n            data.videoDevices.push({\n              id: 'Camera ' + i,\n              label: 'Camera ' + i\n            });\n          } else {\n            data.videoDevices.push({\n              id: device.id,\n              label: device.label || device.id\n            });\n          }\n\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedVideo) {\n            storage.data.selectedVideo = device.id;\n          }\n\n          if (!device.label) {\n            data.shareDevices.push({\n              id: 'Share Device ' + i,\n              label: 'Share Device ' + i\n            });\n            continue;\n          }\n\n          data.shareDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n\n        for (var i in jQuery.verto.audioInDevices) {\n          var device = jQuery.verto.audioInDevices[i];\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedAudio) {\n            storage.data.selectedAudio = device.id;\n          }\n\n          if (!device.label) {\n            data.audioDevices.push({\n              id: 'Microphone ' + i,\n              label: 'Microphone ' + i\n            });\n            continue;\n          }\n          data.audioDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n\n        for (var i in jQuery.verto.audioOutDevices) {\n          var device = jQuery.verto.audioOutDevices[i];\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedSpeaker) {\n            storage.data.selectedSpeaker = device.id;\n          }\n\n          if (!device.label) {\n            data.speakerDevices.push({\n              id: 'Speaker ' + i,\n              label: 'Speaker ' + i\n            });\n            continue;\n          }\n          data.speakerDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n        console.debug('Devices were refreshed, checking that we have cameras.');\n\n        // Verify if selected devices are valid\n        var videoFlag = data.videoDevices.some(function(device) {\n          console.log('Evaluating device ', device);\n          if (device.label == storage.data.selectedVideoName) {\n            console.log('Matched video selection by name: ', device.label);\n            storage.data.selectedVideo = device.id;\n            return true;\n          }\n          return device.id == storage.data.selectedVideo && storage.data.selectedVideo !== \"none\";\n        });\n\n        var shareFlag = data.shareDevices.some(function(device) {\n          return device.id == storage.data.selectedShare;\n        });\n\n        var audioFlag = data.audioDevices.some(function(device) {\n          return device.id == storage.data.selectedAudio;\n        });\n\n        var speakerFlag = data.speakerDevices.some(function(device) {\n          return device.id == storage.data.selectedSpeaker;\n        });\n\n        console.log('Storage Video: ', storage.data.selectedVideo);\n        console.log('Video Flag: ', videoFlag)\n\n        if (!videoFlag) storage.data.selectedVideo = data.videoDevices[data.videoDevices.length - 1].id;\n        if (!shareFlag) storage.data.selectedShare = data.shareDevices[0].id;\n        if (!audioFlag) storage.data.selectedAudio = data.audioDevices[0].id;\n        if (!speakerFlag && data.speakerDevices.length > 0) storage.data.selectedSpeaker = data.speakerDevices[0].id;\n\n        // This means that we cannot use video!\n        if (data.videoDevices.length === 0) {\n          console.log('No camera, disabling video.');\n          data.canVideo = false;\n          data.videoDevices.push({\n            id: 'none',\n            label: 'No camera'\n          });\n        } else {\n          data.canVideo = true;\n        }\n\n        if(angular.isFunction(callback)) {\n          callback();\n        }\n      },\n\n      refreshDevices: function(callback) {\n        console.debug('Attempting to refresh the devices.');\n        if(callback) {\n          jQuery.verto.refreshDevices(callback);\n        } else {\n          jQuery.verto.refreshDevices(this.refreshDevicesCallback);\n        }\n      },\n\n      /**\n       * Updates the video resolutions based on settings.\n       */\n      refreshVideoResolution: function(resolutions) {\n        console.debug('Attempting to refresh video resolutions.');\n\n        if (data.instance) {\n          var w = resolutions['bestResSupported'][0];\n          var h = resolutions['bestResSupported'][1];\n\n          if (h === 1080) {\n            w = 1280;\n            h = 720;\n          }\n\n          updateResolutions(resolutions['validRes']);\n          /* Do not touch video device resolution if autoBand is off and we have selected a vidQual */\n          if (!storage.data.autoBand && storage.data.vidQual) {\n            w = videoResolution[storage.data.vidQual].width;\n            h = videoResolution[storage.data.vidQual].height;\n          }\n          data.instance.videoParams({\n            minWidth: w,\n            minHeight: h,\n            maxWidth: w,\n            maxHeight: h,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n          videoQuality.forEach(function(qual){\n            if (w === qual.width && h === qual.height) {\n              if (storage.data.vidQual !== qual.id || storage.data.vidQual === undefined) {\n                storage.data.vidQual = qual.id;\n              }\n            }\n\n          });\n          data.resCheckEnded = true;\n\n        } else {\n          console.debug('There is no instance of verto.');\n        }\n      },\n\n      /**\n       * Connects to the verto server. Automatically calls `onWSLogin`\n       * callback set in the verto object.\n       *\n       * @param callback\n       */\n      connect: function(callback) {\n        console.debug('Attempting to connect to verto.');\n        var that = this;\n\n        function startConference(v, dialog, pvtData) {\n          $rootScope.$emit('call.video', 'video');\n          $rootScope.$emit('call.conference', 'conference');\n          data.chattingWith = pvtData.chatID;\n          data.confRole = pvtData.role;\n          data.conferenceMemberID = pvtData.conferenceMemberID;\n          var conf = new $.verto.conf(v, {\n            dialog: dialog,\n            hasVid: storage.data.useVideo,\n            laData: pvtData,\n            chatCallback: function(v, e) {\n              var from = e.data.fromDisplay || e.data.from || \"Unknown\";\n              var message = e.data.message || \"\";\n              $rootScope.$emit('chat.newMessage', {\n                from: from,\n                body: message\n              });\n            },\n            onBroadcast: function(v, conf, message) {\n              console.log('>>> conf.onBroadcast:', arguments);\n              if (message.action == 'response') {\n                // This is a response with the video layouts list.\n                if (message['conf-command'] == 'list-videoLayouts') {\n                  var rdata = [];\n\n                  for (var i in message.responseData) {\n                    rdata.push(message.responseData[i].name);\n                  }\n\n                  var options = rdata.sort(function(a, b) {\n                    var ga = a.substring(0, 6) == \"group:\" ? true : false;\n                    var gb = b.substring(0, 6) == \"group:\" ? true : false;\n\n                    if ((ga || gb) && ga != gb) {\n                      return ga ? -1 : 1;\n                    }\n\n                    return ( ( a == b ) ? 0 : ( ( a > b ) ? 1 : -1 ) );\n                  });\n                  data.confLayoutsData = message.responseData;\n                  data.confLayouts = options;\n                } else if (message['conf-command'] == 'canvasInfo') {\n                  data.canvasInfo = message.responseData;\n                  $rootScope.$emit('conference.canvasInfo', message.responseData);\n                } else {\n                  $rootScope.$emit('conference.broadcast', message);\n                }\n              }\n            }\n          });\n\n          if (data.confRole == \"moderator\") {\n            console.log('>>> conf.listVideoLayouts();');\n            conf.listVideoLayouts();\n            conf.modCommand('canvasInfo');\n          }\n\n          data.conf = conf;\n\n          data.liveArray = new $.verto.liveArray(\n            data.instance, pvtData.laChannel,\n            pvtData.laName, {\n              subParams: {\n                callID: dialog ? dialog.callID : null\n              }\n            });\n\n          data.liveArray.onErr = function(obj, args) {\n            console.log('liveArray.onErr', obj, args);\n          };\n\n          data.liveArray.onChange = function(obj, args) {\n            // console.log('liveArray.onChange', obj, args);\n            switch (args.action) {\n              case 'bootObj':\n                $rootScope.$emit('members.boot', args.data);\n                args.data.forEach(function(member){\n                  var callId = member[0];\n                  var status = angular.fromJson(member[1][4]);\n                  if (callId === data.call.callID) {\n                    $rootScope.$apply(function(){\n                      data.mutedMic = status.audio.muted;\n                      data.mutedVideo = status.video.muted;\n                    });\n                  }\n                });\n                break;\n              case 'add':\n                var member = [args.key, args.data];\n                $rootScope.$emit('members.add', member);\n                break;\n              case 'del':\n                var uuid = args.key;\n                $rootScope.$emit('members.del', uuid);\n                break;\n              case 'clear':\n                $rootScope.$emit('members.clear');\n                break;\n              case 'modify':\n                var member = [args.key, args.data];\n                $rootScope.$emit('members.update', member);\n                break;\n              default:\n                console.log('NotImplemented', args.action);\n            }\n          };\n        }\n\n        function stopConference() {\n          console.log('stopConference()');\n          if (data.liveArray) {\n            data.liveArray.destroy();\n            console.log('Has data.liveArray.');\n            $rootScope.$emit('members.clear');\n            data.liveArray = null;\n          } else {\n            console.log('Doesn\\'t found data.liveArray.');\n          }\n\n          if (data.conf) {\n            data.conf.destroy();\n            data.conf = null;\n          }\n        }\n\n        var callbacks = {\n          onWSLogin: function(v, success) {\n            data.connected = success;\n            $rootScope.loginFailed = !success;\n            $rootScope.$emit('ws.login', success);\n            console.debug('Connected to verto server:', success);\n\n            if (angular.isFunction(callback)) {\n              callback(v, success);\n            }\n          },\n\n          onMessage: function(v, dialog, msg, params) {\n            console.debug('onMessage:', v, dialog, msg, params);\n\n            switch (msg) {\n              case $.verto.enum.message.pvtEvent:\n                if (params.pvtData) {\n                  switch (params.pvtData.action) {\n                    case \"conference-liveArray-join\":\n\t\t      if (!params.pvtData.screenShare && !params.pvtData.videoOnly) {\n\t\t\t  console.log(\"conference-liveArray-join\");\n\t\t\t  stopConference();\n\t\t\t  startConference(v, dialog, params.pvtData);\n\t\t\t  updateVideoSize();\n\t\t      }\n                      break;\n                    case \"conference-liveArray-part\":\n\t\t      if (!params.pvtData.screenShare && !params.pvtData.videoOnly) {\n\t\t\t  console.log(\"conference-liveArray-part\");\n\t\t\t  stopConference();\n\t\t      }\n                      break;\n                  }\n                }\n                break;\n              /**\n                * This is not being used for conferencing chat\n                * anymore (see conf.chatCallback for that).\n                */\n              case $.verto.enum.message.info:\n                var body = params.body;\n                var from = params.from_msg_name || params.from;\n                if (!body) {\n                  console.log('Received an empty body: ', params);\n                  return;\n                }\n                $rootScope.$emit('chat.newMessage', {\n                  from: from,\n                  body: body\n                });\n                break;\n              case $.verto.enum.message.display:\n                    $rootScope.$apply(function() {});\n                    break;\n              case $.verto.enum.message.clientReady:\n                    $rootScope.$emit('clientReady', {\n                      reattached_sessions: params.reattached_sessions,\n                    });\n                    break;\n              default:\n                console.warn('Got a not implemented message:', msg, dialog, params);\n                break;\n            }\n          },\n\n          onDialogState: function(d) {\n            if (!data.call) {\n              data.call = d;\n\n            }\n\n            console.debug('onDialogState:', d);\n            switch (d.state.name) {\n              case \"ringing\":\n                incomingCall(d.params.caller_id_number);\n                break;\n              case \"trying\":\n                console.debug('Calling:', d.cidString());\n                data.callState = 'trying';\n                break;\n              case \"early\":\n                console.debug('Talking to:', d.cidString());\n                data.callState = 'active';\n                calling();\n                break;\n              case \"active\":\n                console.debug('Talking to:', d.cidString());\n                data.callState = 'active';\n                callActive(d.lastState.name, d.params);\n\t\tupdateVideoSize();\n                break;\n              case \"hangup\":\n                console.debug('Call ended with cause: ' + d.cause);\n                data.callState = 'hangup';\n                break;\n              case \"destroy\":\n                console.debug('Destroying: ' + d.cause);\n                if (d.params.screenShare) {\n                  cleanShareCall(that);\n                } else {\n                  stopConference();\n                  if (!that.reloaded) {\n                    cleanCall();\n                  }\n                }\n                break;\n              default:\n                console.warn('Got a not implemented state:', d);\n                break;\n            }\n          },\n\n          onWSClose: function(v, success) {\n            console.debug('onWSClose:', success);\n            $rootScope.$emit('ws.close', success);\n          },\n\n          onEvent: function(v, e) {\n            console.debug('onEvent:', e);\n          }\n        };\n\n        var that = this;\n        function ourBootstrap() {\n          var sessid = $location.search().sessid;\n          if (sessid === 'random') {\n            sessid = $.verto.genUUID();\n            $location.search().sessid = sessid;\n          }\n          // Checking if we have a failed connection attempt before\n          // connecting again.\n          if (data.instance && !data.instance.rpcClient.socketReady()) {\n            data.instance.rpcClient.stopRetrying();\n            data.instance.logout();\n            data.instance.login();\n            return;\n          };\n          data.instance = new jQuery.verto({\n            login: data.login + '@' + data.hostname,\n            passwd: data.password,\n            socketUrl: data.wsURL,\n            wsFallbackURL: data.wsFallbackURL,\n            turnServer: data.turnServer,\n            tag: \"webcam\",\n            ringFile: \"sounds/bell_ring2.wav\",\n            audioParams: {\n                googEchoCancellation: storage.data.googEchoCancellation === undefined ? true : storage.data.googEchoCancellation,\n                googNoiseSuppression: storage.data.googNoiseSuppression === undefined ? true : storage.data.googNoiseSuppression,\n                googHighpassFilter: storage.data.googHighpassFilter === undefined ? true : storage.data.googHighpassFilter,\n                googAutoGainControl: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl,\n                googAutoGainControl2: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl\n            },\n            sessid: sessid,\n            iceServers: storage.data.useSTUN\n          }, callbacks);\n\n          // We need to know when user reloaded page and not react to\n          // verto events in order to not stop the reload and redirect user back\n          // to the dialpad.\n          that.reloaded = false;\n          jQuery.verto.unloadJobs.push(function() {\n            that.reloaded = true;\n          });\n\n          data.instance.deviceParams({\n            useCamera: storage.data.selectedVideo,\n            useSpeak: storage.data.selectedSpeaker,\n            useMic: storage.data.selectedAudio,\n            onResCheck: that.refreshVideoResolution\n          });\n        }\n        if (data.mediaPerm) {\n          ourBootstrap();\n        } else {\n          $.FSRTC.checkPerms(ourBootstrap, true, true);\n        }\n      },\n\n      mediaPerm: function(callback) {\n        $.FSRTC.checkPerms(callback, true, true);\n      },\n\n      /**\n       * Login the client.\n       *\n       * @param callback\n       */\n      login: function(callback) {\n        data.instance.loginData({\n          login: data.login + '@' + data.hostname,\n          passwd: data.password\n        });\n        data.instance.login();\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Disconnects from the verto server. Automatically calls `onWSClose`\n       * callback set in the verto object.\n       *\n       * @param callback\n       */\n      disconnect: function(callback) {\n        console.debug('Attempting to disconnect to verto.');\n\n        data.instance.logout();\n        data.connected = false;\n\n        console.debug('Disconnected from verto server.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, data.connected);\n        }\n      },\n\n      /**\n       * Make a call.\n       *\n       * @param callback\n       */\n      call: function(destination, callback, custom) {\n        console.debug('Attempting to call destination ' + destination + '.');\n\n        var call = data.instance.newCall(angular.extend({\n          destination_number: destination,\n          caller_id_name: data.name,\n          caller_id_number: data.callerid ? data.callerid : data.email,\n          outgoingBandwidth: storage.data.outgoingBandwidth,\n          incomingBandwidth: storage.data.incomingBandwidth,\n          useVideo: storage.data.useVideo,\n          useStereo: storage.data.useStereo,\n          useCamera: storage.data.selectedVideo,\n          useSpeak: storage.data.selectedSpeaker,\n          useMic: storage.data.selectedAudio,\n          dedEnc: storage.data.useDedenc,\n          mirrorInput: storage.data.mirrorInput,\n          userVariables: {\n            email : storage.data.email,\n            avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n          }\n        }, custom));\n\n        data.call = call;\n\n        data.mutedMic = false;\n        data.mutedVideo = false;\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, call);\n        }\n      },\n\n      screenshare: function(destination, callback) {\n\n\n          var that = this;\n\n\t  if (storage.data.selectedShare !== \"screen\") {\n\n              console.log('share screen from device ' + storage.data.selectedShare);\n\n\t      var call = data.instance.newCall({\n\t\t  destination_number: destination + \"-screen\",\n\t\t  caller_id_name: data.name + \" (Screen)\",\n\t\t  caller_id_number: data.login + \" (screen)\",\n\t\t  outgoingBandwidth: storage.data.outgoingBandwidth,\n\t\t  incomingBandwidth: storage.data.incomingBandwidth,\n\t\t  useCamera: storage.data.selectedShare,\n\t\t  useVideo: true,\n\t\t  screenShare: true,\n\t\t  dedEnc: storage.data.useDedenc,\n\t\t  mirrorInput: storage.data.mirrorInput,\n\t\t  userVariables: {\n\t\t      email : storage.data.email,\n\t\t      avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n\t\t  }\n\t      });\n\n              // Override onStream callback in $.FSRTC instance\n              call.rtc.options.callbacks.onStream = function(rtc, stream) {\n\t\t  if(stream) {\n\t\t      var StreamTrack = stream.getVideoTracks()[0];\n\t\t      StreamTrack.addEventListener('ended', stopSharing);\n\t\t      // (stream.getVideoTracks()[0]).onended = stopSharing;\n\t\t  }\n\n\t\t  console.log(\"screenshare started\");\n\n\t\t  function stopSharing() {\n\t\t      if(that.data.shareCall) {\n\t\t\t  that.screenshareHangup();\n\t\t\t  console.log(\"screenshare ended\");\n\t\t      }\n\t\t  }\n              };\n\n              data.shareCall = call;\n\n              console.log('shareCall', data);\n\n              data.mutedMic = false;\n              data.mutedVideo = false;\n\n              that.refreshDevices();\n\n\t      return;\n\t  }\n\n\n        console.log('share screen from plugin ' + storage.data.selectedShare);\n\n        var screenfunc = function(error, sourceId, screen_constraints) {\n\n          if(error) {\n            $rootScope.$emit('ScreenShareExtensionStatus', error);\n            return;\n          }\n\n          var share_call = data.instance.newCall({\n            destination_number: destination + '-screen',\n            caller_id_name: data.name + ' (Screen)',\n            caller_id_number: data.login + ' (Screen)',\n            outgoingBandwidth: storage.data.outgoingBandwidth,\n            incomingBandwidth: storage.data.incomingBandwidth,\n            videoParams: screen_constraints ? screen_constraints.video.mandatory : {},\n            useVideo: true,\n            screenShare: true,\n            dedEnc: storage.data.useDedenc,\n            mirrorInput: storage.data.mirrorInput,\n            userVariables: {\n              email : storage.data.email,\n              avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n            }\n          });\n\n          // Override onStream callback in $.FSRTC instance\n          share_call.rtc.options.callbacks.onStream = function(rtc, stream) {\n            if(stream) {\n              var StreamTrack = stream.getVideoTracks()[0];\n              StreamTrack.addEventListener('ended', stopSharing);\n              // (stream.getVideoTracks()[0]).onended = stopSharing;\n            }\n\n            console.log(\"screenshare started\");\n\n            function stopSharing() {\n              if(that.data.shareCall) {\n                that.screenshareHangup();\n                console.log(\"screenshare ended\");\n              }\n            }\n          };\n\n          data.shareCall = share_call;\n\n          console.log('shareCall', data);\n\n          data.mutedMic = false;\n          data.mutedVideo = false;\n        };\n\n\t  if (!!navigator.mozGetUserMedia) {\n\t      screenfunc();\n\t  } else {\n              getScreenId(screenfunc);\n\t  }\n\n      },\n\n      screenshareHangup: function() {\n        if (!data.shareCall) {\n          console.debug('There is no call to hangup.');\n          return false;\n        }\n\n        console.log('shareCall End', data.shareCall);\n        data.shareCall.hangup();\n\n        console.debug('The screencall was hangup.');\n\n      },\n\n      /**\n       * Hangup the current call.\n       *\n       * @param callback\n       */\n      hangup: function(callback) {\n        console.debug('Attempting to hangup the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to hangup.');\n          return false;\n        }\n\n        data.call.hangup();\n\n        if (data.conf) {\n          data.conf.destroy();\n          data.conf = null;\n        }\n\n        console.debug('The call was hangup.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Send a DTMF to the current call.\n       *\n       * @param {string|integer} number\n       * @param callback\n       */\n      dtmf: function(number, callback) {\n        console.debug('Attempting to send DTMF \"' + number + '\".');\n\n        if (!data.call) {\n          console.debug('There is no call to send DTMF.');\n          return false;\n        }\n\n        data.call.dtmf(number.toString());\n        console.debug('The DTMF was sent for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Do speed test.\n       *\n       * @param callback\n       */\n      testSpeed: function(cb) {\n\n        data.instance.rpcClient.speedTest(1024 * 256, function(e, data) {\n          var upBand = Math.ceil(data.upKPS * .75),\n              downBand = Math.ceil(data.downKPS * .75);\n\n\n          if (storage.data.autoBand) {\n            storage.data.incomingBandwidth = downBand;\n            storage.data.outgoingBandwidth = upBand;\n            storage.data.useDedenc = false;\n            storage.data.vidQual = 'hd';\n\n            if (upBand < 256) {\n              storage.data.vidQual = 'qqvga';\n            }\n            else if (upBand < 512) {\n              storage.data.vidQual = 'qvga';\n            }\n            else if (upBand < 1024) {\n              storage.data.vidQual = 'vga';\n            }\n          }\n\n          if(cb) {\n            cb(data);\n          }\n\n          $rootScope.$emit('testSpeed', data);\n        });\n      },\n      /**\n       * Mute the microphone for the current call.\n       *\n       * @param callback\n       */\n      muteMic: function(callback) {\n        console.debug('Attempting to mute mic for the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to mute.');\n          return false;\n        }\n\n        data.call.dtmf('0');\n        data.mutedMic = !data.mutedMic;\n        console.debug('The mic was muted for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Mute the video for the current call.\n       *\n       * @param callback\n       */\n      muteVideo: function(callback) {\n        console.debug('Attempting to mute video for the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to mute.');\n          return false;\n        }\n\n        data.call.dtmf('*0');\n        data.mutedVideo = !data.mutedVideo;\n        console.debug('The video was muted for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n      /*\n      * Method is used to send conference chats ONLY.\n      */\n      sendConferenceChat: function(message) {\n        data.conf.sendChat(message, \"message\");\n      },\n      setCanvasIn: function(memberID, canvasID) {\n        data.conf.modCommand('vid-canvas', memberID, canvasID);\n      },\n      setCanvasOut: function(memberID, canvasID) {\n        data.conf.modCommand('vid-watching-canvas', memberID, canvasID);\n      },\n      setLayer: function(memberID, canvasID) {\n        data.conf.modCommand('vid-layer', memberID, canvasID);\n      },\n      /*\n      * Method is used to set a member's resevartion Id.\n      */\n      setResevartionId: function(memberID, resID) {\n        data.conf.modCommand('vid-res-id', memberID, resID);\n      },\n      /*\n      * Method is used to send user2user chats.\n      * VC does not yet support that.\n      */\n      sendMessage: function(body, callback) {\n        data.call.message({\n          to: data.chattingWith,\n          body: body,\n          from_msg_name: data.name,\n          from_msg_number: data.cid\n        });\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      }\n    };\n  }\n]);\n\n'use strict';\n\nvar vertoService = angular.module('vertoService');\n\nvertoService.service('config', ['$rootScope', '$http', '$location', 'storage', 'verto',\n  function($rootScope, $http, $location, storage, verto) {\n    var configure = function() {\n      /**\n       * Load stored user info into verto service\n       */\n      if(storage.data.name) {\n        verto.data.name = storage.data.name;\n      }\n      if(storage.data.email) {\n        verto.data.email = storage.data.email;\n      }\n      if(storage.data.login) {\n        verto.data.login = storage.data.login;\n      }\n      if(storage.data.password) {\n        verto.data.password = storage.data.password;\n      }\n\n      /*\n       * Load the Configs before logging in\n       * with cache buster\n       */\n      var url = window.location.origin + window.location.pathname;\n      var httpRequest = $http.get(url + 'config.json?cachebuster=' + Math.floor((Math.random()*1000000)+1));\n\n      var httpReturn = httpRequest.then(function(response) {\n        var data = response.data;\n\n        /* save these for later as we're about to possibly over write them */\n        var name = verto.data.name;\n        var email = verto.data.email;\n\n        console.debug(\"googlelogin: \" + data.googlelogin);\n        if (data.googlelogin){\n          verto.data.googlelogin = data.googlelogin;\n          verto.data.googleclientid = data.googleclientid;\n        }\n\n        if (data.wsFallbackURL) {\n          verto.data.wsFallbackURL = data.wsFallbackURL;\n        }\n\n        if (data.turnServer) {\n          verto.data.turnServer = data.turnServer;\n        }\n\n        angular.extend(verto.data, data);\n\n        /**\n         * use stored data (localStorage) for login, allow config.json to take precedence\n         */\n\n        if (name != '' && data.name == '') {\n          verto.data.name = name;\n        }\n        if (email != '' && data.email == '') {\n          verto.data.email = email;\n        }\n        if (verto.data.login == '' && verto.data.password == '' && storage.data.login != '' && storage.data.password != '') {\n          verto.data.login = storage.data.login;\n          verto.data.password = storage.data.password;\n        }\n\n        if (verto.data.autologin == \"true\" && !verto.data.autologin_done) {\n          console.debug(\"auto login per config.json\");\n          verto.data.autologin_done = true;\n        }\n\n        if(verto.data.autologin && storage.data.name.length && storage.data.email.length && storage.data.login.length && storage.data.password.length) {\n          $rootScope.$emit('config.http.success', data);\n        };\n        return response;\n      }, function(response) {\n        $rootScope.$emit('config.http.error', response);\n        return response;\n      });\n\n      return httpReturn;\n    };\n\n    return {\n      'configure': configure\n    };\n  }]);\n\n'use strict';\n\n  angular\n    .module('vertoService')\n    .service('eventQueue', ['$rootScope', '$q', 'storage', 'verto',\n      function($rootScope, $q, storage, verto) {\n        \n        var events = [];\n        \n        var next = function() {\n          var fn, fn_return;\n          \n          fn = events.shift();\n          \n          if (fn == undefined) {\n            $rootScope.$emit('eventqueue.complete');\n            return;\n          }\n          fn_return = fn();\n\n          var emitNextProgress = function() {\n            $rootScope.$emit('eventqueue.next');\n          };\n\n          fn_return.then(\n            function() {\n              emitNextProgress();\n            }, \n            function() {\n              emitNextProgress();\n            }\n          );\n        };\n\n        var process = function() {\n          $rootScope.$on('eventqueue.next', function (ev){\n            next();\n          });\n          \n          next(); \n        };\n\n        return {\n          'next': next,\n          'process': process,\n          'events': events\n        };\n\n      }]);\n \n\n(function() {\n  'use strict';\n  var vertoService = angular.module('storageService', ['ngStorage']);\n})();\n\n'use strict';\n\n  angular\n  .module('storageService')\n  .service('storage', ['$rootScope', '$localStorage',\n  function($rootScope, $localStorage) {\n    var data = $localStorage,\n\tdefaultSettings = {\n\t  ui_connected: false,\n          ws_connected: false,\n          cur_call: 0,\n          called_number: '',\n          useVideo: true,\n          call_history: {},\n          history_control: [],\n          call_start: false,\n          name: '',\n          email: '',\n          login: '',\n          password: '',\n          userStatus: 'disconnected',\n          mutedVideo: false,\n          mutedMic: false,\n          preview: true,\n          selectedVideo: null,\n          selectedVideoName: null,\n          selectedAudio: null,\n          selectedShare: null,\n          selectedSpeaker: null,\n          useStereo: true,\n          useSTUN: true,\n          useDedenc: false,\n          mirrorInput: false,\n          outgoingBandwidth: 'default',\n          incomingBandwidth: 'default',\n          vidQual: undefined,\n          askRecoverCall: false,\n          googNoiseSuppression: true,\n          googHighpassFilter: true,\n          googEchoCancellation: true,\n          googAutoGainControl: true,\n          autoBand: true,\n          testSpeedJoin: true,\n          bestFrameRate: \"15\",\n          language: undefined\n       };\n\n    data.$default(defaultSettings);\n\n    function changeData(verto_data) {\n      jQuery.extend(true, data, verto_data);\n    }\n\n    return {\n      data: data,\n      changeData: changeData,\n      reset: function() {\n        data.ui_connected = false;\n        data.ws_connected = false;\n        data.cur_call = 0;\n        data.userStatus = 'disconnected';\n      },\n      factoryReset: function() {\n        localStorage.clear();\n        // set defaultSettings again\n        data.$reset(defaultSettings);\n      },\n    };\n  }\n]);\n\n'use strict';\n\n  angular\n  .module('storageService')\n  .factory('CallHistory', [\"storage\", function(storage) {\n\n    var history = storage.data.call_history;\n    var history_control = storage.data.history_control;\n\n    var addCallToHistory = function(number, direction, status) {\n      if(history[number] == undefined) {\n        history[number] = [];\n      }\n\n      history[number].unshift({\n        'number': number,\n        'direction': direction,\n        'status': status,\n        'call_start': Date()\n      });\n\n      var index = history_control.indexOf(number);\n      console.log(index);\n      if(index > -1) {\n        history_control.splice(index, 1);\n      }\n\n      history_control.unshift(number);\n\n    };\n\n    var getCallsFromHistory = function(number) {\n      return history[number];\n    };\n\n    return {\n      all: function() {\n        return history;\n      },\n      all_control: function() {\n        return history_control;\n      },\n      get: function(number) {\n        return getCallsFromHistory(number);\n      },\n      add: function(number, direction, status) {\n        return addCallToHistory(number, direction, status);\n      },\n      clear: function() {\n        storage.data.call_history = {};\n        storage.data.history_control = [];\n        history = storage.data.call_history;\n        history_control = storage.data.history_control;\n        return history_control;\n      }\n    }\n}]);\n\n'use strict';\n\n  angular\n    .module('storageService')\n    .service('splashscreen', ['$rootScope', '$q', 'storage', 'config', 'verto', '$translate',\n      function($rootScope, $q, storage, config, verto, $translate) {\n\n        var checkBrowser = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'browser-upgrade';\n            var result = {\n              'activity': activity,\n              'soft': false,\n              'status': 'success',\n              'message': $translate.instant('BROWSER_COMPATIBILITY')\n            };\n            if (!navigator.mediaDevices.getUserMedia) {\n              result['status'] = 'error';\n              result['message'] = $translate.instant('BROWSER_WITHOUT_WEBRTC');\n              reject(result);\n            }\n\n            resolve(result);\n\n          });\n        };\n\n        var checkMediaPerm = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'media-perm';\n            var result = {\n              'activity': activity,\n              'soft': false,\n              'status': 'success',\n              'message': $translate.instant('CHECK_PERMISSION_MEDIA')\n            };\n\n            verto.mediaPerm(function(status) {\n              if(!status) {\n                result['status'] = 'error';\n                result['message'] = $translate.instant('ERROR_PERMISSION_MEDIA');\n                verto.data.mediaPerm = false;\n                reject(result);\n              }\n              verto.data.mediaPerm = true;\n              resolve(result);\n            });\n          });\n        };\n\n        var refreshMediaDevices = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'refresh-devices';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('REFRESH_MEDIA_DEVICES')\n            };\n\n            verto.refreshDevices(function(status) {\n              verto.refreshDevicesCallback(function() {\n                resolve(result);\n              });\n            });\n\n          });\n        };\n\n        var checkConnectionSpeed = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'check-connection-speed';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_CONNECTION_SPEED')\n            };\n\n            if (storage.data.autoBand && verto.data.instance) {\n              verto.testSpeed(cb);\n            } else {\n              resolve(result);\n            }\n\n            function cb(data) {\n              resolve(result);\n            }\n          });\n        };\n\n        var provisionConfig = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'provision-config';\n            var result = {\n              'status': 'promise',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_PROVISIONING_CONF')\n            };\n\n            var configResponse = config.configure();\n\n            var configPromise = configResponse.then(\n              function(response) {\n                /**\n                 * from angular docs:\n                 * A response status code between 200 and 299 is considered a success status and will result in the success callback being called\n                 */\n                if(response.status >= 200 && response.status <= 299) {\n                  return result;\n                } else {\n                  result['status'] = 'error';\n                  result['message'] = $translate.instant('ERROR_PROVISIONING_CONF');\n                  return result;\n                }\n              });\n\n              result['promise'] = configPromise;\n\n              resolve(result);\n          });\n        };\n\n        var checkLogin = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'check-login';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_LOGIN'),\n            };\n\n            if(verto.data.connecting || verto.data.connected) {\n              resolve(result);\n              return;\n            };\n\n            var checkUserStored = function() {\n              /**\n               * if user data saved, use stored data for logon and not connecting\n               * not connecting prevent two connects\n               */\n              if (storage.data.ui_connected && storage.data.ws_connected && !verto.data.connecting) {\n                verto.data.hostname = storage.data.hostname || verto.data.hostname;\n                verto.data.wsURL = storage.data.wsURL || verto.data.wsURL;\n                verto.data.name = storage.data.name;\n                verto.data.email = storage.data.email;\n                verto.data.login = storage.data.login;\n                verto.data.password = storage.data.password;\n\n                verto.data.connecting = true;\n                verto.connect(function(v, connected) {\n                  verto.data.connecting = false;\n                  resolve(result);\n                });\n              };\n            };\n\n            if(storage.data.ui_connected && storage.data.ws_connected) {\n              checkUserStored();\n            } else {\n              resolve(result);\n            };\n          });\n        };\n\n        var progress = [\n          checkBrowser,\n          checkMediaPerm,\n          refreshMediaDevices,\n          provisionConfig,\n          checkLogin,\n          checkConnectionSpeed\n        ];\n\n        var progress_message = [\n          $translate.instant('BROWSER_COMPATIBILITY'),\n          $translate.instant('CHECK_PERMISSION_MEDIA'),\n          $translate.instant('REFRESH_MEDIA_DEVICES'),\n          $translate.instant('CHECK_PROVISIONING_CONF'),\n          $translate.instant('CHECK_LOGIN'),\n          $translate.instant('CHECK_CONNECTION_SPEED'),\n        ];\n\n        var getProgressMessage = function(current_progress) {\n          if(progress_message[current_progress] != undefined) {\n            return progress_message[current_progress];\n          } else {\n            return $translate.instant('PLEASE_WAIT');\n          }\n        };\n\n        var current_progress = -1;\n        var progress_percentage = 0;\n\n        var calculateProgress = function(index) {\n          var _progress;\n\n          _progress = index + 1;\n          progress_percentage = (_progress / progress.length) * 100;\n          return progress_percentage;\n        };\n\n        var nextProgress = function() {\n          var fn, fn_return, status, interrupt, activity, soft, message, promise;\n          interrupt = false;\n          current_progress++;\n\n          if(current_progress >= progress.length) {\n            $rootScope.$emit('progress.complete', current_progress);\n            return;\n          }\n\n          fn = progress[current_progress];\n          fn_return = fn();\n\n          var emitNextProgress = function(fn_return) {\n            if(fn_return['promise'] != undefined) {\n              promise = fn_return['promise'];\n            }\n\n            status = fn_return['status'];\n            soft = fn_return['soft'];\n            activity = fn_return['activity'];\n            message = fn_return['message'];\n\n            if(status != 'success') {\n              interrupt = true;\n            }\n\n            $rootScope.$emit('progress.next', current_progress, status, promise, activity, soft, interrupt, message);\n\n          };\n\n          fn_return.then(\n            function(fn_return) {\n              emitNextProgress(fn_return);\n            },\n            function(fn_return) {\n              emitNextProgress(fn_return);\n            }\n          );\n\n        };\n\n        return {\n          'next': nextProgress,\n          'getProgressMessage': getProgressMessage,\n          'progress_percentage': progress_percentage,\n          'calculate': calculateProgress\n        };\n\n      }]);\n"]}