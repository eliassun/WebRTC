{"version":3,"sources":["../../.tmp/concat/scripts/scripts.js"],"names":["createAudioMeter","audioContext","clipLevel","averaging","clipLag","processor","createScriptProcessor","onaudioprocess","volumeAudioProcess","clipping","lastClip","volume","connect","destination","checkClipping","this","window","performance","now","shutdown","disconnect","event","x","buf","inputBuffer","getChannelData","bufLength","length","sum","i","Math","abs","rms","sqrt","max","getScreenConstraints","error","sourceId","screen_constraints","audio","video","mandatory","chromeMediaSource","maxWidth","screen","width","maxHeight","height","optional","chromeMediaSourceId","postMessage","iframe","isLoaded","contentWindow","captureSourceId","setTimeout","loadIFrame","loadCallback","document","createElement","onload","src","style","display","body","documentElement","appendChild","getScreenId","callback","onIFrameCallback","data","chromeExtensionStatus","removeEventListener","navigator","mozGetUserMedia","mozMediaSource","mediaSource","addEventListener","domain","indexOf","a","b","c","d","e","f","g","h","j","k","l","m","n","o","p","String","fromCharCode","charCodeAt","concat","charAt","unescape","encodeURIComponent","q","r","s","t","define","amd","md5","vertoApp","angular","module","constant","languages","id","name","dialects","en","en_GB","en_US","it","it_IT","fr","fr_FR","fr_CA","pt","pt_BR","pt_PT","de","de_DE","es","es_ES","pl","pl_PL","ru","ru_RU","sv","sv_SV","sv_FI","da","da_DK","id_ID","zh","zh_CN","zh_TW","zh_HK","config","$routeProvider","gravatarServiceProvider","$translateProvider","configLanguages","when","title","templateUrl","controller","otherwise","redirectTo","defaults","default","reg_langs","forEach","value","key","push","useStaticFilesLoader","prefix","suffix","registerAvailableLanguageKeys","preferredLanguage","determinePreferredLanguage","fallbackLanguage","useSanitizeValueStrategy","run","$rootScope","$location","toastr","prompt","verto","$on","next","current","connected","path","previous","$$route","safeProtocol","location","protocol","promptInput","message","label","input","then","ret","isFunction","$scope","$timeout","storage","splashscreen","console","debug","progress_percentage","interrupt_next","errors","link","activity","checkProgressState","current_progress","status","promise","soft","interrupt","calculate","confirm","getProgressMessage","ev","response","$http","Fullscreen","$anchorScroll","$translate","scrollToChatBottom","obj","querySelector","scrollTop","scrollHeight","clearConferenceChat","members","messages","CLEAN_MESSAGE","getResByLayout","layout","layoutsData","confLayoutsData","resIDS","clearMembersResID","preserve","member","resID","reservationID","confResID","findMemberByUUID","uuid","found","idx","translateMember","number","codec","JSON","parse","email","addMember","shortPrompt","text","cb","val","$watch","activePane","chat_counter","created_at","Date","log","$apply","from","chatStatus","conf","params","laData","resIDs","currentLayout","layoutName","openId","watcher","master","hangup","close","memberIdx","splice","parseInt","conferenceMemberID","mutedMic","muted","mutedVideo","call","setMute","setVideoMute","extend","$applyAsync","closeChat","toggleModMenu","index","confRole","send","type","preventDefault","sendConferenceChat","confKick","memberID","kick","confMuteMic","muteMic","confMuteVideo","muteVideo","confPresenter","presenter","setResevartionId","confVideoFloor","videoFloor","confBanner","instant","banner","confCanvasIn","canvasID","setCanvasIn","confCanvasOut","setCanvasOut","confLayer","setLayer","confResetBanner","confVolumeDown","volumeDown","confVolumeUp","volumeUp","confGainDown","gainDown","confGainUp","gainUp","confTransfer","disableOnKeydownDtmf","exten","enableOnKeydownDtmf","transfer","catch","confToggleDeaf","deaf","undeaf","url","origin","pathname","get","success","contributors","re","replace","githash","CallHistory","eventQueue","extension","onHold","cur_call","dialpadNumber","called_number","useCamera","useMic","useSpeak","caller_id_name","userVariables","caller_id_number","mirrorInput","videoCall","add","warning","process","search","autocall","call_history","all","history_control","all_control","has_history","Object","keys","userStatus","calling","clearCallHistory","clear","viewCallsList","calls","call_list","fillDialpadNumber","preview","loading","cancelled","testSpeedJoin","testSpeed","cancel","$modal","buildCanvasesData","canvases","canvasCount","callTemplate","dialpadTemplate","incall","openChat","toggleDialpad","openModal","cbMuteVideo","cbMuteMic","confChangeVideoLayout","setVideoLayout","videoLayout","$emit","confChangeSpeaker","speakerId","selectedSpeaker","confPopup","canvas_id","getElementById","href","curCall","callID","remote_caller_id_number","webcam","offsetWidth","offsetHeight","y","open","moveTo","screenshare","shareCall","screenshareHangup","laName","info","allowHtml","$broadcast","skipPreview","login","$q","$window","onWSClose","ws_modalInstance","options","backdrop","keyboard","showReconnectModal","onWSLogin","autoBand","gapiClientLoaded","gapi","client","plus","people","userId","execute","handleEmailResponse","resp","primaryEmail","emails","displayName","image","sinkIdCallback","deviceName","onKeydownDtmfHistory","caracter","onKeydownDtmfEnabled","match","dtmfWidget","dtmfHistory","$","haltClosure","callState","language","use","element","addClass","dialpad","myVideo","hasClass","setAudioPlaybackDevice","redirect","undefined","connectCallback","v","connecting","hostname","wsURL","ui_connected","ws_connected","password","logout","disconnectCallback","reset","auth","signOut","openModalSettings","modalInstance","animation","animationsEnabled","result","rendered","jQuery","material","init","_options","showAbout","showContributors","dtmf","backspace","len","substring","toggleCallHistory","removeClass","toggleChat","toggleClass","updateVideoSize","toggleSettings","settingsEl","closeSettings","goFullscreen","fullscreenEnabled","isEnabled","enable","getElementsByTagName","$digest","page_incall","resolve","reject","askRecoverCall","events","authResult","load","callActive","call_start","start_time","play","useVideo","incomingCall","answerCall","declineCall","hold","toggleHold","answer","useStereo","selectedVideo","callee_id_name","callee_id_number","file","stop","record","stopRecord","snapshot","originalPath","bind","unbind","vidQual","bwp","bandDown","downKPS","bandUp","upKPS","iconClass","videoQuality","vid","vidRes","$modalInstance","ok","dismiss","ModalWsReconnectController","closeReconnect","instance","rpcClient","stopRetrying","$inject","speakerFeature","sinkId","mydata","copy","unshift","translation","videoDevices","selectedVideoName","changeData","iceServers","useSTUN","audioParams","googEchoCancellation","googNoiseSuppression","googHighpassFilter","googAutoGainControl","googAutoGainControl2","changedLanguage","langKey","browserlang","lang","fail_lang","refreshDeviceList","refreshDevices","showPreview","speedMsg","isTestingSpeed","resetSettings","factoryReset","reload","checkAutoBand","option","useDedenc","bestres","videoParams","minWidth","minHeight","minFrameRate","vertoBestFrameRate","bestFrameRate","outgoingBandwidth","incomingBandwidth","checkUseDedRemoteEncoder","checkVideoQuality","resolution","w","videoResolution","stopMedia","stream","active","tracks","getTracks","track","handleMedia","streamObj","FSRTCattachMediaStream","localVideo","mediaStreamSource","createMediaStreamSource","meter","volumes","children","constraints","mirrored","selectedAudio","newDevice","find","device","getUserMedia","err","AudioContext","endPreview","$interval","int_id","stopInterval","resCheckEnded","directive","restrict","$element","focus","scope","attrs","fadeIn","parent","clearTimeout","fadeOut","condition","videoElem","getElementsByClassName","resize","css","on","appendTo","filter","regex","regex64","test","videoQualitySource","qqvga","qvga","vga","qvga_wide","vga_wide","hd","hhd","bandwidth","framerate","updateReq","ms","new_w","new_h","aspect","videoContainer","round","vertoService","service","$cookieStore","cleanShareCall","that","cleanCall","confLayouts","chattingWith","last_state","updateResolutions","supportedResolutions","res","liveArray","audioDevices","shareDevices","cid","textTo","wsFallbackURL","turnServer","refreshDevicesCallback","speakerDevices","selectedShare","audioInDevices","audioOutDevices","videoFlag","some","shareFlag","audioFlag","speakerFlag","canVideo","refreshVideoResolution","resolutions","qual","startConference","dialog","pvtData","chatID","role","hasVid","chatCallback","fromDisplay","onBroadcast","arguments","action","rdata","responseData","sort","ga","gb","canvasInfo","listVideoLayouts","modCommand","laChannel","subParams","onErr","args","onChange","callId","fromJson","stopConference","destroy","ourBootstrap","sessid","genUUID","socketReady","passwd","socketUrl","tag","ringFile","callbacks","reloaded","unloadJobs","deviceParams","onResCheck","loginFailed","onMessage","msg","enum","pvtEvent","screenShare","videoOnly","from_msg_name","clientReady","reattached_sessions","warn","onDialogState","state","cidString","lastState","cause","onEvent","mediaPerm","FSRTC","checkPerms","loginData","custom","newCall","destination_number","callerid","dedEnc","avatar","rtc","onStream","stopSharing","getVideoTracks","screenfunc","share_call","toString","speedTest","upBand","ceil","downBand","sendChat","sendMessage","to","from_msg_number","configure","floor","random","googlelogin","googleclientid","autologin","autologin_done","fn","fn_return","shift","emitNextProgress","$localStorage","verto_data","defaultSettings","$default","localStorage","$reset","factory","history","addCallToHistory","direction","getCallsFromHistory","checkBrowser","mediaDevices","checkMediaPerm","refreshMediaDevices","checkConnectionSpeed","provisionConfig","configResponse","configPromise","checkLogin","checkUserStored","progress","progress_message","calculateProgress","_progress"],"mappings":"AAkSA,QAASA,kBAAiBC,EAAaC,EAAUC,EAAUC,GAC1D,GAAIC,GAAYJ,EAAaK,sBAAsB,IA4BnD,OA3BAD,GAAUE,eAAiBC,mBAC3BH,EAAUI,UAAW,EACrBJ,EAAUK,SAAW,EACrBL,EAAUM,OAAS,EACnBN,EAAUH,UAAYA,GAAa,IACnCG,EAAUF,UAAYA,GAAa,IACnCE,EAAUD,QAAUA,GAAW,IAI/BC,EAAUO,QAAQX,EAAaY,aAE/BR,EAAUS,cACT,WACC,QAAKC,KAAKN,WAELM,KAAKL,SAAWK,KAAKX,QAAWY,OAAOC,YAAYC,QACvDH,KAAKN,UAAW,GACVM,KAAKN,WAGdJ,EAAUc,SACT,WACCJ,KAAKK,aACLL,KAAKR,eAAiB,MAGjBF,EAGR,QAASG,oBAAoBa,GAOzB,IAAK,GAHDC,GAHHC,EAAMF,EAAMG,YAAYC,eAAe,GACpCC,EAAYH,EAAII,OACnBC,EAAM,EAIEC,EAAE,EAAGA,EAAEH,EAAWG,IAC1BP,EAAIC,EAAIM,GACJC,KAAKC,IAAIT,IAAIP,KAAKb,YACrBa,KAAKN,UAAW,EAChBM,KAAKL,SAAWM,OAAOC,YAAYC,OAEpCU,GAAON,EAAIA,CAIZ,IAAIU,GAAOF,KAAKG,KAAKL,EAAMF,EAK3BX,MAAKJ,OAASmB,KAAKI,IAAIF,EAAKjB,KAAKJ,OAAOI,KAAKZ,YAjUjD,WAqCI,QAASgC,GAAqBC,EAAOC,GACjC,GAAIC,IACAC,OAAO,EACPC,OACIC,WACIC,kBAAmBN,EAAQ,SAAW,UACtCO,SAAU3B,OAAO4B,OAAOC,MAAQ,KAAO7B,OAAO4B,OAAOC,MAAQ,KAC7DC,UAAW9B,OAAO4B,OAAOG,OAAS,KAAO/B,OAAO4B,OAAOG,OAAS,MAEpEC,aAQR,OAJIX,KACAC,EAAmBE,MAAMC,UAAUQ,oBAAsBZ,GAGtDC,EAGX,QAASY,KACL,MAAKC,GAKAA,EAAOC,aAKZD,GAAOE,cAAcH,aACjBI,iBAAiB,GAClB,SANCC,YAAWL,EAAa,SALxBM,GAAWN,GAcnB,QAASM,GAAWC,GAChB,GAAIN,EAEA,WADAM,IAIJN,GAASO,SAASC,cAAc,UAChCR,EAAOS,OAAS,WACZT,EAAOC,UAAW,EAElBK,KAEJN,EAAOU,IAAM,iDACbV,EAAOW,MAAMC,QAAU,QACtBL,SAASM,MAAQN,SAASO,iBAAiBC,YAAYf,GAtF5DnC,OAAOmD,YAAc,SAASC,GAkB1B,QAASC,GAAiBhD,GACjBA,EAAMiD,OAEPjD,EAAMiD,KAAKrB,sBAC4B,0BAAnC5B,EAAMiD,KAAKrB,oBACXmB,EAAS,qBACNA,EAAS,KAAM/C,EAAMiD,KAAKrB,oBAAqBd,EAAqB,KAAMd,EAAMiD,KAAKrB,uBAG5F5B,EAAMiD,KAAKC,uBACXH,EAAS/C,EAAMiD,KAAKC,sBAAuB,KAAMpC,EAAqBd,EAAMiD,KAAKC,wBAIrFvD,OAAOwD,oBAAoB,UAAWH,IA5B1C,GAAMI,UAAUC,gBAOZ,WANAN,GAAS,KAAM,WACX5B,OACImC,eAAgB,SAChBC,YAAa,WAMzB1B,KAEAlC,OAAO6D,iBAAiB,UAAWR,GAyEvC,IAAIlB,EAGJnC,QAAOmB,qBAAuB,SAASiC,GACnCZ,EAAW,WACPW,YAAY,SAAS/B,EAAOC,EAAUC,GAClC8B,EAAShC,EAAOE,EAAmBE,eAMnD,WAyCI,QAASL,GAAqBC,EAAOC,GACjC,GAAIC,IACAC,OAAO,EACPC,OACIC,WACIC,kBAAmBN,EAAQ,SAAW,UACtCO,SAAU3B,OAAO4B,OAAOC,MAAQ,KAAO7B,OAAO4B,OAAOC,MAAQ,KAC7DC,UAAW9B,OAAO4B,OAAOG,OAAS,KAAO/B,OAAO4B,OAAOG,OAAS,MAEpEC,aAQR,OAJIX,KACAC,EAAmBE,MAAMC,UAAUQ,oBAAsBZ,GAGtDC,EAGX,QAASY,KACL,MAAKC,GAKAA,EAAOC,aAKZD,GAAOE,cAAcH,aACjBI,iBAAiB,GAClB,SANCC,YAAWL,EAAa,SALxBM,GAAWN,GAcnB,QAASM,GAAWC,GAChB,GAAIN,EAEA,WADAM,IAIJN,GAASO,SAASC,cAAc,UAChCR,EAAOS,OAAS,WACZT,EAAOC,UAAW,EAElBK,KAEJN,EAAOU,IAAM,iDACbV,EAAOW,MAAMC,QAAU,QACtBL,SAASM,MAAQN,SAASO,iBAAiBC,YAAYf,GA1F5D,IAAyD,IAAtDO,SAASoB,OAAOC,QAAQ,yBAA3B,CAIA/D,OAAOmD,YAAc,SAASC,GAkB1B,QAASC,GAAiBhD,GACjBA,EAAMiD,OAEPjD,EAAMiD,KAAKrB,sBAC4B,0BAAnC5B,EAAMiD,KAAKrB,oBACXmB,EAAS,qBACNA,EAAS,KAAM/C,EAAMiD,KAAKrB,oBAAqBd,EAAqB,KAAMd,EAAMiD,KAAKrB,uBAG5F5B,EAAMiD,KAAKC,uBACXH,EAAS/C,EAAMiD,KAAKC,sBAAuB,KAAMpC,EAAqBd,EAAMiD,KAAKC,wBAIrFvD,OAAOwD,oBAAoB,UAAWH,IA5B1C,GAAMI,UAAUC,gBAOZ,WANAN,GAAS,KAAM,WACX5B,OACImC,eAAgB,SAChBC,YAAa,WAMzB1B,KAEAlC,OAAO6D,iBAAiB,UAAWR,GAyEvC,IAAIlB,EAGJnC,QAAOmB,qBAAuB,SAASiC,GACnCZ,EAAW,WACPW,YAAY,SAAS/B,EAAOC,EAAUC,GAClC8B,EAAShC,EAAOE,EAAmBE,gBAwBlD,SAASwC,GAAG,YAAa,SAASC,GAAED,EAAEC,GAAG,GAAIC,IAAG,MAAMF,IAAI,MAAMC,EAA6B,QAAvBD,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAc,GAAG,MAAMA,EAAE,QAASA,GAAEF,EAAEC,GAAG,MAAOD,IAAGC,EAAED,IAAI,GAAGC,EAAE,QAASE,GAAEH,EAAEG,EAAEC,EAAEC,EAAEC,EAAEC,GAAG,MAAON,GAAEC,EAAED,EAAEA,EAAEE,EAAEH,GAAGC,EAAEI,EAAEE,IAAID,GAAGF,GAAG,QAASA,GAAEJ,EAAEC,EAAEC,EAAEE,EAAEC,EAAEC,EAAEC,GAAG,MAAOJ,GAAEF,EAAEC,GAAGD,EAAEG,EAAEJ,EAAEC,EAAEI,EAAEC,EAAEC,GAAG,QAASF,GAAEL,EAAEC,EAAEC,EAAEE,EAAEC,EAAEC,EAAEC,GAAG,MAAOJ,GAAEF,EAAEG,EAAEF,GAAGE,EAAEJ,EAAEC,EAAEI,EAAEC,EAAEC,GAAG,QAASD,GAAEN,EAAEC,EAAEC,EAAEE,EAAEC,EAAEC,EAAEC,GAAG,MAAOJ,GAAEF,EAAEC,EAAEE,EAAEJ,EAAEC,EAAEI,EAAEC,EAAEC,GAAG,QAASA,GAAEP,EAAEC,EAAEC,EAAEE,EAAEC,EAAEC,EAAEC,GAAG,MAAOJ,GAAED,GAAGD,GAAGG,GAAGJ,EAAEC,EAAEI,EAAEC,EAAEC,GAAG,QAAS1D,GAAEmD,EAAEE,GAAGF,EAAEE,GAAG,IAAI,KAAKA,EAAE,GAAGF,EAAgB,IAAbE,EAAE,KAAK,GAAG,IAAOA,CAAE,IAAIC,GAAEtD,EAAE2D,EAAEC,EAAEC,EAAEC,EAAE,WAAWC,GAAG,UAAUC,GAAG,WAAWC,EAAE,SAAU,KAAIX,EAAE,EAAEA,EAAEH,EAAErD,OAAOwD,GAAG,GAAGtD,EAAE8D,EAAEH,EAAEI,EAAEH,EAAEI,EAAEH,EAAEI,EAAEH,EAAEP,EAAEO,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,GAAG,GAAG,WAAWW,EAAEV,EAAEU,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,IAAI,WAAWU,EAAET,EAAES,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,GAAG,WAAWS,EAAER,EAAEQ,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,YAAYQ,EAAEP,EAAEO,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,WAAWW,EAAEV,EAAEU,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,GAAG,YAAYU,EAAET,EAAES,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,IAAI,YAAYS,EAAER,EAAEQ,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,UAAUQ,EAAEP,EAAEO,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,EAAE,YAAYW,EAAEV,EAAEU,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,IAAI,YAAYU,EAAET,EAAES,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,IAAI,OAAOS,EAAER,EAAEQ,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,IAAI,IAAI,YAAYQ,EAAEP,EAAEO,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,IAAI,EAAE,YAAYW,EAAEV,EAAEU,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,IAAI,IAAI,UAAUU,EAAET,EAAES,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,IAAI,YAAYS,EAAER,EAAEQ,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,IAAI,GAAG,YAAYQ,EAAEN,EAAEM,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,WAAWW,EAAET,EAAES,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,GAAG,YAAYU,EAAER,EAAEQ,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,GAAG,WAAWS,EAAEP,EAAEO,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,GAAG,IAAI,WAAWQ,EAAEN,EAAEM,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,WAAWW,EAAET,EAAES,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,IAAI,EAAE,UAAUU,EAAER,EAAEQ,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,IAAI,WAAWS,EAAEP,EAAEO,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,WAAWQ,EAAEN,EAAEM,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,EAAE,WAAWW,EAAET,EAAES,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,IAAI,GAAG,YAAYU,EAAER,EAAEQ,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,IAAI,WAAWS,EAAEP,EAAEO,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,GAAG,YAAYQ,EAAEN,EAAEM,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,IAAI,GAAG,YAAYW,EAAET,EAAES,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,GAAG,UAAUU,EAAER,EAAEQ,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,GAAG,YAAYS,EAAEP,EAAEO,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,IAAI,IAAI,YAAYQ,EAAEL,EAAEK,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,QAAQW,EAAER,EAAEQ,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,IAAI,YAAYU,EAAEP,EAAEO,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,GAAG,YAAYS,EAAEN,EAAEM,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,IAAI,IAAI,UAAUQ,EAAEL,EAAEK,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,YAAYW,EAAER,EAAEQ,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,GAAG,YAAYU,EAAEP,EAAEO,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,IAAI,WAAWS,EAAEN,EAAEM,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,IAAI,IAAI,YAAYQ,EAAEL,EAAEK,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,IAAI,EAAE,WAAWW,EAAER,EAAEQ,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,GAAG,IAAI,WAAWU,EAAEP,EAAEO,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,IAAI,WAAWS,EAAEN,EAAEM,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,GAAG,UAAUQ,EAAEL,EAAEK,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,WAAWW,EAAER,EAAEQ,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,IAAI,IAAI,WAAWU,EAAEP,EAAEO,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,GAAG,WAAWS,EAAEN,EAAEM,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,WAAWQ,EAAEJ,EAAEI,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,GAAG,GAAG,WAAWW,EAAEP,EAAEO,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,GAAG,YAAYU,EAAEN,EAAEM,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,IAAI,YAAYS,EAAEL,EAAEK,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,UAAUQ,EAAEJ,EAAEI,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,IAAI,EAAE,YAAYW,EAAEP,EAAEO,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,GAAG,IAAI,YAAYU,EAAEN,EAAEM,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,IAAI,IAAI,SAASS,EAAEL,EAAEK,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,YAAYQ,EAAEJ,EAAEI,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,EAAE,YAAYW,EAAEP,EAAEO,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,IAAI,IAAI,UAAUU,EAAEN,EAAEM,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,IAAI,YAAYS,EAAEL,EAAEK,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,IAAI,GAAG,YAAYQ,EAAEJ,EAAEI,EAAEC,EAAEC,EAAEC,EAAEd,EAAEG,EAAE,GAAG,GAAG,WAAWW,EAAEP,EAAEO,EAAEH,EAAEC,EAAEC,EAAEb,EAAEG,EAAE,IAAI,IAAI,YAAYU,EAAEN,EAAEM,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEG,EAAE,GAAG,GAAG,WAAWS,EAAEL,EAAEK,EAAEC,EAAEC,EAAEH,EAAEX,EAAEG,EAAE,GAAG,IAAI,WAAWQ,EAAEV,EAAEU,EAAE9D,GAAG+D,EAAEX,EAAEW,EAAEJ,GAAGK,EAAEZ,EAAEY,EAAEJ,GAAGK,EAAEb,EAAEa,EAAEJ,EAAG,QAAOC,EAAEC,EAAEC,EAAEC,GAAG,QAASN,GAAER,GAAG,GAAIC,GAAEC,EAAE,EAAG,KAAID,EAAE,EAAEA,EAAE,GAAGD,EAAErD,OAAOsD,GAAG,EAAEC,GAAGa,OAAOC,aAAahB,EAAEC,GAAG,KAAKA,EAAE,GAAG,IAAK,OAAOC,GAAE,QAASO,GAAET,GAAG,GAAIC,GAAEC,IAAK,KAAIA,GAAGF,EAAErD,QAAQ,GAAG,OAAG,GAAOsD,EAAE,EAAEA,EAAEC,EAAEvD,OAAOsD,GAAG,EAAEC,EAAED,GAAG,CAAE,KAAIA,EAAE,EAAEA,EAAE,EAAED,EAAErD,OAAOsD,GAAG,EAAEC,EAAED,GAAG,KAAK,IAAID,EAAEiB,WAAWhB,EAAE,KAAKA,EAAE,EAAG,OAAOC,GAAE,QAASQ,GAAEV,GAAG,MAAOQ,GAAE3D,EAAE4D,EAAET,GAAG,EAAEA,EAAErD,SAAS,QAASgE,GAAEX,EAAEC,GAAG,GAAIC,GAAEC,EAAEC,EAAEK,EAAET,GAAGK,KAAKC,IAAK,KAAID,EAAE,IAAIC,EAAE,QAAI,GAAOF,EAAEzD,OAAO,KAAKyD,EAAEvD,EAAEuD,EAAE,EAAEJ,EAAErD,SAASuD,EAAE,EAAE,GAAGA,EAAEA,GAAG,EAAEG,EAAEH,GAAG,UAAUE,EAAEF,GAAGI,EAAEJ,GAAG,WAAWE,EAAEF,EAAG,OAAOC,GAAEtD,EAAEwD,EAAEa,OAAOT,EAAER,IAAI,IAAI,EAAEA,EAAEtD,QAAQ6D,EAAE3D,EAAEyD,EAAEY,OAAOf,GAAG,MAAM,QAASS,GAAEZ,GAAG,GAAIC,GAAEC,EAAEC,EAAE,mBAAmBC,EAAE,EAAG,KAAIF,EAAE,EAAEA,EAAEF,EAAErD,OAAOuD,GAAG,EAAED,EAAED,EAAEiB,WAAWf,GAAGE,GAAGD,EAAEgB,OAAOlB,IAAI,EAAE,IAAIE,EAAEgB,OAAO,GAAGlB,EAAG,OAAOG,GAAE,QAASS,GAAEb,GAAG,MAAOoB,UAASC,mBAAmBrB,IAAI,QAASc,GAAEd,GAAG,MAAOU,GAAEG,EAAEb,IAAI,QAASsB,GAAEtB,GAAG,MAAOY,GAAEE,EAAEd,IAAI,QAASuB,GAAEvB,EAAEC,GAAG,MAAOU,GAAEE,EAAEb,GAAGa,EAAEZ,IAAI,QAASuB,GAAExB,EAAEC,GAAG,MAAOW,GAAEW,EAAEvB,EAAEC,IAAI,QAASwB,GAAEzB,EAAEC,EAAEC,GAAG,MAAOD,GAAEC,EAAEqB,EAAEtB,EAAED,GAAGwB,EAAEvB,EAAED,GAAGE,EAAEY,EAAEd,GAAGsB,EAAEtB,GAAG,kBAAmB0B,SAAQA,OAAOC,IAAID,OAAO,WAAW,MAAOD,KAAIzB,EAAE4B,IAAIH,GAAG1F,MAkG7rH,WACE,YAEA,IAAI8F,GAAWC,QAAQC,OAAO,YAC5B,QACA,UACA,mBACA,kBACA,eACA,YACA,YACA,aACA,SACA,YACA,WACA,iBACA,cACA,eACA,qBACA,yBACA,yBAGFF,GAASG,SAAS,mBAChBC,YACMC,GAAI,KAAMC,KAAM,YAChBD,GAAI,KAAMC,KAAM,aAChBD,GAAI,KAAMC,KAAM,aAChBD,GAAI,KAAMC,KAAM,YAChBD,GAAI,KAAMC,KAAM,cAChBD,GAAI,KAAMC,KAAM,WAChBD,GAAI,KAAMC,KAAM,OAChBD,GAAI,KAAMC,KAAM,YAChBD,GAAI,KAAMC,KAAM,YAChBD,GAAI,KAAMC,KAAM,UAChBD,GAAI,KAAMC,KAAM,YAChBD,GAAI,KAAMC,KAAM,cAGtBC,UACIC,GAAM,KACNC,MAAS,KACTC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,MAAS,KACTC,GAAM,KACNC,MAAS,KACT1B,GAAM,KACN2B,MAAS,KACTC,GAAM,KACNC,MAAS,KACTC,MAAS,KACTC,MAAS,QAIfpC,EAASqC,QAAQ,iBAAkB,0BAA2B,qBAAsB,kBAClF,SAASC,EAAgBC,EAAyBC,EAAoBC,GACpEH,EACAI,KAAK,KACHC,MAAO,UACPC,YAAa,8BACbC,WAAY,2BAEdH,KAAK,UACHC,MAAO,QACPC,YAAa,sBACbC,WAAY,oBAEdH,KAAK,YACHC,MAAO,UACPC,YAAa,wBACbC,WAAY,sBAEdH,KAAK,WACDC,MAAO,YACPC,YAAa,uBACbC,WAAY,qBAEhBH,KAAK,YACHC,MAAO,6BACPC,YAAa,wBACbC,WAAY,sBAEdH,KAAK,YACHC,MAAO,gBACPC,YAAa,wBACbC,WAAY,sBAEdH,KAAK,oBACHC,MAAO,GACPC,YAAa,gCACbC,WAAY,6BAEdC,WACEC,WAAY,MAGdR,EAAwBS,UACtBC,QAAS,KAGX,IAAIC,KACJjD,SAAQkD,QAAQV,EAAgBrC,UAAW,SAASgD,EAAOC,GACzDH,EAAUI,KAAKF,EAAM/C,MAGvBmC,EACCe,sBACCC,OAAQ,kBACRC,OAAQ,UAETC,8BAA8BR,EAAWT,EAAgBlC,UACzDoD,kBAAkB,MAClBC,6BACAC,iBAAiB,MACjBC,yBAAyB,SAI9B9D,EAAS+D,KAAK,aAAc,YAAa,SAAU,SAAU,QAC3D,SAASC,EAAYC,EAAWC,EAAQC,EAAQC,GAE9CJ,EAAWK,IAAK,oBAAqB,SAAS7J,EAAO8J,EAAMC,GACpDH,EAAM3G,KAAK+G,WACY,wBAArBF,EAAK1B,aAGRqB,EAAUQ,KAAK,OAKrBT,EAAWK,IAAI,sBAAuB,SAAS7J,EAAO+J,EAASG,GAC7DV,EAAWrB,MAAQ4B,EAAQI,QAAQhC,QAGrCqB,EAAWY,cAAe,EAEM,UAA5BzK,OAAO0K,SAASC,WAClBd,EAAWY,cAAe,GAI5BZ,EAAWe,YAAc,SAASpC,EAAOqC,EAASC,EAAO1H,GAC7C4G,GACRxB,MAAOA,EACPqC,QAASA,EACTE,OAAO,EACPD,MAAOA,IACNE,KAAK,SAASC,GACXnF,QAAQoF,WAAW9H,IACrBA,EAAS6H,IAEV,qBAWX,WACE,YAEuBnF,SAAQC,OAAO,oBACpC,eACA,eACA,iBACA,mBAKJ,WACE,YAEAD,SACCC,OAAO,oBACP2C,WAAW,0BAA2B,SAAU,aAAc,YAAa,WAAY,UAAW,eAAgB,SAAU,QAC3H,SAASyC,EAAQtB,EAAYC,EAAWsB,EAAUC,EAASC,EAActB,EAAQC,GAC/EsB,QAAQC,MAAM,qCAEdL,EAAOM,oBAAsBH,EAAaG,oBAC1CN,EAAON,QAAU,GACjBM,EAAOO,gBAAiB,EACxBP,EAAOQ,SAEP,IAAI/C,GAAa,SAASgD,EAAMC,GAC3BA,GACc,mBAAZA,IACDD,EAAOC,GAIX/B,EAAUQ,KAAKsB,IAGbE,EAAqB,SAASC,EAAkBC,EAAQC,EAASJ,EAAUK,EAAMC,EAAWtB,GAI9F,GAHAM,EAAOM,oBAAsBH,EAAac,UAAUL,GACpDZ,EAAON,QAAUA,EAEdsB,GAAuB,SAAVH,EAAmB,CAEjC,GADAb,EAAOQ,OAAOxC,KAAK0B,IACfqB,EAEF,WADAtD,GAAW,GAAIiD,EAGfhB,IAAoB,cAGlBwB,QAAQxB,KACVM,EAAOO,gBAAiB,GAI5B,IAAGP,EAAOO,eAMV,MAFAP,GAAON,QAAUS,EAAagB,mBAAmBP,EAAiB,IAE3D,EAGTlC,GAAWK,IAAI,gBAAiB,SAASqC,EAAIR,EAAkBC,EAAQC,EAASJ,EAAUK,EAAMC,EAAWtB,GACzGO,EAAS,WACP,GAAGa,EASD,WARAA,GAAQjB,KAAK,SAASwB,GACpB3B,EAAU2B,EAAkB,QAC5BR,EAASQ,EAAiB,OACvBV,EAAmBC,EAAkBC,EAAQC,EAASJ,EAAUK,EAAMC,EAAWtB,IAClFS,EAAanB,QAOf2B,GAAmBC,EAAkBC,EAAQC,EAASJ,EAAUK,EAAMC,EAAWtB,IAIrFS,EAAanB,QACZ,OAGLN,EAAWK,IAAI,oBAAqB,SAASqC,EAAIR,GAC/CZ,EAAON,QAAU,WACdZ,EAAM3G,KAAK+G,UAKVP,EAAUQ,KAAK,aAGjB1B,EAAW,UACXkB,EAAUQ,KAAK,aAInBgB,EAAanB,aAMnB,WACE,YAEArE,SACGC,OAAO,oBACP2C,WAAW,4BAA6B,SAAU,QACjD,YAAa,QAAS,UAAW,aACjC,SAASyC,EAAQsB,EAAO3C,EAAWG,EAAOoB,EAASqB,GACjDnB,QAAQC,MAAM,6CAOtB,WACE,YAEA1F,SACCC,OAAO,oBACP2C,WAAW,kBAAmB,SAAU,aAAc,QACrD,YAAa,gBAAiB,WAAY,QAAS,SAAU,aAC7D,SAASyC,EAAQtB,EAAY4C,EAAO3C,EAAW6C,EAAevB,EAC5DnB,EAAOD,EAAQ4C,GAGf,QAASC,KAEP,GAAIC,GAAMpK,SAASqK,cAAc,iBACjCD,GAAIE,UAAYF,EAAIG,aAQtB,QAASC,KACP/B,EAAOgC,WACPhC,EAAOiC,YACPjC,EAAON,QAAUwC,EA8CnB,QAASC,GAAeC,GAEtB,IAAK,GADDC,GAAcvD,EAAM3G,KAAKmK,gBACpB5M,EAAI,EAAGA,EAAI2M,EAAY7M,OAAQE,IACtC,GAAI2M,EAAY3M,GAAGsF,OAASoH,EAC1B,MAAOC,GAAY3M,GAAG6M,OAM5B,QAASC,GAAkBC,GACzBzC,EAAOgC,QAAQnE,QAAQ,SAAS6E,GAC9B,GAAIC,GAAQD,EAAO7B,OAAOxK,MAAMuM,aAChCxC,SAAQC,MAAM,mBAAqBsC,GAC/BA,GAASF,IAAyC,IAA7BA,EAAS7J,QAAQ+J,IACtCA,IACFvC,QAAQC,MAAM,mBAAqBsC,EAAQ,WAAaD,EAAO3H,GAAK,KACpEiF,EAAO6C,UAAUH,EAAO3H,GAAI4H,MAKlC,QAASG,GAAiBC,GACxB,GAAIC,IAAQ,CACZ,KAAK,GAAIC,KAAOjD,GAAOgC,QAAS,CAE9B,GADahC,EAAOgC,QAAQiB,GACjBF,MAAQA,EAAM,CACvBC,GAAQ,CACR,QAGJ,MAAIA,GACKC,GAEC,EAIZ,QAASC,GAAgBR,GACvB,OACEK,KAAQL,EAAO,GACf3H,GAAM2H,EAAO,GAAG,GAChBS,OAAUT,EAAO,GAAG,GACpB1H,KAAQ0H,EAAO,GAAG,GAClBU,MAASV,EAAO,GAAG,GACnB7B,OAAUwC,KAAKC,MAAMZ,EAAO,GAAG,IAC/Ba,MAASb,EAAO,GAAG,GAAGa,OAI1B,QAASC,GAAUd,GACjB1C,EAAOgC,QAAQhE,KAAKkF,EAAgBR,IAqOtC,QAASe,GAAYC,EAAMC,GACzB9E,GACExB,MAAOqG,EACP9D,OAAO,EACPD,MAAO,GACP7B,MAAO,KACN+B,KAAK,SAAS+D,GACXA,GAAOD,GACTA,EAAGC,KA9VTxD,QAAQC,MAAM,4BAWd,IAAI6B,GAAgB,EAOpBH,KAEA/B,EAAO6D,OAAO,aAAc,WACD,QAArB7D,EAAO8D,aACTpF,EAAWqF,aAAe,GAE5BrF,EAAWoF,WAAa9D,EAAO8D,aAGjCpF,EAAWK,IAAI,kBAAmB,SAAS7J,EAAOiD,GAChDA,EAAK6L,WAAa,GAAIC,MACtB7D,QAAQ8D,IAAI,kBAAmB/L,GAC/B6H,EAAOmE,OAAO,WACZnE,EAAOiC,SAASjE,KAAK7F,GACjBA,EAAKiM,MAAQtF,EAAM3G,KAAK6C,MACtBgF,EAAOqE,YAAmC,QAArBrE,EAAO8D,cAC9BpF,EAAWqF,aAEf9D,EAAS,WACPyB,KACC,SAIPhD,EAAWK,IAAI,kBAAmB,SAAS7J,EAAOiD,GAChD8H,EAAS,WACPD,EAAOsE,KAAOxF,EAAM3G,KAAKmM,KAAKC,OAAOC,WAIzC9F,EAAWK,IAAI,qBAAsB,SAAS7J,EAAOkN,GACnDpC,EAAOyE,OAAStC,EAAeC,GAK/BI,EAAkBxC,EAAOyE,UAG3B/F,EAAWK,IAAI,wBAAyB,SAAS7J,EAAOiD,GACtD6H,EAAO0E,cAAgBvM,EAAK,GAAGwM,WAC/B3E,EAAOyE,OAAStC,EAAenC,EAAO0E,iBAyDxChG,EAAWK,IAAI,aAAc,WAC3BiB,EAAO4E,OAAS,OAGlBlG,EAAWK,IAAI,eAAgB,SAAS7J,EAAO8M,GAC7ChC,EAAOmE,OAAO,WACZpC,GACA,KAAK,GAAIkB,KAAOjB,GAAS,CAEvBwB,EADaxB,EAAQiB,SAM3BvE,EAAWK,IAAI,cAAe,SAAS7J,EAAOwN,GAC5C1C,EAAOmE,OAAO,WACZX,EAAUd,OAIdhE,EAAWK,IAAI,cAAe,SAAS7J,EAAO6N,GACxCrE,EAAWmG,SAAWnG,EAAWoG,SAAW/B,IAC9CjE,EAAMiG,SACNlQ,OAAOmQ,SAGThF,EAAOmE,OAAO,WACZ,GAAIc,GAAYnC,EAAiBC,IACf,GAAdkC,GAEFjF,EAAOgC,QAAQkD,OAAOD,EAAW,OAKvCvG,EAAWK,IAAI,iBAAkB,SAAS7J,EAAOwN,GAC/CA,EAASQ,EAAgBR,EACzB,IAAIuC,GAAYnC,EAAiBJ,EAAOK,KACpCkC,GAAY,EACd7E,QAAQ8D,IAAI,+BAAkCxB,EAAOK,MAErD/C,EAAOmE,OAAO,WAIRgB,SAASzC,EAAO3H,KAAOoK,SAASrG,EAAM3G,KAAKiN,sBAC7CtG,EAAM3G,KAAKkN,SAAW3C,EAAO7B,OAAOzK,MAAMkP,MAC1CxG,EAAM3G,KAAKoN,WAAa7C,EAAO7B,OAAOxK,MAAMiP,MACrDxG,EAAM3G,KAAKqN,KAAKC,QAAQ/C,EAAO7B,OAAOzK,MAAMkP,MAAQ,MAAQ,MAC5DxG,EAAM3G,KAAKqN,KAAKE,aAAahD,EAAO7B,OAAOxK,MAAMiP,MAAQ,MAAQ,OAE1D3K,QAAQgL,OAAO3F,EAAOgC,QAAQiD,GAAYvC,OAKhDhE,EAAWK,IAAI,gBAAiB,SAAS7J,GACvC8K,EAAO4F,YAAY,WACjB7D,IACA/B,EAAO6F,gBAQX7F,EAAO8F,cAAgB,SAASC,GACH,aAAvBjH,EAAM3G,KAAK6N,WACfhG,EAAO4E,OAAS5E,EAAO4E,QAAUmB,EAAQ,KAAOA,IAGlD/F,EAAOiG,KAAO,SAAS/Q,GAIjBA,GAAuB,WAAdA,EAAMgR,MACjBhR,EAAMiR,iBAERrH,EAAMsH,mBAAmBpG,EAAON,SAChCM,EAAON,QAAUwC,GAInBlC,EAAOqG,SAAW,SAASC,GACzBlG,QAAQ8D,IAAI,mBACZpF,EAAM3G,KAAKmM,KAAKiC,KAAKD,IAGvBtG,EAAOwG,YAAc,SAASF,GACF,aAAvBxH,EAAM3G,KAAK6N,WACZ5F,QAAQ8D,IAAI,sBACZpF,EAAM3G,KAAKmM,KAAKmC,QAAQH,KAI5BtG,EAAO0G,cAAgB,SAASJ,GACJ,aAAvBxH,EAAM3G,KAAK6N,WACZ5F,QAAQ8D,IAAI,wBACZpF,EAAM3G,KAAKmM,KAAKqC,UAAUL,KAI9BtG,EAAO4G,cAAgB,SAASN,GAC9BlG,QAAQ8D,IAAI,wBACZpF,EAAM3G,KAAKmM,KAAKuC,UAAUP,IAG5BtG,EAAO6C,UAAY,SAASyD,EAAU3D,GACpCvC,QAAQ8D,IAAI,MAAOoC,EAAU,KAAM3D,GACnC7D,EAAMgI,iBAAiBR,EAAU3D,IAGnC3C,EAAO+G,eAAiB,SAAST,GAC/BlG,QAAQ8D,IAAI,yBACZpF,EAAM3G,KAAKmM,KAAK0C,WAAWV,IAG7BtG,EAAOiH,WAAa,SAASX,GAC3BlG,QAAQ8D,IAAI,qBAEZrF,GACExB,MAAOoE,EAAWyF,QAAQ,uBAC1BtH,OAAO,EACPD,MAAO,GACP7B,MAAO,KACN+B,KAAK,SAAS6D,GACXA,GACF5E,EAAM3G,KAAKmM,KAAK6C,OAAOb,EAAU5C,MAKvC1D,EAAOoH,aAAe,SAASd,EAAUe,GACvC,GAAIA,EAEF,WADAvI,GAAMwI,YAAYhB,EAAUe,EAI9B5D,GAAYhC,EAAWyF,QAAQ,0BAA2B,SAASG,GACjEjH,QAAQ8D,IAAIoC,EAAUe,GACtBvI,EAAMwI,YAAYhB,EAAUe,MAKhCrH,EAAOuH,cAAgB,SAASjB,EAAUe,GACxC,GAAIA,EAEF,WADAvI,GAAM0I,aAAalB,EAAUe,EAI/B5D,GAAYhC,EAAWyF,QAAQ,0BAA2B,SAASG,GACjEvI,EAAM0I,aAAalB,EAAUe,MAIjCrH,EAAOyH,UAAY,SAASnB,EAAUe,GACpC,GAAIA,EAEF,WADAvI,GAAM4I,SAASpB,EAAUe,EAI3B5D,GAAYhC,EAAWyF,QAAQ,sBAAuB,SAASG,GAC7DvI,EAAM4I,SAASpB,EAAUe,MAI7BrH,EAAO2H,gBAAkB,SAASrB,GAChClG,QAAQ8D,IAAI,0BAEZpF,EAAM3G,KAAKmM,KAAK6C,OAAOb,EADZ,UAIbtG,EAAO4H,eAAiB,SAAStB,GAC/BlG,QAAQ8D,IAAI,yBACZpF,EAAM3G,KAAKmM,KAAKuD,WAAWvB,IAG7BtG,EAAO8H,aAAe,SAASxB,GAC7BlG,QAAQ8D,IAAI,uBACZpF,EAAM3G,KAAKmM,KAAKyD,SAASzB,IAG3BtG,EAAOgI,aAAe,SAAS1B,GAC7BlG,QAAQ8D,IAAI,uBACZpF,EAAM3G,KAAKmM,KAAK2D,SAAS3B,IAG3BtG,EAAOkI,WAAa,SAAS5B,GAC3BlG,QAAQ8D,IAAI,qBACZpF,EAAM3G,KAAKmM,KAAK6D,OAAO7B,IAGzBtG,EAAOoI,aAAe,SAAS9B,GAC7BlG,QAAQ8D,IAAI,uBACZxF,EAAW2J,uBACXxJ,GACExB,MAAOoE,EAAWyF,QAAQ,kBAC1BxH,QAAS+B,EAAWyF,QAAQ,oBAC5BtH,OAAO,EACPD,MAAO8B,EAAWyF,QAAQ,kBAC1BpJ,MAAO,KACN+B,KAAK,SAASyI,GACf5J,EAAW6J,sBACPD,GACFxJ,EAAM3G,KAAKmM,KAAKkE,SAASlC,EAAUgC,KAEpCG,MAAM,WACP/J,EAAW6J,yBAKfvI,EAAO0I,eAAiB,SAAShG,GACL,aAAvB5D,EAAM3G,KAAK6N,WACZ5F,QAAQ8D,IAAI,yBAERxB,EAAO7B,OAAOzK,MAAMuS,KACtB7J,EAAM3G,KAAKmM,KAAKsE,OAAOlG,EAAO3H,IAE9B+D,EAAM3G,KAAKmM,KAAKqE,KAAKjG,EAAO3H,YAsBxC,WACE,YAEAJ,SACGC,OAAO,oBACP2C,WAAW,0BAA2B,SAAU,QAC/C,SACA,SAASyC,EAAQsB,EAAO1C,GACtB,GAAIiK,GAAMhU,OAAO0K,SAASuJ,OAASjU,OAAO0K,SAASwJ,QACnDzH,GAAM0H,IAAIH,EAAM,oBACbI,QAAQ,SAAS9Q,GAEhB,GAAI+Q,KAEJvO,SAAQkD,QAAQ1F,EAAM,SAAS2F,EAAOC,GACpC,GAAIoL,GAAK,cACLnO,EAAO8C,EAAMsL,QAAQD,EAAI,MACzB5F,EAAQzF,EAAMsL,QAAQD,EAAI,KAE9BvU,MAAKoJ,MACHhD,KAAQA,EACRuI,MAASA,KAEV2F,GAEHlJ,EAAOkJ,aAAeA,IAEvBjT,MAAM,WACL2I,EAAO3I,MAAM,mCAMzB,WACE,YAEA0E,SACGC,OAAO,oBACP2C,WAAW,mBAAoB,SAAU,QACxC,SACA,SAASyC,EAAQsB,EAAO1C,GAElBoB,EAAOqJ,QADA,mBAgBnB,WACE,YAEA1O,SACGC,OAAO,oBACP2C,WAAW,qBAAsB,aAAc,SAC9C,QAAS,YAAa,SAAU,QAAS,UAAW,cAAe,aAAc,WACjF,SAASmB,EAAYsB,EAAQsB,EAAO3C,EAAWC,EAAQE,EAAOoB,EAASoJ,EAAaC,EAAYtJ,GAiE9F,QAASuF,GAAKgE,GAIZ,MAHAtJ,GAAQ/H,KAAKsR,QAAS,EACtBvJ,EAAQ/H,KAAKuR,SAAW,EACxBhL,EAAWiL,cAAgBH,GACtB9K,EAAWiL,eAAiBzJ,EAAQ/H,KAAKyR,eAC5ClL,EAAWiL,cAAgBzJ,EAAQ/H,KAAKyR,eACjC,GACGlL,EAAWiL,eAAkBzJ,EAAQ/H,KAAKyR,cAKlD9K,EAAM3G,KAAKqN,MACbpF,QAAQC,MAAM,mCACP,IAG6B,GAAlCmJ,EAAU5Q,QAAQ,aACpB8F,EAAWmG,SAAU,EACrB/F,EAAM0G,KAAK9G,EAAWiL,cAAe,MAEjCE,UAAW,OACXC,OAAQ,OACRC,SAAU,OACVC,eAAgB,KAChBC,iBACAC,iBAAkB,KAClBC,aAAa,QAGjBxL,GAAUQ,KAAK,aAIjBe,EAAQ/H,KAAKoN,YAAa,EAC1BrF,EAAQ/H,KAAKkN,UAAW,EAExBnF,EAAQ/H,KAAKiS,WAAY,EACzBtL,EAAM0G,KAAK9G,EAAWiL,eAEtBzJ,EAAQ/H,KAAKyR,cAAgBlL,EAAWiL,cACxCL,EAAYe,IAAI3L,EAAWiL,cAAe,gBAC1ChL,GAAUQ,KAAK,aAlCbP,EAAO0L,QAAQ,gCACR,GAzEXlK,QAAQC,MAAM,gCAEdkJ,EAAWgB,UAEP5L,EAAU6L,SAASC,WACnB/L,EAAWiL,cAAgBhL,EAAU6L,SAASC,eACvC9L,GAAU6L,SAASC,SAC1BjF,EAAK9G,EAAWiL,eACbjL,EAAWmG,WAKlB7E,EAAO0K,aAAepB,EAAYqB,MAClC3K,EAAO4K,gBAAkBtB,EAAYuB,cACrC7K,EAAO8K,YAAcC,OAAOC,KAAKhL,EAAO0K,cAAclV,OACtD0K,EAAQ/H,KAAKiS,WAAY,EACzBlK,EAAQ/H,KAAK8S,WAAa,aAC1B/K,EAAQ/H,KAAK+S,SAAU,EAEvBlL,EAAOmL,iBAAmB,WAKxB,MAJA7B,GAAY8B,QACZpL,EAAO0K,aAAepB,EAAYqB,MAClC3K,EAAO4K,gBAAkBtB,EAAYuB,cACrC7K,EAAO8K,YAAcC,OAAOC,KAAKhL,EAAO0K,cAAclV,OAC/CwK,EAAO4K,iBAGhB5K,EAAOqL,cAAgB,SAASC,GAC9B,MAAOtL,GAAOuL,UAAYD,GAUxB,YAAcxM,GAAM3G,OACtBuG,EAAWiL,cAAgB7K,EAAM3G,KAAKsS,eACtC3L,GAAM3G,KAAKsS,SACXjF,EAAK9G,EAAWiL,gBAOlB3J,EAAOwL,kBAAoB,SAASrI,GAClCzE,EAAWiL,cAAgBxG,GAG7BnD,EAAOyL,QAAU,WACf9M,EAAUQ,KAAK,aAGjBT,EAAW8J,SAAW,WACpB,IAAK9J,EAAWiL,cACd,OAAO,CAET7K,GAAM3G,KAAKqN,KAAKgD,SAAS9J,EAAWiL,gBAmDtC3J,EAAO0L,SAAU,EACjB1L,EAAO2L,WAAY,EACnBjN,EAAW8G,KAAO,SAASgE,GACzB,IAAKtJ,EAAQ/H,KAAKyT,gBAAkBlN,EAAWiL,cAC7C,MAAOnE,GAAKgE,EAEdxJ,GAAO0L,SAAU,EAEjB5M,EAAM+M,UAAU,WACd,GAAI7L,EAAO2L,UAGT,MAFA3L,GAAO2L,WAAY,OACnB3L,EAAO0L,SAAU,EAGjBlG,GAAKgE,MAKX9K,EAAWoN,OAAS,WAClB9L,EAAO2L,WAAY,UAO7B,WACE,YAEAhR,SACGC,OAAO,oBACP2C,WAAW,oBAAqB,aAAc,SAC7C,QAAS,YAAa,SAAU,WAAY,SAAU,QAAS,UAAW,SAAU,aAAc,aAClG,SAASmB,EAAYsB,EAAQsB,EAAO3C,EAAWoN,EAAQ9L,EAAUrB,EAC/DE,EAAOoB,EAASrB,EAAQ0C,EAAYE,GA8GpC,QAASuK,KACPhM,EAAOsE,KAAOxF,EAAM3G,KAAKmM,KAAKC,OAAOC,OACrCxE,EAAOiM,WAAclR,GAAI,EAAGC,KAAM,gBAClC,KAAK,GAAItF,GAAI,EAAGA,EAAIsK,EAAOsE,KAAK4H,YAAaxW,IAC3CsK,EAAOiM,SAASjO,MAAOjD,GAAIrF,EAAE,EAAGsF,KAAM,WAAatF,EAAE,KAhHzD0K,QAAQC,MAAM,+BACdL,EAAOoC,OAAS,KAChB1D,EAAWiL,cAAgB,GAC3B3J,EAAOmM,aAAe,2BACtBnM,EAAOoM,gBAAkB,GACzBpM,EAAOqM,QAAS,EAEZnM,EAAQ/H,KAAKiS,YACfpK,EAAOmM,aAAe,4BAGxBzN,EAAWK,IAAI,kBAAmB,SAAS7J,EAAOiD,GAChD8H,EAAS,WACJD,EAAOqE,YACRrE,EAAOsM,WAETN,QAIJtN,EAAWK,IAAI,aAAc,SAAS7J,EAAOiD,GAC3C8H,EAAS,WACPD,EAAOmM,aAAe,+BAO1BnM,EAAOuM,cAAgB,WACrBvM,EAAOwM,UAAU,+BACf,2BAcJxM,EAAOoK,UAAY,WACjBvL,GACExB,MAAOoE,EAAWyF,QAAQ,sBAC1BxH,QAAS+B,EAAWyF,QAAQ,0BAC3BrH,KAAK,WACNK,EAAQ/H,KAAKiS,WAAY,EACzBpK,EAAOmM,aAAe,8BAI1BnM,EAAOyM,YAAc,SAASvX,EAAOiD,GACnC+H,EAAQ/H,KAAKoN,YAAcrF,EAAQ/H,KAAKoN,YAG1CvF,EAAO0M,UAAY,SAASxX,EAAOiD,GACjC+H,EAAQ/H,KAAKkN,UAAYnF,EAAQ/H,KAAKkN,UAGxCrF,EAAO2M,sBAAwB,SAASvK,EAAQiF,GAC9CvI,EAAM3G,KAAKmM,KAAKsI,eAAexK,EAAQiF,GACvCrH,EAAO6M,YAAczK,EACrB1D,EAAWoO,MAAM,qBAAsB1K,IAGzCpC,EAAO+M,kBAAoB,SAASC,GAClC9M,EAAQ/H,KAAK8U,gBAAkBD,EAC/BtO,EAAWoO,MAAM,iBAAkBE,IAGrChN,EAAOkN,UAAY,SAASC,GAC1B,GACI9S,IADQ9C,SAAS6V,eAAe,UAC5BvY,OAAO0K,SAAS8N,MACpBC,EAAUxO,EAAM3G,KAAKqN,KAAK+H,OAC1B/D,EAAY1K,EAAM3G,KAAKqN,KAAKjB,OAAOiJ,wBACnC9W,EAAQ+W,OAAOC,YACf9W,EAAS6W,OAAOE,aAAe,IAC/BxY,GAAKsB,OAAOC,MAAQA,GAAO,EAC3BkX,GAAKnX,OAAOG,OAASA,GAAQ,CAEjCyD,GAAIA,EAAE+O,QAAQ,OAAQ,IACtB/O,GAAK,2BAA6BiT,EAAU,2BAA6B9D,EAAW,cAAgB2D,EAEpG/M,QAAQ8D,IAAI,yBAA2B7J,GAC3BxF,OAAOgZ,KAAKxT,EAAG,iBAAmB8S,EAAW,sDAAwDzW,EAAQ,WAAaE,EAAQ,IAAazB,EAAI,QAAUyY,GACnKE,OAAO3Y,EAAGyY,IAGlB5N,EAAO+N,YAAc,WACnB,GAAGjP,EAAM3G,KAAK6V,UAEZ,MADAlP,GAAMmP,qBACC,CAELnP,GAAM3G,KAAKmM,MACblE,QAAQ8D,IAAI,iCAAkCpF,EAAM3G,KAAKmM,MAGzDxF,EAAMiP,YAAYjP,EAAM3G,KAAKmM,KAAKC,OAAOC,OAAO0J,SAGhDpP,EAAMiP,YAAY7N,EAAQ/H,KAAKyR,gBAYnC5J,EAAOyG,QAAU3H,EAAM2H,QACvBzG,EAAO2G,UAAY7H,EAAM6H,UAEzBjI,EAAWK,IAAI,6BAA8B,SAAS7J,EAAOe,GAE3D,OAAOA,GACL,IAAK,oBACH2I,EAAOuP,KAAK,uDAAwD,QAAU,MAChF,KAAK,gBACHvP,EAAO0L,QAAQ,mMAAwH,WAAa8D,WAAW,GAAS,MAC1K,KAAK,qBACHxP,EAAOuP,KAAK,wDAAyD,YAM3ElO,EAAS,WACPG,QAAQ8D,IAAI,+BACZlE,EAAOqO,WAAW,gBACjB,WAMX,WACE,YAEA1T,SACGC,OAAO,oBACP2C,WAAW,mBAAoB,SAAU,QAAS,YAAa,QAC9D,SAASyC,EAAQsB,EAAO3C,EAAWG,IAClB,WACVA,EAAM3G,KAAK+G,WACZP,EAAUQ,KAAK,cAKnB,IAAInE,GAAO2D,EAAU6L,SAASxP,KAC1BuI,EAAQ5E,EAAU6L,SAASjH,MAC3B+K,EAAc3P,EAAU6L,SAAS8D,WAErC,IAAItT,GAAQuI,EAIV,MAHAzE,GAAM3G,KAAK6C,KAAOA,EAClB8D,EAAM3G,KAAKoL,MAAQA,MACnBvD,GAAOuO,OAAM,EAAMD,EAIrBxP,GAAM3G,KAAK6C,KAAOgF,EAAOE,QAAQ/H,KAAK6C,KACtC8D,EAAM3G,KAAKoL,MAAQvD,EAAOE,QAAQ/H,KAAKoL,MAEvCnD,QAAQC,MAAM,oCAOtB,WACE,YAEA1F,SACGC,OAAO,oBACP2C,WAAW,kBACT,SAAU,aAAc,YAAa,SAAU,WAAY,KAAM,QAAS,UAAW,cAAe,SAAU,aAAc,SAAU,aAAc,aAAc,UAAW,SAASyC,EAAQtB,EAAYC,EAAWoN,EAAQ9L,EAAUuO,EAAI1P,EAAOoB,EAASoJ,EAAa1K,EAAQ2C,EAAY1C,EAAQ0K,EAAY9H,EAAYgN,GAmN7T,QAASC,GAAUtN,EAAIjJ,GACrB,IAAGuG,EAAWiQ,iBAAd,CAGA,GAAIC,IACFC,SAAU,SACVC,UAAU,EAEN9O,GAAO+O,qBACTrQ,EAAWiQ,iBAAmB3O,EAAOwM,UAAU,6BAA8B,6BAA8BoC,KAIjH,QAASI,GAAU5N,EAAIjJ,GAClB+H,EAAQ/H,KAAK8W,UACdnQ,EAAM+M,YAEJnN,EAAWiQ,mBAIfjQ,EAAWiQ,iBAAiB3J,QAC5BtG,EAAWiQ,iBAAmB,MAkJhC,QAASO,KACdC,KAAKC,OAAOC,KAAKC,OAAOtG,KAAKuG,OAAQ,OAAOC,QAAQC,GAG/C,QAASA,GAAoBC,GAElC,IAAK,GADMC,GACFja,EAAE,EAAGA,EAAIga,EAAKE,OAAOpa,OAAQE,IACR,YAAxBga,EAAKE,OAAOla,GAAGwQ,OAAoByJ,EAAeD,EAAKE,OAAOla,GAAGoI,MAEvEsC,SAAQC,MAAM,kBAAoBsP,GAClCvP,QAAQC,MAAM,iBAAmBqP,EAAKG,aACtCzP,QAAQC,MAAM,aAAeqP,EAAKI,MAAMjH,KACxCzI,QAAQC,MAAMqP,GACdtP,QAAQC,MAAMvB,EAAM3G,MACpB2G,EAAM3G,KAAKoL,MAAQoM,EACnB7Q,EAAM3G,KAAK6C,KAAO0U,EAAKG,YACvB3P,EAAQ/H,KAAK6C,KAAO8D,EAAM3G,KAAK6C,KAC/BkF,EAAQ/H,KAAKoL,MAAQzE,EAAM3G,KAAKoL,MAEhCvD,EAAOuO,QAkKF,QAASwB,GAAe9G,EAAS+G,GAC3B/G,EACFrK,EAAOuP,KAAK,wCAA0C6B,EAAa,OAAQ,WAAa5B,WAAW,IAEnGxP,EAAO3I,MAAM,oDAAsD,SA4BvE,QAASga,GAAqB/a,GAC5B,GAAIgb,GAAWhb,EAAM6I,GACjBW,GAAWyR,sBAAwBD,EAASE,MAAM,4BACpD1R,EAAW2R,WAAWH,GACtBlQ,EAAO4F,eAjkBX,GAjBAxF,QAAQC,MAAM,6BACd3B,EAAW4R,aAAgBxS,MAAO,IAClCY,EAAWyR,sBAAuB,EAElCI,EAAEzR,MAAM0R,YAAc,WACpB,GAA4B,UAAxB1R,EAAM3G,KAAKsY,UACb,OAAO,GAIPvQ,EAAQ/H,KAAKuY,UAAsC,YAA1BxQ,EAAQ/H,KAAKuY,SACxCjP,EAAWkP,IAAIzQ,EAAQ/H,KAAKuY,UAE5BxQ,EAAQ/H,KAAKuY,SAAW,UAG1BhS,EAAWoG,OAASnG,EAAU6L,SAAS1F,OACJ,SAA/BnG,EAAU6L,SAAS3F,QAAoB,CACzCnG,EAAWmG,SAAU,EACrBlK,QAAQiW,QAAQrZ,SAASM,MAAMgZ,SAAS,UACxC,IAAIC,GACAtH,EAAYsH,EAAUnS,EAAU6L,SAAShB,UACzCnC,EAAW1I,EAAU6L,SAAS2C,SAE9B2D,KACEzJ,IACFyJ,GAAW,WAAazJ,GAE1B3I,EAAW8K,UAAYA,EACvB9K,EAAW2I,SAAWA,EACtB1I,EAAU6L,SAASC,SAAWqG,GAIlC,GAAIC,GAAUxZ,SAAS6V,eAAe,SACtCpN,GAAOlB,MAAQA,EACfkB,EAAOE,QAAUA,EACjBF,EAAO0K,aAAe/P,QAAQiW,QAAQ,iBAAiBI,SAAS,UAChEtS,EAAW2F,WAAa1J,QAAQiW,QAAQ,YAAYI,SAAS,WAC7DhR,EAAO+O,oBAAqB,EAI5BrQ,EAAWqF,aAAe,EAC1BrF,EAAWoF,WAAa,UAKxBpF,EAAWiL,cAAgB,GAGtB7K,EAAM3G,KAAK+G,YACdkB,QAAQC,MAAM,kEACd1B,EAAUQ,KAAK,MAGjBT,EAAWK,IAAI,sBAAuB,SAASqC,GAC7CpB,EAAOuO,OAAM,KAGf7P,EAAWK,IAAI,iBAAkB,SAAS7J,EAAO8X,GAC3ClO,EAAM3G,KAAKqN,MACb1G,EAAM3G,KAAKqN,KAAKyL,uBAAuBjE,EAAW+C,KAQtDrR,EAAW6P,MAAQ,SAAS2C,EAAU5C,OACrB6C,IAAZD,IACDA,GAAW,OAGKC,IAAf7C,IACDA,GAAc,EAGhB,IAAI8C,GAAkB,SAASC,EAAGnS,GAChCc,EAAOmE,OAAO,WACdrF,EAAM3G,KAAKmZ,YAAa,EACpBpS,IACFgB,EAAQ/H,KAAKoZ,SAAWzS,EAAM3G,KAAKoZ,SACnCrR,EAAQ/H,KAAKqZ,MAAQ1S,EAAM3G,KAAKqZ,MAChCtR,EAAQ/H,KAAKsZ,aAAe3S,EAAM3G,KAAK+G,UACvCgB,EAAQ/H,KAAKuZ,aAAe5S,EAAM3G,KAAK+G,UACvCgB,EAAQ/H,KAAK6C,KAAO8D,EAAM3G,KAAK6C,KAC/BkF,EAAQ/H,KAAKoL,MAAQzE,EAAM3G,KAAKoL,MAChCrD,EAAQ/H,KAAKoW,MAAQzP,EAAM3G,KAAKoW,MAChCrO,EAAQ/H,KAAKwZ,SAAW7S,EAAM3G,KAAKwZ,SAC/BzR,EAAQ/H,KAAK8W,UACfnQ,EAAM+M,YAGJqF,GAAYhR,EAAQ/H,KAAKsT,UAAY6C,EACvC3P,EAAUQ,KAAK,YACN+R,GACTvS,EAAUQ,KAAK,eAMrBL,GAAM3G,KAAKmZ,YAAa,EACxBxS,EAAMrK,QAAQ2c,IAOhB1S,EAAWkT,OAAS,WAClB,GAAI3c,GAAa,WACf,GAAI4c,GAAqB,SAASR,EAAGnS,GACnCkB,QAAQC,MAAM,8BACdH,EAAQ4R,QACG,mBAAT3C,QACV/O,QAAQC,MAAM8O,MACdA,KAAK4C,KAAKC,WAEFrT,EAAUQ,KAAK,UAGbL,GAAM3G,KAAKqN,MACb1G,EAAMiG,SAGR/E,EAAO6F,YACP7F,EAAO+O,oBAAqB,EAC5BjQ,EAAM7J,WAAW4c,GAEjB/S,EAAMiG,SAGJjG,GAAM3G,KAAKqN,KACb3G,GACExB,MAAOoE,EAAWyF,QAAQ,qBAC1BxH,QAAS+B,EAAWyF,QAAQ,gCAC3BrH,KAAK,WACN5K,MAGFA,KAQJ+K,EAAOiS,kBAAoB,WACzB,GAAIC,GAAgBnG,EAAO8B,MACzBsE,UAAWnS,EAAOoS,kBAClB9U,YAAa,+BACbC,WAAY,2BAGd2U,GAAcG,OAAOxS,KACnB,SAASwS,GACPjS,QAAQ8D,IAAImO,IAEd,WACEjS,QAAQ+N,KAAK,uBAAyB,GAAIlK,SAI9CiO,EAAcI,SAASzS,KACrB,WACE0S,OAAOC,SAASC,UAKtB/T,EAAW8N,UAAY,SAASlP,EAAaC,EAAYmV,GACvD,GAAI9D,IACFuD,UAAWnS,EAAOoS,kBAClB9U,YAAaA,EACbC,WAAYA,EAGd5C,SAAQgL,OAAOiJ,EAAS8D,EAExB,IAAIR,GAAgBnG,EAAO8B,KAAKe,EAiBhC,OAfAsD,GAAcG,OAAOxS,KACnB,SAASwS,GACPjS,QAAQ8D,IAAImO,IAEd,WACEjS,QAAQ+N,KAAK,uBAAyB,GAAIlK,SAI9CiO,EAAcI,SAASzS,KACrB,WACE0S,OAAOC,SAASC,SAIbP,GAGTxT,EAAWK,IAAI,WAAY2P,GAC3BhQ,EAAWK,IAAI,WAAYiQ,GAE3BtQ,EAAWiQ,iBA2BX3O,EAAO2S,UAAY,WACjB3S,EAAOwM,UAAU,sBAAuB,oBAG1CxM,EAAO4S,iBAAmB,WACxB5S,EAAOwM,UAAU,6BAA8B,2BAQjD9N,EAAWmU,KAAO,SAAS1P,GACzB/C,QAAQ8D,IAAI,OAAQf,GACpBzE,EAAWiL,cAAgBjL,EAAWiL,cAAgBxG,EAClDrE,EAAM3G,KAAKqN,MACb1G,EAAM+T,KAAK1P,IAOfzE,EAAWoU,UAAY,WACrB,GAAI3P,GAASzE,EAAWiL,cACpBoJ,EAAM5P,EAAO3N,MACjBkJ,GAAWiL,cAAgBxG,EAAO6P,UAAU,EAAGD,EAAM,IAIvD/S,EAAOiT,kBAAoB,WACpBjT,EAAO0K,cAIV/P,QAAQiW,QAAQ,iBAAiBsC,YAAY,UAC7CvY,QAAQiW,QAAQ,yBAAyBsC,YAAY,YAJrDvY,QAAQiW,QAAQ,iBAAiBC,SAAS,UAC1ClW,QAAQiW,QAAQ,yBAAyBC,SAAS,WAKpD7Q,EAAO0K,aAAe/P,QAAQiW,QAAQ,iBAAiBI,SAAS,WAGlEhR,EAAOmT,WAAa,WACdzU,EAAW2F,YAAwC,SAA1B3F,EAAWoF,aACtCpF,EAAWqF,aAAe,GAE5BpJ,QAAQiW,QAAQ,YAAYwC,YAAY,WACxC1U,EAAW2F,WAAa1J,QAAQiW,QAAQ,YAAYI,SAAS,WAC7DqC,mBAGF3U,EAAW4N,SAAW,WACpB5N,EAAW2F,YAAa,EACxB1J,QAAQiW,QAAQ,YAAYsC,YAAY,YAG1ClT,EAAO6F,UAAY,WACjBnH,EAAW2F,YAAa,EACxB1J,QAAQiW,QAAQ,YAAYC,SAAS,YAGvC7Q,EAAOsT,eAAiB,WACtB,GAAIC,GAAa5Y,QAAQiW,QAAQrZ,SAASqK,cAAc,aACxD2R,GAAWH,YAAY,WACvB1U,EAAWoO,MAAM,kBAAmByG,EAAWvC,SAAS,aAG1DhR,EAAOwT,cAAgB,WACrB,GAAID,GAAa5Y,QAAQiW,QAAQrZ,SAASqK,cAAc,aACpD2R,GAAWvC,SAAS,aACtBuC,EAAWL,YAAY,WACvBxU,EAAWoO,MAAM,kBAAmByG,EAAWvC,SAAS,cAI5DhR,EAAOyT,aAAe,WACY,cAA5BvT,EAAQ/H,KAAK8S,aAGjBvM,EAAWgV,mBAAqBnS,EAAWoS,YACvCpS,EAAWoS,YACbpS,EAAWuK,SAEXvK,EAAWqS,OAAOrc,SAASsc,qBAAqB,QAAQ,MAI5DnV,EAAWK,IAAI,aAAc,SAAS7J,GACpCgL,EAAQ/H,KAAKiS,WAAY,IAG3B1L,EAAWK,IAAI,cAAe,SAAS7J,EAAOiD,GACxCoJ,EAAWoS,aACbpS,EAAWuK,SAGRpN,EAAW2F,aACd1J,QAAQiW,QAAQ,YAAYwC,YAAY,WACxC1U,EAAW2F,WAAa1J,QAAQiW,QAAQ,YAAYI,SAAS,YAG/DtS,EAAWiL,cAAgB,GAC3BvJ,QAAQC,MAAM,gCACd1B,EAAUQ,KAAK,WAEf,KACET,EAAWoV,UACX,MAAO7a,GACPmH,QAAQ8D,IAAI,iBAIhBxF,EAAWK,IAAI,cAAe,SAAS7J,EAAOiD,GAC5C,GAAI4b,GAAc,WAChB,MAAOvF,GAAG,SAASwF,EAASC,GACtB/T,EAAQ/H,KAAK+b,eACfrV,GACExB,MAAOoE,EAAWyF,QAAQ,qBAC1BxH,QAAS+B,EAAWyF,QAAQ,8BAC3BrH,KAAK,WACNO,QAAQ8D,IAAI,2BACZvF,EAAUQ,KAAK,YACd,WACDe,EAAQ/H,KAAK8S,WAAa,aAC1BnM,EAAMiG,YAGR3E,QAAQ8D,IAAI,2BACZvF,EAAUQ,KAAK,YAEjB6U,MAGJzK,GAAW4K,OAAOnW,KAAK+V,KAGzB/T,EAAOjB,IAAI,mCAAoC,SAAU7J,EAAMkf,GAE7DhU,QAAQ8D,IAAI,yBACnB9D,QAAQ8D,IAAIkQ,GACZjF,KAAKC,OAAOiF,KAAK,OAAQ,KAAMnF,KAyB1BlP,EAAOjB,IAAI,mCAAoC,SAAU7J,EAAMkf,GAE7DhU,QAAQ8D,IAAI,2BAGdxF,EAAW4V,WAAa,SAASnc,EAAMoM,GACrCzF,EAAM3G,KAAKkN,SAAWnF,EAAQ/H,KAAKkN,SACnCvG,EAAM3G,KAAKoN,WAAarF,EAAQ/H,KAAKoN,WAEhCrF,EAAQ/H,KAAKuR,WAChBxJ,EAAQ/H,KAAKoc,WAAa,GAAItQ,OAEhC/D,EAAQ/H,KAAK8S,WAAa,WAC1B,IAAIsJ,GAAa,GAAItQ,MAAK/D,EAAQ/H,KAAKoc,WACvC7V,GAAW8V,WAAaD,EAExBtU,EAAS,WACPD,EAAOqO,WAAW,iBAEpB0C,EAAQ0D,OACRvU,EAAQ/H,KAAK+S,SAAU,EAEvBhL,EAAQ/H,KAAKuR,SAAW,EAExB/K,EAAUQ,KAAK,WAEZoF,EAAOmQ,UACRhW,EAAWoO,MAAM,aAAc,UAInCpO,EAAWK,IAAI,cAAe,SAAS7J,EAAOiD,EAAMoM,GAClD7F,EAAW4V,WAAWnc,EAAMoM,KAG9B7F,EAAWK,IAAI,eAAgB,SAAS7J,EAAOiD,GAC7C+H,EAAQ/H,KAAK+S,SAAU,IAGzBxM,EAAWK,IAAI,gBAAiB,SAAS7J,EAAOiD,GAC9CiI,QAAQ8D,IAAI,uBAAyB/L,GAErC+H,EAAQ/H,KAAKuR,SAAW,EACxB1J,EAAO2U,cAAe,EACtBzU,EAAQ/H,KAAKiS,WAAY,EACzBlK,EAAQ/H,KAAKoN,YAAa,EAC1BrF,EAAQ/H,KAAKkN,UAAW,EAExBxG,GACExB,MAAOoE,EAAWyF,QAAQ,uBAC1BxH,QAAS+B,EAAWyF,QAAQ,yBAA2B/O,IACtD0H,KAAK,WACN,GAAI0U,GAAa,GAAItQ,MAAK/D,EAAQ/H,KAAKoc,WACvC7V,GAAW8V,WAAaD,EACxBnU,QAAQ8D,IAAIxF,EAAW8V,YAEvBxU,EAAO4U,aACP1U,EAAQ/H,KAAKyR,cAAgBzR,EAC7BmR,EAAYe,IAAIlS,EAAM,WAAW,GACjCwG,EAAUQ,KAAK,YACd,WACDa,EAAO6U,cACPvL,EAAYe,IAAIlS,EAAM,WAAW,OAIrC6H,EAAO8U,KAAO,WACZ5U,EAAQ/H,KAAKsR,QAAUvJ,EAAQ/H,KAAKsR,OACpC3K,EAAM3G,KAAKqN,KAAKuP,cAMlB/U,EAAO+E,OAAS,WACd,MAAKjG,GAAM3G,KAAKqN,KAMZ9G,EAAWmG,YACbhQ,QAAOmQ,SAaLlG,EAAM3G,KAAK6V,WACblP,EAAMmP,oBAGRnP,EAAMiG,SAENrG,EAAWoO,MAAM,kBACjBnO,GAAUQ,KAAK,cA1BbP,EAAO0L,QAAQ7I,EAAWyF,QAAQ,+BAClCvI,GAAUQ,KAAK,cA4BnBa,EAAO4U,WAAa,WAClB1U,EAAQ/H,KAAKsR,QAAS,EAEtB3K,EAAM3G,KAAKqN,KAAKwP,QACdC,UAAW/U,EAAQ/H,KAAK8c,UACxBpL,UAAW3J,EAAQ/H,KAAK+c,cACxBR,SAAUxU,EAAQ/H,KAAKuc,SACvB5K,OAAQ5J,EAAQ/H,KAAK2R,OACrBqL,eAAgBrW,EAAM3G,KAAK6C,KAC3Boa,iBAAkBtW,EAAM3G,KAAKoW,QAI/B5P,EAAUQ,KAAK,YAGjBa,EAAO6U,YAAc,WACnB7U,EAAO+E,SACP/E,EAAO2U,cAAe,GAGxB3U,EAAOyU,KAAO,WACDzU,EAAOP,YAAYgC,EAAWyF,QAAQ,0BAA2B,GAAI,OAC9E,SAASmO,GACPvW,EAAM3G,KAAKmM,KAAKmQ,KAAKY,GACrBjV,QAAQ8D,IAAI,cAAemR,MAKjCrV,EAAOsV,KAAO,WACZxW,EAAM3G,KAAKmM,KAAKgR,QAGlBtV,EAAOuV,OAAS,WACHvV,EAAOP,YAAYgC,EAAWyF,QAAQ,0BAA2B,GAAI,OAC9E,SAASmO,GACPvW,EAAM3G,KAAKmM,KAAKiR,OAAOF,GACvBjV,QAAQ8D,IAAI,mBAAoBmR,MAItCrV,EAAOwV,WAAa,WAClB1W,EAAM3G,KAAKmM,KAAKkR,cAGlBxV,EAAOyV,SAAW,WACLzV,EAAOP,YAAYgC,EAAWyF,QAAQ,0BAA2B,GAAI,OAC9E,SAASmO,GACPvW,EAAM3G,KAAKmM,KAAKmR,SAASJ,GACzBjV,QAAQ8D,IAAI,kBAAmBmR,MAYrC3W,EAAW2R,WAAa,SAASlN,GAC/BzE,EAAW4R,YAAYxS,MAAQY,EAAW4R,YAAYxS,MAAQqF,EAC1DrE,EAAM3G,KAAKqN,MACb1G,EAAM+T,KAAK1P,IAIfzE,EAAW2J,qBAAuB,WAChC3J,EAAWyR,sBAAuB,GAGpCzR,EAAW6J,oBAAsB,WAC/B7J,EAAWyR,sBAAuB,GAGpCzR,EAAWK,IAAI,oBAAqB,SAAS7J,EAAO8J,EAAMC,GACtB,YAA9BD,EAAKK,QAAQqW,cACfhX,EAAW4R,YAAYxS,MAAQ,GAC/BnD,QAAQiW,QAAQnC,GAASkH,KAAK,UAAW1F,IAEzCtV,QAAQiW,QAAQnC,GAASmH,OAAO,UAAW3F,WAiBrD,WACE,YAEAtV,SACGC,OAAO,oBACV2C,WAAW,kBAAmB,SAAU,QAAS,YAChD,QAAS,UAAW,aACpB,SAASyC,EAAQsB,EAAO3C,EAAWG,EAAOoB,EAASxB,GACjD0B,QAAQC,MAAM,6BACbL,EAAOE,QAAUA,EAEjBxB,EAAWK,IAAI,YAAa,SAAS9F,EAAGd,GACtC,GAAI0d,GAAU3V,EAAQ/H,KAAK0d,QAC9BC,EAAM,CAEH9V,GAAO+V,SAAW5d,EAAK6d,QACvBhW,EAAOiW,OAAS9d,EAAK+d,MAEjB/d,EAAK6d,QAAU,KACjBF,IAGE3d,EAAK+d,MAAQ,KACdJ,IAGH9V,EAAOmW,UAAY,qCAEfL,EAAM,EACP9V,EAAOmW,UAAY,sCACXL,EAAM,IACd9V,EAAOmW,UAAY,oCAGtBrX,EAAMsX,aAAavY,QAAQ,SAASwY,GAC9BA,EAAItb,IAAM8a,IACZ7V,EAAOsW,OAASD,EAAI1W,SAIxBK,EAAOmE,iBAOf,WACE,YAEAxJ,SACGC,OAAO,oBACP2C,WAAW,0BAA2B,SACrC,iBACA,SAASyC,EAAQuW,GAEfvW,EAAOwW,GAAK,WACVD,EAAevR,MAAM,QAGvBhF,EAAO8L,OAAS,WACdyK,EAAeE,QAAQ,iBAMjC,WACE,YAQE,SAASC,GAA2BhY,EAAYsB,EAAQE,EAASpB,GAK/D,QAAS6X,KACHjY,EAAWiQ,kBAAoB7P,EAAM3G,KAAKye,WAC5C9X,EAAM3G,KAAKye,SAASC,UAAUC,eAC9BpY,EAAWiQ,iBAAiB3J,cACrBlG,GAAM3G,KAAKye,UARtBxW,QAAQC,MAAM;sDAEdL,EAAO2W,eAAiBA,EAT5Bhc,QACGC,OAAO,oBACP2C,WAAW,6BAA8BmZ,GAE1CA,EAA2BK,SAAW,aAAc,SAAU,UAAW,YAmB7E,WACE,YAEApc,SACGC,OAAO,oBACP2C,WAAW,mCAAoC,SAC9C,QAAS,YAAa,iBAAkB,QAAS,UACjD,SAASyC,EAAQsB,EAAO3C,EAAW4X,EAAgBzX,EAAOoB,GACxDE,QAAQC,MAAM,8CAEdL,EAAOlB,MAAQA,EACfkB,EAAOE,QAAUA,EAEjBF,EAAOwW,GAAK,WACVD,EAAevR,MAAM,QAGvBhF,EAAO8L,OAAS,WACdyK,EAAeE,QAAQ,WAGzB3X,EAAM3G,KAAK6C,KAAOkF,EAAQ/H,KAAK6C,KAC/B8D,EAAM3G,KAAKoL,MAAQrD,EAAQ/H,KAAKoL,YAOxC,WACE,YAEA5I,SACGC,OAAO,oBACP2C,WAAW,sBAAuB,SAAU,QAC3C,YAAa,aAAc,UAAW,QAAS,aAAc,SAAU,kBACvE,SAASyC,EAAQsB,EAAO3C,EAAWD,EAAYwB,EAASpB,EAAO2C,EAAY7C,EAAQzB,GACjFiD,QAAQC,MAAM,sCAEdkQ,EAAEiC,SAASC,OAEXzS,EAAOgX,mBAAqE,KAA7Czf,SAAS6V,eAAe,UAAU6J,OACjEjX,EAAOE,QAAUA,EACjBF,EAAOlB,MAAQA,EACfkB,EAAOkX,OAASvc,QAAQwc,KAAKjX,EAAQ/H,MACrC6H,EAAOlF,UAAYqC,EAAgBrC,UACnCkF,EAAOlF,UAAUsc,SAASrc,GAAI,UAAWC,KAAOyG,EAAWyF,QAAQ,sBACnElH,EAAOkX,OAAOxG,SAAWxQ,EAAQ/H,KAAKuY,UAAY,UAElDhS,EAAWK,IAAI,0BAA2B,WACxC0C,EAAW,oBAAoB5B,KAAK,SAAUwX,GAC9CrX,EAAOlF,UAAU,GAAGE,KAAOqc,MAI7B3Y,EAAWK,IAAI,kBAAmB,SAAS9F,EAAG4H,GACxCA,EACFb,EAAOkX,OAASvc,QAAQwc,KAAKjX,EAAQ/H,MAErC6H,EAAOwW,OAIXxW,EAAOwW,GAAK,WACVpW,QAAQ8D,IAAI,qBAAsBlE,EAAOkX,OAAOhC,cAAelV,EAAOlB,MAAM3G,KAAKmf,cAEjF3c,QAAQkD,QAAQiB,EAAM3G,KAAKmf,aAAc,SAASjhB,GAChD+J,QAAQ8D,IAAI,kBAAmB7N,GAC3BA,EAAM0E,IAAMiF,EAAOkX,OAAOhC,gBAC5BlV,EAAOkX,OAAOK,kBAAoBlhB,EAAMsJ,MACxCS,QAAQ8D,IAAI,gCAAiC7N,EAAMsJ,UAGnDK,EAAOkX,OAAOjK,iBAAmB/M,EAAQ/H,KAAK8U,iBAChDvO,EAAWoO,MAAM,iBAAkB9M,EAAOkX,OAAOjK,iBAEnD/M,EAAQsX,WAAWxX,EAAOkX,QAC1BpY,EAAM3G,KAAKye,SAASa,WAAWvX,EAAQ/H,KAAKuf,SAExCxX,EAAQ/H,KAAK8W,UACfjP,EAAO6L,WAGT,IAAI8L,IACFC,yBAA4DzG,KAAtCjR,EAAQ/H,KAAKyf,sBAA4C1X,EAAQ/H,KAAKyf,qBAC5FC,yBAA4D1G,KAAtCjR,EAAQ/H,KAAK0f,sBAA4C3X,EAAQ/H,KAAK0f,qBAC5FC,uBAAwD3G,KAApCjR,EAAQ/H,KAAK2f,oBAA0C5X,EAAQ/H,KAAK2f,mBACxFC,wBAA0D5G,KAArCjR,EAAQ/H,KAAK4f,qBAA2C7X,EAAQ/H,KAAK4f,oBAC1FC,yBAA2D7G,KAArCjR,EAAQ/H,KAAK4f,qBAA2C7X,EAAQ/H,KAAK4f,oBAE7FjZ,GAAM3G,KAAKye,SAAShI,QAAQ+I,YAAcA,GAI5C3X,EAAOiY,gBAAkB,SAASC,GAChC,GAAgB,YAAZA,EAAsB,CACzBhY,EAAQ/H,KAAKuY,SAAW,SACvB,IAAIyH,GAAc1W,EAAWpD,mBAC7BoD,GAAWkP,IAAIwH,GAAatY,KAC1B,SAASuY,KAAU,SAASC,GAC1B5W,EAAWkP,IAAI,YAGnBlP,GAAWkP,IAAIuH,GACfhY,EAAQ/H,KAAKuY,SAAWwH,GAI5BlY,EAAOsY,kBAAoB,WACzB,MAAOxZ,GAAMyZ,kBAGfvY,EAAOwY,YAAc,WAGnB,GAFiB7d,QAAQiW,QAAQrZ,SAASqK,cAAc,cAC7CwR,YAAY,YAClBtU,EAAM3G,KAAKqN,KAEd,WADA7G,GAAUQ,KAAK,WAIfP,GAAO0L,QAAQ7I,EAAWyF,QAAQ,8BAItClH,EAAO6L,UAAY,WAIjB,QAASlI,GAAGxL,GACV6H,EAAOkX,OAAOrB,QAAU3V,EAAQ/H,KAAK0d,QACrC7V,EAAOyY,SAAW,OAAStgB,EAAK+d,MAAQ,UAAY/d,EAAK6d,QACzDhW,EAAO0Y,gBAAiB,EACxB1Y,EAAOmE,SANT,MADAnE,GAAO0Y,gBAAiB,EACjB5Z,EAAM+M,UAAUlI,IAUzB3D,EAAO2Y,cAAgB,WACxBzX,QAAQ,6BACHhB,EAAQ0Y,eACR5Y,EAAO4R,SACd/c,OAAO0K,SAASsZ,WAIb7Y,EAAO8Y,cAAgB,SAASC,GAC9B/Y,EAAOkX,OAAO8B,WAAY,CAC1B,IAAIC,GAAU7C,aAAaA,aAAa5gB,OAAO,EAC/CwK,GAAOkX,OAAOrB,QAAUoD,EAAQle,GAChCmF,EAAQ/H,KAAK0d,QAAUoD,EAAQle,GAC/B+D,EAAM3G,KAAKye,SAASsC,aAClBC,SAAUF,EAAQviB,MAClB0iB,UAAWH,EAAQriB,OACnBJ,SAAUyiB,EAAQviB,MAClBC,UAAWsiB,EAAQriB,OACnByiB,aAAc,GACdC,mBAAoBpZ,EAAQ/H,KAAKohB,gBAEnCrZ,EAAQ/H,KAAK0d,QAAUoD,EAAQle,GAC1Bge,EAMH/Y,EAAOkX,OAAOtL,eAAgB,GAL9B5L,EAAOkX,OAAOsC,kBAAoB,UAClCxZ,EAAOkX,OAAOuC,kBAAoB,UAClCzZ,EAAOkX,OAAOtL,eAAgB,IAOlC5L,EAAO0Z,yBAA2B,SAASX,IACQ,IAA5C,IAAK,UAAW,QAAQngB,QAAQmgB,GACnC/Y,EAAOkX,OAAO8B,WAAY,EAE1BhZ,EAAOkX,OAAO8B,WAAY,GAI9BhZ,EAAO2Z,kBAAoB,SAASC,GAClC,GAAIC,GAAIC,gBAAgBF,GAAmB,MACvCxgB,EAAI0gB,gBAAgBF,GAAoB,MAC5C1Z,GAAQ/H,KAAK0d,QAAU+D,EACvB9a,EAAM3G,KAAKye,SAASsC,aAClBC,SAAUU,EACVT,UAAWhgB,EACX5C,SAAUqjB,EACVljB,UAAWyC,EACXigB,aAAc,GACdC,mBAAoBpZ,EAAQ/H,KAAKohB,uBAU7C,WACE,YAEA5e,SACGC,OAAO,oBACP2C,WAAW,qBAAsB,aAAc,SAC9C,QAAS,YAAa,SAAU,WAAY,SAAU,QAAS,UAAW,SAAU,aAAc,aAClG,SAASmB,EAAYsB,EAAQsB,EAAO3C,EAAWoN,EAAQ9L,EAAUrB,EAC/DE,EAAOoB,EAASrB,EAAQ0C,EAAYE,GA4CpC,QAASsY,GAAUC,GACjB,GAAqB,kBAAVA,GACTA,EAAO1E,WAEP,IAAI0E,EAAOC,OAAQ,CACjB,GAAIC,GAASF,EAAOG,WACpBD,GAAOrc,QAAQ,SAASuc,EAAOrU,GAC7BqU,EAAM9E,UAKd,QAAS+E,GAAYL,GACfM,GACFP,EAAUO,GAGZA,EAAYN,EACZO,uBAAuBC,EAAYR,GAC/BlmB,IACF2mB,EAAoB3mB,EAAa4mB,wBAAwBV,GACzDW,EAAQ9mB,iBAAiBC,GACzB2mB,EAAkBhmB,QAAQkmB,IAhE9B3a,EAAOE,QAAUA,EACjBE,QAAQC,MAAM,+BACd,IAAIma,GAAajjB,SAAS6V,eAAe,gBACrCwN,EAAUrjB,SAASqK,cAAc,sBACjCgZ,KACFA,EAAUA,EAAQC,UAGpB7a,EAAOwa,WAAa,WAClB,GAAIM,IACFC,UAAU,EACV3kB,OACES,WAAaX,SAAUgK,EAAQ/H,KAAK6iB,kBAIpCC,EAAYnc,EAAM3G,KAAKmf,aAAa4D,KAAK,SAASC,GACpD,MAAOA,GAAOpgB,IAAMmF,EAAQ/H,KAAK+c,eAGnChV,GAAQ/H,KAAK+c,cAAgB+F,EAAUlgB,GACvCmF,EAAQ/H,KAAKof,kBAAoB0D,EAAUtb,MAEtB,SAAjBsb,EAAUlgB,KACZ+f,EAAYzkB,OACVQ,WAAaX,SAAU+kB,EAAUlgB,OAIrCzC,UAAU8iB,aAAaN,EAAaT,EAAa,SAASgB,EAAKljB,MAIjE,IAAIrE,GAAe,IACS,oBAAjBwnB,gBACTxnB,EAAe,GAAIwnB,cAGrB,IAAIb,GAAoB,KACpBE,EAAQ,KACRL,IA6CJta,GAAOsY,kBAAoB,WAC1B,MAAOxZ,GAAMyZ,kBAGdvY,EAAOoK,UAAY,WACjBvL,GACExB,MAAOoE,EAAWyF,QAAQ,sBAC1BxH,QAAS+B,EAAWyF,QAAQ,0BAC3BrH,KAAK,WACNK,EAAQ/H,KAAKiS,WAAY,EACzBpK,EAAOmM,aAAe,8BAI1BnM,EAAOyM,YAAc,SAASvX,EAAOiD,GACnC+H,EAAQ/H,KAAKoN,YAAcrF,EAAQ/H,KAAKoN,YAG1CvF,EAAO0M,UAAY,SAASxX,EAAOiD,GACjC+H,EAAQ/H,KAAKkN,UAAYnF,EAAQ/H,KAAKkN,UAGxCrF,EAAO2M,sBAAwB,SAASvK,GACtCtD,EAAM3G,KAAKmM,KAAKsI,eAAexK,IAGjCpC,EAAOub,WAAa,WAClBf,EAAW9iB,IAAM,KACb5D,IACF6mB,EAAM3lB,WACN2lB,EAAMvmB,eAAiB,MAEzB2lB,EAAUO,GACV3b,EAAUQ,KAAK,YACfe,EAAQ/H,KAAKsT,SAAU,GAGzBzL,EAAOwa,mBAKf,WACI,YAEA7f,SACKC,OAAO,oBACP2C,WAAW,qBAAsB,aAAc,SAAU,YAAa,YAAa,QAChF,SAASmB,EAAYsB,EAAQrB,EAAW6c,EAAW1c,GAC/CsB,QAAQ8D,IAAI,qBACZ,IAAIuX,EAEJzb,GAAO0b,aAAe,WAClBF,EAAU1P,OAAO2P,IAGrBA,EAASD,EAAU,WACb1c,EAAM3G,KAAKwjB,gBACb3b,EAAO0b,eACP/c,EAAUQ,KAAK,cAEhB,WAMnB,WACE,YACsBxE,SAAQC,OAAO,yBAOvC,WACE,YAEAD,SACCC,OAAO,mBACPghB,UAAU,aAAc,WACvB,SAAU3b,GACR,OACE4b,SAAU,IACVpb,KAAM,SAAUT,EAAQ8b,GACtB7b,EAAS,WACP6b,EAAS,GAAGC,kBAOxB,WACE,YAEAphB,SACCC,OAAO,mBACPghB,UAAU,gBACV,aAAc,SAASra,GAyBtB,OACEd,KAzBS,SAASub,EAAOpL,EAASqL,GAClC,GAAIvmB,GAAI,IACR6c,QAAO,iBAAiB2J,OAAO,QAC/B3J,OAAO,wBAAwB2J,OAAO,QACtCtL,EAAQuL,SAASxG,KAAK,YAAa,WAC7BpU,EAAWoS,cACbyI,aAAa1mB,GACb6c,OAAO,iBAAiB2J,OAAO,QAC/B3J,OAAO,wBAAwB2J,OAAO,KACtCxmB,EAAI0B,WAAW,WACTmK,EAAWoS,cACbpB,OAAO,iBAAiB8J,QAAQ,QAChC9J,OAAO,wBAAwB8J,QAAQ,OAExC,QAGPzL,EAAQuL,SAASxG,KAAK,aAAc,WAClCpD,OAAO,iBAAiB2J,SACxB3J,OAAO,wBAAwB2J,mBAWvC,WACE,YAEAvhB,SACCC,OAAO,mBAAmBghB,UAAU,aACrC,WAYE,OACEI,OACEM,UAAa,KAEf7b,KAfS,SAASub,EAAOpL,EAASqL,GAClCD,EAAMnY,OAAO,YAAa,SAASyY,GACjC1L,EAAQsC,YAAY,aACpBtC,EAAQsC,YAAY,gBACpBtC,EAAQsC,YAAY,cAEpBtC,EAAQC,SAASyL,YAuBzB,WACE,YAEA3hB,SACCC,OAAO,mBACPghB,UAAU,WACX,WAEE,QAASnb,GAAKub,EAAOpL,EAASqL,GAE5B7b,QAAQ8D,IAAI,+BACZ,IAAIqY,GAAYhK,OAAO,UAEPhb,UAASilB,uBAAuB,qBAC3C,GAAGzkB,YAAYR,SAAS6V,eAAe,WAEjDmD,EAAE,WAAWkM,OAAO,WAChBpJ,oBAGJ9C,EAAE1b,QAAQ4nB,OAAO,WACbpJ,oBAGJA,kBAEAkJ,EAAUrJ,YAAY,QACtBqJ,EAAUG,IAAI,UAAW,SAEpBV,EAAM1H,WAAW,IAAKI,UAAU,IAEhC9D,EAAQ+L,GAAG,WAAY,WAErBvc,QAAQ8D,IAAI,kCACZqY,EAAU1L,SAAS,QAAQ+L,SAASrK,OAAO,SAC3ChC,EAAE1b,QAAQ+gB,OAAO,YAIrB,OACEnV,KAAMA,QAMZ,WACE,YACmB9F,SAAQC,OAAO,sBAGpC,WACE,YAEAD,SACCC,OAAO,gBACPiiB,OAAO,YAAa,WACnB,GAAIC,GAAQ,gFACRC,EAAU,iGAEd,OAAO,UAAUrZ,EAAMhN,EAAO+C,GAC5B,GAAI/D,GAAI,CACRgB,GAAQA,GAAS,IACdqmB,EAAQC,KAAKtZ,KACdA,EAAOA,EAAK0F,QAAQ2T,EAAS,6DAA8DrmB,EAAO,0CAGpG,IACEgN,EAAOA,EAAK0F,QAAQ0T,EAAO,+CAAgDpmB,EAAO,4BAC1E+C,GAAMA,GAAK/D,IAAM+D,IAAOqjB,EAAME,KAAKtZ,GAE7C,OAAOA,SAOb,WACE,YACmB/I,SAAQC,OAAO,qBAMpC,IAAIwb,iBACA6G,qBACFliB,GAAI,QACJ4E,MAAO,gBACPjJ,MAAO,IACPE,OAAQ,MAERmE,GAAI,OACJ4E,MAAO,eACPjJ,MAAO,IACPE,OAAQ,MAERmE,GAAI,MACJ4E,MAAO,cACPjJ,MAAO,IACPE,OAAQ,MAERmE,GAAI,YACJ4E,MAAO,oBACPjJ,MAAO,IACPE,OAAQ,MAERmE,GAAI,WACJ4E,MAAO,mBACPjJ,MAAO,IACPE,OAAQ,MAERmE,GAAI,KACJ4E,MAAO,cACPjJ,MAAO,KACPE,OAAQ,MAERmE,GAAI,MACJ4E,MAAO,gBACPjJ,MAAO,KACPE,OAAQ,OAGNkjB,iBACFoD,OACExmB,MAAO,IACPE,OAAQ,KAEVumB,MACEzmB,MAAO,IACPE,OAAQ,KAEVwmB,KACE1mB,MAAO,IACPE,OAAQ,KAEVymB,WACE3mB,MAAO,IACPE,OAAQ,KAEV0mB,UACE5mB,MAAO,IACPE,OAAQ,KAEV2mB,IACE7mB,MAAO,KACPE,OAAQ,KAEV4mB,KACE9mB,MAAO,KACPE,OAAQ,OAIR6mB,YACF1iB,GAAI,MACJ4E,MAAO,UAEP5E,GAAI,MACJ4E,MAAO,UAEP5E,GAAI,OACJ4E,MAAO,QAEP5E,GAAI,OACJ4E,MAAO,UAEP5E,GAAI,OACJ4E,MAAO,QAEP5E,GAAI,OACJ4E,MAAO,QAEP5E,GAAI,OACJ4E,MAAO,QAEP5E,GAAI,OACJ4E,MAAO,QAEP5E,GAAI,IACJ4E,MAAO,aAEP5E,GAAI,UACJ4E,MAAO,mBAGL+d,YACF3iB,GAAI,KACJ4E,MAAO,WAEP5E,GAAI,KACJ4E,MAAO,WAEP5E,GAAI,KACJ4E,MAAO,WAGLge,UAEAtK,gBAAkB,SAASuK,GACtBA,IAAIA,EAAK,KAEdxB,aAAauB,WACbA,UAAYvmB,WAAW,WACnB,GAAImlB,GAAYhK,OAAO,UACvBgK,GAAU7lB,MAAM,IAChB6lB,EAAU3lB,OAAO,GAEjB,IAEIinB,GAAOC,EAFPjE,EAAI0C,EAAU7lB,QACd0C,EAAImjB,EAAU3lB,SAEdmnB,EAASlE,EAAIzgB,EACb4kB,EAAiBzL,OAAO,oBACxBsH,GAAIzgB,GACJykB,EAAQG,EAAetnB,QACvBonB,EAAQnoB,KAAKsoB,MAAMD,EAAetnB,QAAUqnB,KAE5CD,EAAQE,EAAepnB,SACvBinB,EAAQloB,KAAKsoB,MAAMD,EAAepnB,SAAWmnB,IAEjDxB,EAAU7lB,MAAMmnB,GAChBtB,EAAU3lB,OAAOknB,GACjB1d,QAAQ8D,IAAI,yBAA2B2Z,EAAQ,IAAMC,IACtDF,IAGHM,aAAevjB,QAAQC,OAAO,gBAAiB,aAEnDsjB,cAAaC,QAAQ,SAAU,aAAc,eAAgB,YAAa,UACxE,SAASzf,EAAY0f,EAAczf,EAAWuB,GAmC5C,QAASme,GAAeC,GACtBnmB,EAAK6V,UAAY,KACjB7V,EAAKsY,UAAY,SACjB6N,EAAK/F,iBAGP,QAASgG,KACPpmB,EAAKqN,KAAO,KACZrN,EAAKsY,UAAY,KACjBtY,EAAKmM,KAAO,KACZnM,EAAKqmB,eACLrmB,EAAK6N,SAAW,KAChB7N,EAAKsmB,aAAe,KAEpB/f,EAAWoO,MAAM,cAAe,UAOlC,QAASwH,GAAWoK,EAAYna,GAC9B7F,EAAWoO,MAAM,cAAe4R,EAAYna,GAG9C,QAAS2G,KACPxM,EAAWoO,MAAM,eAAgB,WAGnC,QAAS6H,GAAaxR,GACpBzE,EAAWoO,MAAM,gBAAiB3J,GAGpC,QAASwb,GAAkBC,GA0BzB,MAzBAxe,SAAQC,MAAM,0DAIdD,QAAQC,MAAM,cAAgB4c,mBAAmBznB,QACjD4K,QAAQC,MAAMue,GAEdjkB,QAAQkD,QAAQof,mBAAoB,SAASrD,EAAY7e,GACvDJ,QAAQkD,QAAQ+gB,EAAsB,SAASC,GAC7C,GAAInoB,GAAQmoB,EAAI,GACZjoB,EAASioB,EAAI,EAEdjF,GAAWljB,OAASA,GAASkjB,EAAWhjB,QAAUA,GACnDwf,aAAapY,KAAK4b,OAMxBxZ,QAAQC,MAAM,gBAAkB+V,aAAa5gB,QAC7C2C,EAAKie,aAAeA,aACpBhW,QAAQC,MAAM+V,cACdje,EAAK0d,QAAWO,aAAa5gB,OAAS,EAAK4gB,aAAaA,aAAa5gB,OAAS,GAAGuF,GAAK,KACtFqF,QAAQC,MAAMlI,EAAK0d,SAEZO,aA7FT,GAAIje,IAEFye,SAAU,KACV1X,WAAW,EAGXsG,KAAM,KACNwI,UAAW,KACXyC,UAAW,KACXnM,KAAM,KACNka,eACAxY,SAAU,KACVyY,aAAc,KACdK,UAAW,KAGXxH,gBACAyH,gBACAC,gBACA5I,gBACA5M,UAAW4U,EAAapV,IAAI,kBAC5BhO,KAAMojB,EAAapV,IAAI,mBACvBzF,MAAO6a,EAAapV,IAAI,oBACxBiW,IAAKb,EAAapV,IAAI,kBACtBkW,OAAQd,EAAapV,IAAI,sBAAwB,OACjDuF,MAAO6P,EAAapV,IAAI,qBAAuB,OAC/C2I,SAAUyM,EAAapV,IAAI,sBAAwB,OACnDuI,SAAU1c,OAAO0K,SAASgS,SAC1BC,MAAQ,SAAW3c,OAAO0K,SAASgS,SAAW,QAC9C4N,cAAe,KACfC,WAAY,KACZzD,eAAe,EAsEjB,QACExjB,KAAMA,EACNsY,WANAhK,SAAS,EACTE,WAAW,GAQXyP,aAAcA,aACd0D,gBAAiBA,gBACjB2D,UAAWA,UACXC,UAAWA,UAEX2B,uBAAyB,SAAgCpnB,GACvDE,EAAKmf,eACHvc,GAAI,OACJ4E,MAAO,cAETxH,EAAK6mB,eACHjkB,GAAI,SACJ4E,MAAO,WAETxH,EAAK4mB,eACHhkB,GAAI,MACJ4E,MAAO,uBAGZ5E,GAAI,OACJ4E,MAAO,kBAEJxH,EAAKmnB,iBACRvkB,GAAI,MACJ4E,MAAO,oBAGAO,EAAQ/H,KAAKonB,gBACfrf,EAAQ/H,KAAKonB,cAAgBpnB,EAAK6mB,aAAa,GAAO,GAGxD,KAAK,GAAItpB,KAAK6c,QAAOzT,MAAMwY,aAAc,CACvC,GAAI6D,GAAS5I,OAAOzT,MAAMwY,aAAa5hB,EAClCylB,GAAOxb,MAMVxH,EAAKmf,aAAatZ,MAChBjD,GAAIogB,EAAOpgB,GACX4E,MAAOwb,EAAOxb,OAASwb,EAAOpgB,KAPhC5C,EAAKmf,aAAatZ,MAChBjD,GAAI,UAAYrF,EAChBiK,MAAO,UAAYjK,IAUd,GAALA,GAAWwK,EAAQ/H,KAAK+c,gBAC1BhV,EAAQ/H,KAAK+c,cAAgBiG,EAAOpgB,IAGjCogB,EAAOxb,MAQZxH,EAAK6mB,aAAahhB,MAChBjD,GAAIogB,EAAOpgB,GACX4E,MAAOwb,EAAOxb,OAASwb,EAAOpgB,KAT9B5C,EAAK6mB,aAAahhB,MAChBjD,GAAI,gBAAkBrF,EACtBiK,MAAO,gBAAkBjK,IAW/B,IAAK,GAAIA,KAAK6c,QAAOzT,MAAM0gB,eAAgB,CACzC,GAAIrE,GAAS5I,OAAOzT,MAAM0gB,eAAe9pB,EAEhC,IAALA,GAAWwK,EAAQ/H,KAAK6iB,gBAC1B9a,EAAQ/H,KAAK6iB,cAAgBG,EAAOpgB,IAGjCogB,EAAOxb,MAOZxH,EAAK4mB,aAAa/gB,MAChBjD,GAAIogB,EAAOpgB,GACX4E,MAAOwb,EAAOxb,OAASwb,EAAOpgB,KAR9B5C,EAAK4mB,aAAa/gB,MAChBjD,GAAI,cAAgBrF,EACpBiK,MAAO,cAAgBjK,IAU7B,IAAK,GAAIA,KAAK6c,QAAOzT,MAAM2gB,gBAAiB,CAC1C,GAAItE,GAAS5I,OAAOzT,MAAM2gB,gBAAgB/pB,EAEjC,IAALA,GAAWwK,EAAQ/H,KAAK8U,kBAC1B/M,EAAQ/H,KAAK8U,gBAAkBkO,EAAOpgB,IAGnCogB,EAAOxb,MAOZxH,EAAKmnB,eAAethB,MAClBjD,GAAIogB,EAAOpgB,GACX4E,MAAOwb,EAAOxb,OAASwb,EAAOpgB,KAR9B5C,EAAKmnB,eAAethB,MAClBjD,GAAI,WAAarF,EACjBiK,MAAO,WAAajK,IAS1B0K,QAAQC,MAAM,yDAGd,IAAIqf,GAAYvnB,EAAKmf,aAAaqI,KAAK,SAASxE,GAE9C,MADA/a,SAAQ8D,IAAI,qBAAsBiX,GAC9BA,EAAOxb,OAASO,EAAQ/H,KAAKof,mBAC/BnX,QAAQ8D,IAAI,oCAAqCiX,EAAOxb,OACxDO,EAAQ/H,KAAK+c,cAAgBiG,EAAOpgB,IAC7B,GAEFogB,EAAOpgB,IAAMmF,EAAQ/H,KAAK+c,eAAgD,SAA/BhV,EAAQ/H,KAAK+c,gBAG7D0K,EAAYznB,EAAK6mB,aAAaW,KAAK,SAASxE,GAC9C,MAAOA,GAAOpgB,IAAMmF,EAAQ/H,KAAKonB,gBAG/BM,EAAY1nB,EAAK4mB,aAAaY,KAAK,SAASxE,GAC9C,MAAOA,GAAOpgB,IAAMmF,EAAQ/H,KAAK6iB,gBAG/B8E,EAAc3nB,EAAKmnB,eAAeK,KAAK,SAASxE,GAClD,MAAOA,GAAOpgB,IAAMmF,EAAQ/H,KAAK8U,iBAGnC7M,SAAQ8D,IAAI,kBAAmBhE,EAAQ/H,KAAK+c,eAC5C9U,QAAQ8D,IAAI,eAAgBwb,GAEvBA,IAAWxf,EAAQ/H,KAAK+c,cAAgB/c,EAAKmf,aAAanf,EAAKmf,aAAa9hB,OAAS,GAAGuF,IACxF6kB,IAAW1f,EAAQ/H,KAAKonB,cAAgBpnB,EAAK6mB,aAAa,GAAGjkB,IAC7D8kB,IAAW3f,EAAQ/H,KAAK6iB,cAAgB7iB,EAAK4mB,aAAa,GAAGhkB,KAC7D+kB,GAAe3nB,EAAKmnB,eAAe9pB,OAAS,IAAG0K,EAAQ/H,KAAK8U,gBAAkB9U,EAAKmnB,eAAe,GAAGvkB,IAGzE,IAA7B5C,EAAKmf,aAAa9hB,QACpB4K,QAAQ8D,IAAI,+BACZ/L,EAAK4nB,UAAW,EAChB5nB,EAAKmf,aAAatZ,MAChBjD,GAAI,OACJ4E,MAAO,eAGTxH,EAAK4nB,UAAW,EAGfplB,QAAQoF,WAAW9H,IACpBA,KAIJsgB,eAAgB,SAAStgB,GACvBmI,QAAQC,MAAM,sCACXpI,EACDsa,OAAOzT,MAAMyZ,eAAetgB,GAE5Bsa,OAAOzT,MAAMyZ,eAAe3jB,KAAKyqB,yBAOrCW,uBAAwB,SAASC,GAG/B,GAFA7f,QAAQC,MAAM,4CAEVlI,EAAKye,SAAU,CACjB,GAAIiD,GAAIoG,EAA8B,iBAAE,GACpC7mB,EAAI6mB,EAA8B,iBAAE,EAE9B,QAAN7mB,IACFygB,EAAI,KACJzgB,EAAI,KAGNulB,EAAkBsB,EAAsB,WAEnC/f,EAAQ/H,KAAK8W,UAAY/O,EAAQ/H,KAAK0d,UACzCgE,EAAIC,gBAAgB5Z,EAAQ/H,KAAK0d,SAASnf,MAC1C0C,EAAI0gB,gBAAgB5Z,EAAQ/H,KAAK0d,SAASjf,QAE5CuB,EAAKye,SAASsC,aACZC,SAAUU,EACVT,UAAWhgB,EACX5C,SAAUqjB,EACVljB,UAAWyC,EACXigB,aAAc,GACdC,mBAAoBpZ,EAAQ/H,KAAKohB,gBAEnCnD,aAAavY,QAAQ,SAASqiB,GACxBrG,IAAMqG,EAAKxpB,OAAS0C,IAAM8mB,EAAKtpB,SAC7BsJ,EAAQ/H,KAAK0d,UAAYqK,EAAKnlB,QAA+BoW,KAAzBjR,EAAQ/H,KAAK0d,UACnD3V,EAAQ/H,KAAK0d,QAAUqK,EAAKnlB,OAKlC5C,EAAKwjB,eAAgB,MAGrBvb,SAAQC,MAAM,mCAUlB5L,QAAS,SAASwD,GAIhB,QAASkoB,GAAgB9O,EAAG+O,EAAQC,GAClC3hB,EAAWoO,MAAM,aAAc,SAC/BpO,EAAWoO,MAAM,kBAAmB,cACpC3U,EAAKsmB,aAAe4B,EAAQC,OAC5BnoB,EAAK6N,SAAWqa,EAAQE,KACxBpoB,EAAKiN,mBAAqBib,EAAQjb,kBAClC,IAAId,GAAO,GAAIiM,GAAEzR,MAAMwF,KAAK+M,GAC1B+O,OAAQA,EACRI,OAAQtgB,EAAQ/H,KAAKuc,SACrBlQ,OAAQ6b,EACRI,aAAc,SAASpP,EAAGpY,GACxB,GAAImL,GAAOnL,EAAEd,KAAKuoB,aAAeznB,EAAEd,KAAKiM,MAAQ,UAC5C1E,EAAUzG,EAAEd,KAAKuH,SAAW,EAChChB,GAAWoO,MAAM,mBACf1I,KAAMA,EACNvM,KAAM6H,KAGVihB,YAAa,SAAStP,EAAG/M,EAAM5E,GAE7B,GADAU,QAAQ8D,IAAI,wBAAyB0c,WACf,YAAlBlhB,EAAQmhB,OAEV,GAA+B,qBAA3BnhB,EAAQ,gBAAwC,CAClD,GAAIohB,KAEJ,KAAK,GAAIprB,KAAKgK,GAAQqhB,aACpBD,EAAM9iB,KAAK0B,EAAQqhB,aAAarrB,GAAGsF,KAGrC,IAAI4T,GAAUkS,EAAME,KAAK,SAASnoB,EAAGC,GACnC,GAAImoB,GAA0B,UAArBpoB,EAAEma,UAAU,EAAG,GACpBkO,EAA0B,UAArBpoB,EAAEka,UAAU,EAAG,EAExB,QAAKiO,GAAMC,IAAOD,GAAMC,EACfD,GAAM,EAAI,EAGRpoB,GAAKC,EAAM,EAAQD,EAAIC,EAAM,GAAK,GAE/CX,GAAKmK,gBAAkB5C,EAAQqhB,aAC/B5oB,EAAKqmB,YAAc5P,MACiB,cAA3BlP,EAAQ,iBACjBvH,EAAKgpB,WAAazhB,EAAQqhB,aAC1BriB,EAAWoO,MAAM,wBAAyBpN,EAAQqhB,eAElDriB,EAAWoO,MAAM,uBAAwBpN,KAM5B,cAAjBvH,EAAK6N,WACP5F,QAAQ8D,IAAI,gCACZI,EAAK8c,mBACL9c,EAAK+c,WAAW,eAGlBlpB,EAAKmM,KAAOA,EAEZnM,EAAK2mB,UAAY,GAAIvO,GAAEzR,MAAMggB,UAC3B3mB,EAAKye,SAAUyJ,EAAQiB,UACvBjB,EAAQnS,QACNqT,WACEhU,OAAQ6S,EAASA,EAAO7S,OAAS,QAIvCpV,EAAK2mB,UAAU0C,MAAQ,SAAS7f,EAAK8f,GACnCrhB,QAAQ8D,IAAI,kBAAmBvC,EAAK8f,IAGtCtpB,EAAK2mB,UAAU4C,SAAW,SAAS/f,EAAK8f,GAEtC,OAAQA,EAAKZ,QACX,IAAK,UACHniB,EAAWoO,MAAM,eAAgB2U,EAAKtpB,MACtCspB,EAAKtpB,KAAK0F,QAAQ,SAAS6E,GACzB,GAAIif,GAASjf,EAAO,GAChB7B,EAASlG,QAAQinB,SAASlf,EAAO,GAAG,GACpCif,KAAWxpB,EAAKqN,KAAK+H,QACvB7O,EAAWyF,OAAO,WAChBhM,EAAKkN,SAAWxE,EAAOzK,MAAMkP,MAC7BnN,EAAKoN,WAAa1E,EAAOxK,MAAMiP,SAIrC,MACF,KAAK,MACH,GAAI5C,IAAU+e,EAAK1jB,IAAK0jB,EAAKtpB,KAC7BuG,GAAWoO,MAAM,cAAepK,EAChC,MACF,KAAK,MACH,GAAIK,GAAO0e,EAAK1jB,GAChBW,GAAWoO,MAAM,cAAe/J,EAChC,MACF,KAAK,QACHrE,EAAWoO,MAAM,gBACjB,MACF,KAAK,SACH,GAAIpK,IAAU+e,EAAK1jB,IAAK0jB,EAAKtpB,KAC7BuG,GAAWoO,MAAM,iBAAkBpK,EACnC,MACF,SACEtC,QAAQ8D,IAAI,iBAAkBud,EAAKZ,UAK3C,QAASgB,KACPzhB,QAAQ8D,IAAI,oBACR/L,EAAK2mB,WACP3mB,EAAK2mB,UAAUgD,UACf1hB,QAAQ8D,IAAI,uBACZxF,EAAWoO,MAAM,iBACjB3U,EAAK2mB,UAAY,MAEjB1e,QAAQ8D,IAAI,iCAGV/L,EAAKmM,OACPnM,EAAKmM,KAAKwd,UACV3pB,EAAKmM,KAAO,MAgIhB,QAASyd,KACP,GAAIC,GAASrjB,EAAU6L,SAASwX,MAOhC,IANe,WAAXA,IACFA,EAASzR,EAAEzR,MAAMmjB,UACjBtjB,EAAU6L,SAASwX,OAASA,GAI1B7pB,EAAKye,WAAaze,EAAKye,SAASC,UAAUqL,cAI5C,MAHA/pB,GAAKye,SAASC,UAAUC,eACxB3e,EAAKye,SAAShF,aACdzZ,GAAKye,SAASrI,OAGhBpW,GAAKye,SAAW,GAAIrE,QAAOzT,OACzByP,MAAOpW,EAAKoW,MAAQ,IAAMpW,EAAKoZ,SAC/B4Q,OAAQhqB,EAAKwZ,SACbyQ,UAAWjqB,EAAKqZ,MAChB2N,cAAehnB,EAAKgnB,cACpBC,WAAYjnB,EAAKinB,WACjBiD,IAAK,SACLC,SAAU,wBACV3K,aACIC,yBAA4DzG,KAAtCjR,EAAQ/H,KAAKyf,sBAA4C1X,EAAQ/H,KAAKyf,qBAC5FC,yBAA4D1G,KAAtCjR,EAAQ/H,KAAK0f,sBAA4C3X,EAAQ/H,KAAK0f,qBAC5FC,uBAAwD3G,KAApCjR,EAAQ/H,KAAK2f,oBAA0C5X,EAAQ/H,KAAK2f,mBACxFC,wBAA0D5G,KAArCjR,EAAQ/H,KAAK4f,qBAA2C7X,EAAQ/H,KAAK4f,oBAC1FC,yBAA2D7G,KAArCjR,EAAQ/H,KAAK4f,qBAA2C7X,EAAQ/H,KAAK4f,qBAE/FiK,OAAQA,EACRvK,WAAYvX,EAAQ/H,KAAKuf,SACxB6K,GAKHjE,EAAKkE,UAAW,EAChBjQ,OAAOzT,MAAM2jB,WAAWzkB,KAAK,WAC3BsgB,EAAKkE,UAAW,IAGlBrqB,EAAKye,SAAS8L,cACZ7Y,UAAW3J,EAAQ/H,KAAK+c,cACxBnL,SAAU7J,EAAQ/H,KAAK8U,gBACvBnD,OAAQ5J,EAAQ/H,KAAK6iB,cACrB2H,WAAYrE,EAAK0B,yBAzSrB5f,QAAQC,MAAM,kCACd,IAAIie,GAAO1pB,KA+HP2tB,GACFvT,UAAW,SAASqC,EAAGpI,GACrB9Q,EAAK+G,UAAY+J,EACjBvK,EAAWkkB,aAAe3Z,EAC1BvK,EAAWoO,MAAM,WAAY7D,GAC7B7I,QAAQC,MAAM,6BAA8B4I,GAExCtO,QAAQoF,WAAW9H,IACrBA,EAASoZ,EAAGpI,IAIhB4Z,UAAW,SAASxR,EAAG+O,EAAQ0C,EAAKve,GAGlC,OAFAnE,QAAQC,MAAM,aAAcgR,EAAG+O,EAAQ0C,EAAKve,GAEpCue,GACN,IAAKvS,GAAEzR,MAAMikB,KAAKrjB,QAAQsjB,SACxB,GAAIze,EAAO8b,QACT,OAAQ9b,EAAO8b,QAAQQ,QACrB,IAAK,4BACZtc,EAAO8b,QAAQ4C,aAAgB1e,EAAO8b,QAAQ6C,YACtD9iB,QAAQ8D,IAAI,6BACZ2d,IACA1B,EAAgB9O,EAAG+O,EAAQ7b,EAAO8b,SAClChN,kBAEiB,MACF,KAAK,4BACZ9O,EAAO8b,QAAQ4C,aAAgB1e,EAAO8b,QAAQ6C,YACtD9iB,QAAQ8D,IAAI,6BACZ2d,KAKW,KAKF,KAAKtR,GAAEzR,MAAMikB,KAAKrjB,QAAQyO,KACxB,GAAItW,GAAO0M,EAAO1M,KACduM,EAAOG,EAAO4e,eAAiB5e,EAAOH,IAC1C,KAAKvM,EAEH,WADAuI,SAAQ8D,IAAI,2BAA4BK,EAG1C7F,GAAWoO,MAAM,mBACf1I,KAAMA,EACNvM,KAAMA,GAER,MACF,KAAK0Y,GAAEzR,MAAMikB,KAAKrjB,QAAQ9H,QACpB8G,EAAWyF,OAAO,aAClB,MACN,KAAKoM,GAAEzR,MAAMikB,KAAKrjB,QAAQ0jB,YACpB1kB,EAAWoO,MAAM,eACfuW,oBAAqB9e,EAAO8e,qBAE9B,MACN,SACEjjB,QAAQkjB,KAAK,iCAAkCR,EAAK1C,EAAQ7b,KAKlEgf,cAAe,SAASvqB,GAOtB,OANKb,EAAKqN,OACRrN,EAAKqN,KAAOxM,GAIdoH,QAAQC,MAAM,iBAAkBrH,GACxBA,EAAEwqB,MAAMxoB,MACd,IAAK,UACH2Z,EAAa3b,EAAEuL,OAAO2F,iBACtB,MACF,KAAK,SACH9J,QAAQC,MAAM,WAAYrH,EAAEyqB,aAC5BtrB,EAAKsY,UAAY,QACjB,MACF,KAAK,QACHrQ,QAAQC,MAAM,cAAerH,EAAEyqB,aAC/BtrB,EAAKsY,UAAY,SACjBvF,GACA,MACF,KAAK,SACH9K,QAAQC,MAAM,cAAerH,EAAEyqB,aAC/BtrB,EAAKsY,UAAY,SACjB6D,EAAWtb,EAAE0qB,UAAU1oB,KAAMhC,EAAEuL,QAC7C8O,iBACc,MACF,KAAK,SACHjT,QAAQC,MAAM,0BAA4BrH,EAAE2qB,OAC5CxrB,EAAKsY,UAAY,QACjB,MACF,KAAK,UACHrQ,QAAQC,MAAM,eAAiBrH,EAAE2qB,OAC7B3qB,EAAEuL,OAAO0e,YACX5E,EAAeC,IAEfuD,IACKvD,EAAKkE,UACRjE,IAGJ,MACF,SACEne,QAAQkjB,KAAK,+BAAgCtqB,KAKnD0V,UAAW,SAAS2C,EAAGpI,GACrB7I,QAAQC,MAAM,aAAc4I,GAC5BvK,EAAWoO,MAAM,WAAY7D,IAG/B2a,QAAS,SAASvS,EAAGpY,GACnBmH,QAAQC,MAAM,WAAYpH,KAI1BqlB,EAAO1pB,IAiDPuD,GAAK0rB,UACP9B,IAEAxR,EAAEuT,MAAMC,WAAWhC,GAAc,GAAM,IAI3C8B,UAAW,SAAS5rB,GAClBsY,EAAEuT,MAAMC,WAAW9rB,GAAU,GAAM,IAQrCsW,MAAO,SAAStW,GACdE,EAAKye,SAASoN,WACZzV,MAAOpW,EAAKoW,MAAQ,IAAMpW,EAAKoZ,SAC/B4Q,OAAQhqB,EAAKwZ,WAEfxZ,EAAKye,SAASrI,QAEV5T,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,UAAU,IAU5B3hB,WAAY,SAASgD,GACnBmI,QAAQC,MAAM,sCAEdlI,EAAKye,SAAShF,SACdzZ,EAAK+G,WAAY,EAEjBkB,QAAQC,MAAM,mCAEV1F,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,SAAUze,EAAK+G,YASjCsG,KAAM,SAAS9Q,EAAauD,EAAUgsB,GACpC7jB,QAAQC,MAAM,kCAAoC3L,EAAc,IAEhE,IAAI8Q,GAAOrN,EAAKye,SAASsN,QAAQvpB,QAAQgL,QACvCwe,mBAAoBzvB,EACpBsV,eAAgB7R,EAAK6C,KACrBkP,iBAAkB/R,EAAKisB,SAAWjsB,EAAKisB,SAAWjsB,EAAKoL,MACvDiW,kBAAmBtZ,EAAQ/H,KAAKqhB,kBAChCC,kBAAmBvZ,EAAQ/H,KAAKshB,kBAChC/E,SAAUxU,EAAQ/H,KAAKuc,SACvBO,UAAW/U,EAAQ/H,KAAK8c,UACxBpL,UAAW3J,EAAQ/H,KAAK+c,cACxBnL,SAAU7J,EAAQ/H,KAAK8U,gBACvBnD,OAAQ5J,EAAQ/H,KAAK6iB,cACrBqJ,OAAQnkB,EAAQ/H,KAAK6gB,UACrB7O,YAAajK,EAAQ/H,KAAKgS,YAC1BF,eACE1G,MAAQrD,EAAQ/H,KAAKoL,MACrB+gB,OAAQ,8BAAgC7pB,IAAIyF,EAAQ/H,KAAKoL,OAAS,eAEnE0gB,GAEH9rB,GAAKqN,KAAOA,EAEZrN,EAAKkN,UAAW,EAChBlN,EAAKoN,YAAa,EAEd5K,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,SAAUpR,IAI5BuI,YAAa,SAASrZ,EAAauD,GAG/B,GAAIqmB,GAAO1pB,IAElB,IAAmC,WAA/BsL,EAAQ/H,KAAKonB,cAA4B,CAElCnf,QAAQ8D,IAAI,4BAA8BhE,EAAQ/H,KAAKonB,cAE9D,IAAI/Z,GAAOrN,EAAKye,SAASsN,SAC5BC,mBAAoBzvB,EAAc,UAClCsV,eAAgB7R,EAAK6C,KAAO,YAC5BkP,iBAAkB/R,EAAKoW,MAAQ,YAC/BiL,kBAAmBtZ,EAAQ/H,KAAKqhB,kBAChCC,kBAAmBvZ,EAAQ/H,KAAKshB,kBAChC5P,UAAW3J,EAAQ/H,KAAKonB,cACxB7K,UAAU,EACVuO,aAAa,EACboB,OAAQnkB,EAAQ/H,KAAK6gB,UACrB7O,YAAajK,EAAQ/H,KAAKgS,YAC1BF,eACI1G,MAAQrD,EAAQ/H,KAAKoL,MACrB+gB,OAAQ,8BAAgC7pB,IAAIyF,EAAQ/H,KAAKoL,OAAS,eA+BnE,OA1BOiC,GAAK+e,IAAI3V,QAAQ2T,UAAUiC,SAAW,SAASD,EAAKvK,GAS9D,QAASyK,KACFnG,EAAKnmB,KAAK6V,YAChBsQ,EAAKrQ,oBACL7N,QAAQ8D,IAAI,sBAXV8V,GACmBA,EAAO0K,iBAAiB,GAC9BhsB,iBAAiB,QAAS+rB,GAI1CrkB,QAAQ8D,IAAI,wBAUF/L,EAAK6V,UAAYxI,EAEjBpF,QAAQ8D,IAAI,YAAa/L,GAEzBA,EAAKkN,UAAW,EAChBlN,EAAKoN,YAAa,MAElB+Y,GAAK/F,iBAMXnY,QAAQ8D,IAAI,4BAA8BhE,EAAQ/H,KAAKonB,cAEvD,IAAIoF,GAAa,SAAS1uB,EAAOC,EAAUC,GAEzC,GAAGF,EAED,WADAyI,GAAWoO,MAAM,6BAA8B7W,EAIjD,IAAI2uB,GAAazsB,EAAKye,SAASsN,SAC7BC,mBAAoBzvB,EAAc,UAClCsV,eAAgB7R,EAAK6C,KAAO,YAC5BkP,iBAAkB/R,EAAKoW,MAAQ,YAC/BiL,kBAAmBtZ,EAAQ/H,KAAKqhB,kBAChCC,kBAAmBvZ,EAAQ/H,KAAKshB,kBAChCP,YAAa/iB,EAAqBA,EAAmBE,MAAMC,aAC3Doe,UAAU,EACVuO,aAAa,EACboB,OAAQnkB,EAAQ/H,KAAK6gB,UACrB7O,YAAajK,EAAQ/H,KAAKgS,YAC1BF,eACE1G,MAAQrD,EAAQ/H,KAAKoL,MACrB+gB,OAAQ,8BAAgC7pB,IAAIyF,EAAQ/H,KAAKoL,OAAS,eAKtEqhB,GAAWL,IAAI3V,QAAQ2T,UAAUiC,SAAW,SAASD,EAAKvK,GASxD,QAASyK,KACJnG,EAAKnmB,KAAK6V,YACXsQ,EAAKrQ,oBACL7N,QAAQ8D,IAAI,sBAXb8V,GACiBA,EAAO0K,iBAAiB,GAC9BhsB,iBAAiB,QAAS+rB,GAIxCrkB,QAAQ8D,IAAI,wBAUd/L,EAAK6V,UAAY4W,EAEjBxkB,QAAQ8D,IAAI,YAAa/L,GAEzBA,EAAKkN,UAAW,EAChBlN,EAAKoN,YAAa,EAGnBjN,WAAUC,gBACZosB,IAEO3sB,YAAY2sB,IAKpB1W,kBAAmB,WACjB,IAAK9V,EAAK6V,UAER,MADA5N,SAAQC,MAAM,gCACP,CAGTD,SAAQ8D,IAAI,gBAAiB/L,EAAK6V,WAClC7V,EAAK6V,UAAUjJ,SAEf3E,QAAQC,MAAM,+BAShB0E,OAAQ,SAAS9M,GAGf,GAFAmI,QAAQC,MAAM,2CAETlI,EAAKqN,KAER,MADApF,SAAQC,MAAM,gCACP,CAGTlI,GAAKqN,KAAKT,SAEN5M,EAAKmM,OACPnM,EAAKmM,KAAKwd,UACV3pB,EAAKmM,KAAO,MAGdlE,QAAQC,MAAM,wBAEV1F,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,UAAU,IAU5B/D,KAAM,SAAS1P,EAAQlL,GAGrB,GAFAmI,QAAQC,MAAM,4BAA8B8C,EAAS,OAEhDhL,EAAKqN,KAER,MADApF,SAAQC,MAAM,mCACP,CAGTlI,GAAKqN,KAAKqN,KAAK1P,EAAO0hB,YACtBzkB,QAAQC,MAAM,mCAEV1F,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,UAAU,IAS5B/K,UAAW,SAASlI,GAElBxL,EAAKye,SAASC,UAAUiO,UAAU,OAAY,SAAS7rB,EAAGd,GACxD,GAAI4sB,GAASpvB,KAAKqvB,KAAkB,IAAb7sB,EAAK+d,OACxB+O,EAAWtvB,KAAKqvB,KAAoB,IAAf7sB,EAAK6d,QAG1B9V,GAAQ/H,KAAK8W,WACf/O,EAAQ/H,KAAKshB,kBAAoBwL,EACjC/kB,EAAQ/H,KAAKqhB,kBAAoBuL,EACjC7kB,EAAQ/H,KAAK6gB,WAAY,EACzB9Y,EAAQ/H,KAAK0d,QAAU,KAEnBkP,EAAS,IACX7kB,EAAQ/H,KAAK0d,QAAU,QAEhBkP,EAAS,IAChB7kB,EAAQ/H,KAAK0d,QAAU,OAEhBkP,EAAS,OAChB7kB,EAAQ/H,KAAK0d,QAAU,QAIxBlS,GACDA,EAAGxL,GAGLuG,EAAWoO,MAAM,YAAa3U,MAQlCsO,QAAS,SAASxO,GAGhB,GAFAmI,QAAQC,MAAM,iDAETlI,EAAKqN,KAER,MADApF,SAAQC,MAAM,8BACP,CAGTlI,GAAKqN,KAAKqN,KAAK,KACf1a,EAAKkN,UAAYlN,EAAKkN,SACtBjF,QAAQC,MAAM,mCAEV1F,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,UAAU,IAS5BjQ,UAAW,SAAS1O,GAGlB,GAFAmI,QAAQC,MAAM,mDAETlI,EAAKqN,KAER,MADApF,SAAQC,MAAM,8BACP,CAGTlI,GAAKqN,KAAKqN,KAAK,MACf1a,EAAKoN,YAAcpN,EAAKoN,WACxBnF,QAAQC,MAAM,qCAEV1F,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,UAAU,IAM5BxQ,mBAAoB,SAAS1G,GAC3BvH,EAAKmM,KAAK4gB,SAASxlB,EAAS,YAE9B4H,YAAa,SAAShB,EAAUe,GAC9BlP,EAAKmM,KAAK+c,WAAW,aAAc/a,EAAUe,IAE/CG,aAAc,SAASlB,EAAUe,GAC/BlP,EAAKmM,KAAK+c,WAAW,sBAAuB/a,EAAUe,IAExDK,SAAU,SAASpB,EAAUe,GAC3BlP,EAAKmM,KAAK+c,WAAW,YAAa/a,EAAUe,IAK9CP,iBAAkB,SAASR,EAAU3D,GACnCxK,EAAKmM,KAAK+c,WAAW,aAAc/a,EAAU3D,IAM/CwiB,YAAa,SAASttB,EAAMI,GAC1BE,EAAKqN,KAAK9F,SACR0lB,GAAIjtB,EAAKsmB,aACT5mB,KAAMA,EACNsrB,cAAehrB,EAAK6C,KACpBqqB,gBAAiBltB,EAAK8mB,MAGpBtkB,QAAQoF,WAAW9H,IACrBA,EAASE,EAAKye,UAAU,OASlC,IAAIsH,cAAevjB,QAAQC,OAAO,eAElCsjB,cAAaC,QAAQ,UAAW,aAAc,QAAS,YAAa,UAAW,QAC7E,SAASzf,EAAY4C,EAAO3C,EAAWuB,EAASpB,GAgF9C,OACEwmB,UAhFc,WAIXplB,EAAQ/H,KAAK6C,OACd8D,EAAM3G,KAAK6C,KAAOkF,EAAQ/H,KAAK6C,MAE9BkF,EAAQ/H,KAAKoL,QACdzE,EAAM3G,KAAKoL,MAAQrD,EAAQ/H,KAAKoL,OAE/BrD,EAAQ/H,KAAKoW,QACdzP,EAAM3G,KAAKoW,MAAQrO,EAAQ/H,KAAKoW,OAE/BrO,EAAQ/H,KAAKwZ,WACd7S,EAAM3G,KAAKwZ,SAAWzR,EAAQ/H,KAAKwZ,SAOrC,IAAI9I,GAAMhU,OAAO0K,SAASuJ,OAASjU,OAAO0K,SAASwJ,QAuDnD,OAtDkBzH,GAAM0H,IAAIH,EAAM,2BAA6BlT,KAAK4vB,MAAqB,IAAd5vB,KAAK6vB,SAAkB,IAErE3lB,KAAK,SAASwB,GACzC,GAAIlJ,GAAOkJ,EAASlJ,KAGhB6C,EAAO8D,EAAM3G,KAAK6C,KAClBuI,EAAQzE,EAAM3G,KAAKoL,KAyCvB,OAvCAnD,SAAQC,MAAM,gBAAkBlI,EAAKstB,aACjCttB,EAAKstB,cACP3mB,EAAM3G,KAAKstB,YAActtB,EAAKstB,YAC9B3mB,EAAM3G,KAAKutB,eAAiBvtB,EAAKutB,gBAG/BvtB,EAAKgnB,gBACPrgB,EAAM3G,KAAKgnB,cAAgBhnB,EAAKgnB,eAG9BhnB,EAAKinB,aACPtgB,EAAM3G,KAAKinB,WAAajnB,EAAKinB,YAG/BzkB,QAAQgL,OAAO7G,EAAM3G,KAAMA,GAMf,IAAR6C,GAA2B,IAAb7C,EAAK6C,OACrB8D,EAAM3G,KAAK6C,KAAOA,GAEP,IAATuI,GAA6B,IAAdpL,EAAKoL,QACtBzE,EAAM3G,KAAKoL,MAAQA,GAEG,IAApBzE,EAAM3G,KAAKoW,OAAsC,IAAvBzP,EAAM3G,KAAKwZ,UAAwC,IAAtBzR,EAAQ/H,KAAKoW,OAAwC,IAAzBrO,EAAQ/H,KAAKwZ,WAClG7S,EAAM3G,KAAKoW,MAAQrO,EAAQ/H,KAAKoW,MAChCzP,EAAM3G,KAAKwZ,SAAWzR,EAAQ/H,KAAKwZ,UAGT,QAAxB7S,EAAM3G,KAAKwtB,WAAwB7mB,EAAM3G,KAAKytB,iBAChDxlB,QAAQC,MAAM,8BACdvB,EAAM3G,KAAKytB,gBAAiB,GAG3B9mB,EAAM3G,KAAKwtB,WAAazlB,EAAQ/H,KAAK6C,KAAKxF,QAAU0K,EAAQ/H,KAAKoL,MAAM/N,QAAU0K,EAAQ/H,KAAKoW,MAAM/Y,QAAU0K,EAAQ/H,KAAKwZ,SAASnc,QACrIkJ,EAAWoO,MAAM,sBAAuB3U,GAEnCkJ,GACN,SAASA,GAEV,MADA3C,GAAWoO,MAAM,oBAAqBzL,GAC/BA,SAab1G,QACGC,OAAO,gBACPujB,QAAQ,cAAe,aAAc,KAAM,UAAW,QACrD,SAASzf,EAAY8P,EAAItO,EAASpB,GAEhC,GAAIqV,MAEAnV,EAAO,WACT,GAAI6mB,GAAIC,CAIR,QAAU3U,KAFV0U,EAAK1R,EAAO4R,SAIV,WADArnB,GAAWoO,MAAM,sBAGnBgZ,GAAYD,GAEZ,IAAIG,GAAmB,WACrBtnB,EAAWoO,MAAM,mBAGnBgZ,GAAUjmB,KACR,WACEmmB,KAEF,WACEA,MAaN,QACEhnB,KAAQA,EACRuL,QAVY,WACZ7L,EAAWK,IAAI,kBAAmB,SAAUqC,GAC1CpC,MAGFA,KAMAmV,OAAUA,MAMpB,WACE,YACmBxZ,SAAQC,OAAO,kBAAmB,iBAKrDD,QACCC,OAAO,kBACPujB,QAAQ,WAAY,aAAc,gBACnC,SAASzf,EAAYunB,GA4CnB,QAASzO,GAAW0O,GAClB3T,OAAO5M,QAAO,EAAMxN,EAAM+tB,GA5C5B,GAAI/tB,GAAO8tB,EACdE,GACE1U,cAAc,EACPC,cAAc,EACdhI,SAAU,EACVE,cAAe,GACf8K,UAAU,EACVhK,gBACAE,mBACA2J,YAAY,EACZvZ,KAAM,GACNuI,MAAO,GACPgL,MAAO,GACPoD,SAAU,GACV1G,WAAY,eACZ1F,YAAY,EACZF,UAAU,EACVoG,SAAS,EACTyJ,cAAe,KACfqC,kBAAmB,KACnByD,cAAe,KACfuE,cAAe,KACftS,gBAAiB,KACjBgI,WAAW,EACXyC,SAAS,EACTsB,WAAW,EACX7O,aAAa,EACbqP,kBAAmB,UACnBC,kBAAmB,UACnB5D,YAAS1E,GACT+C,gBAAgB,EAChB2D,sBAAsB,EACtBC,oBAAoB,EACpBF,sBAAsB,EACtBG,qBAAqB,EACrB9I,UAAU,EACVrD,eAAe,EACf2N,cAAe,KACf7I,aAAUS,GAShB,OANAhZ,GAAKiuB,SAASD,IAOZhuB,KAAMA,EACNqf,WAAYA,EACZ1F,MAAO,WACL3Z,EAAKsZ,cAAe,EACpBtZ,EAAKuZ,cAAe,EACpBvZ,EAAKuR,SAAW,EAChBvR,EAAK8S,WAAa,gBAEpB2N,aAAc,WACZyN,aAAajb,QAEbjT,EAAKmuB,OAAOH,QAQlBxrB,QACCC,OAAO,kBACP2rB,QAAQ,eAAgB,UAAW,SAASrmB,GAE3C,GAAIsmB,GAAUtmB,EAAQ/H,KAAKuS,aACvBE,EAAkB1K,EAAQ/H,KAAKyS,gBAE/B6b,EAAmB,SAAStjB,EAAQujB,EAAW7lB,OAC3BsQ,IAAnBqV,EAAQrjB,KACTqjB,EAAQrjB,OAGVqjB,EAAQrjB,GAAQiU,SACdjU,OAAUA,EACVujB,UAAaA,EACb7lB,OAAUA,EACV0T,WAActQ,QAGhB,IAAI8B,GAAQ6E,EAAgBhS,QAAQuK,EACpC/C,SAAQ8D,IAAI6B,GACTA,GAAS,GACV6E,EAAgB1F,OAAOa,EAAO,GAGhC6E,EAAgBwM,QAAQjU,IAItBwjB,EAAsB,SAASxjB,GACjC,MAAOqjB,GAAQrjB,GAGjB,QACEwH,IAAK,WACH,MAAO6b,IAET3b,YAAa,WACX,MAAOD,IAET5B,IAAK,SAAS7F,GACZ,MAAOwjB,GAAoBxjB,IAE7BkH,IAAK,SAASlH,EAAQujB,EAAW7lB,GAC/B,MAAO4lB,GAAiBtjB,EAAQujB,EAAW7lB,IAE7CuK,MAAO,WAKL,MAJAlL,GAAQ/H,KAAKuS,gBACbxK,EAAQ/H,KAAKyS,mBACb4b,EAAUtmB,EAAQ/H,KAAKuS,aACvBE,EAAkB1K,EAAQ/H,KAAKyS,qBAQrCjQ,QACGC,OAAO,kBACPujB,QAAQ,gBAAiB,aAAc,KAAM,UAAW,SAAU,QAAS,aAC1E,SAASzf,EAAY8P,EAAItO,EAASnD,EAAQ+B,EAAO2C,GAE/C,GAAImlB,GAAe,WACjB,MAAOpY,GAAG,SAASwF,EAASC,GAC1B,GAAIvT,GAAW,kBACX2R,GACF3R,SAAYA,EACZK,MAAQ,EACRF,OAAU,UACVnB,QAAW+B,EAAWyF,QAAQ,yBAE3B5O,WAAUuuB,aAAazL,eAC1B/I,EAAe,OAAI,QACnBA,EAAgB,QAAI5Q,EAAWyF,QAAQ,0BACvC+M,EAAO5B,IAGT2B,EAAQ3B,MAKRyU,EAAiB,WACnB,MAAOtY,GAAG,SAASwF,EAASC,GAC1B,GAAIvT,GAAW,aACX2R,GACF3R,SAAYA,EACZK,MAAQ,EACRF,OAAU,UACVnB,QAAW+B,EAAWyF,QAAQ,0BAGhCpI,GAAM+kB,UAAU,SAAShjB,GACnBA,IACFwR,EAAe,OAAI,QACnBA,EAAgB,QAAI5Q,EAAWyF,QAAQ,0BACvCpI,EAAM3G,KAAK0rB,WAAY,EACvB5P,EAAO5B,IAETvT,EAAM3G,KAAK0rB,WAAY,EACvB7P,EAAQ3B,QAKV0U,EAAsB,WACxB,MAAOvY,GAAG,SAASwF,EAASC,GAC1B,GAAIvT,GAAW,kBACX2R,GACFxR,OAAU,UACVE,MAAQ,EACRL,SAAYA,EACZhB,QAAW+B,EAAWyF,QAAQ,yBAGhCpI,GAAMyZ,eAAe,SAAS1X,GAC5B/B,EAAMugB,uBAAuB,WAC3BrL,EAAQ3B,UAOZ2U,EAAuB,WACzB,MAAOxY,GAAG,SAASwF,EAASC,GAe1B,QAAStQ,GAAGxL,GACV6b,EAAQ3B,GAfV,GAAI3R,GAAW,yBACX2R,GACFxR,OAAU,UACVE,MAAQ,EACRL,SAAYA,EACZhB,QAAW+B,EAAWyF,QAAQ,0BAG5BhH,GAAQ/H,KAAK8W,UAAYnQ,EAAM3G,KAAKye,SACtC9X,EAAM+M,UAAUlI,GAEhBqQ,EAAQ3B,MASV4U,EAAkB,WACpB,MAAOzY,GAAG,SAASwF,EAASC,GAC1B,GAAIvT,GAAW,mBACX2R,GACFxR,OAAU,UACVE,MAAQ,EACRL,SAAYA,EACZhB,QAAW+B,EAAWyF,QAAQ,4BAG5BggB,EAAiBnqB,EAAOuoB,YAExB6B,EAAgBD,EAAernB,KACjC,SAASwB,GAKP,MAAGA,GAASR,QAAU,KAAOQ,EAASR,QAAU,IACvCwR,GAEPA,EAAe,OAAI,QACnBA,EAAgB,QAAI5Q,EAAWyF,QAAQ,2BAChCmL,IAIXA,GAAgB,QAAI8U,EAEpBnT,EAAQ3B,MAIV+U,EAAa,WACf,MAAO5Y,GAAG,SAASwF,EAASC,GAC1B,GAAIvT,GAAW,cACX2R,GACFxR,OAAU,UACVE,MAAQ,EACRL,SAAYA,EACZhB,QAAW+B,EAAWyF,QAAQ,eAGhC,IAAGpI,EAAM3G,KAAKmZ,YAAcxS,EAAM3G,KAAK+G,UAErC,WADA8U,GAAQ3B,EAIV,IAAIgV,GAAkB,WAKhBnnB,EAAQ/H,KAAKsZ,cAAgBvR,EAAQ/H,KAAKuZ,eAAiB5S,EAAM3G,KAAKmZ,aACxExS,EAAM3G,KAAKoZ,SAAWrR,EAAQ/H,KAAKoZ,UAAYzS,EAAM3G,KAAKoZ,SAC1DzS,EAAM3G,KAAKqZ,MAAQtR,EAAQ/H,KAAKqZ,OAAS1S,EAAM3G,KAAKqZ,MACpD1S,EAAM3G,KAAK6C,KAAOkF,EAAQ/H,KAAK6C,KAC/B8D,EAAM3G,KAAKoL,MAAQrD,EAAQ/H,KAAKoL,MAChCzE,EAAM3G,KAAKoW,MAAQrO,EAAQ/H,KAAKoW,MAChCzP,EAAM3G,KAAKwZ,SAAWzR,EAAQ/H,KAAKwZ,SAEnC7S,EAAM3G,KAAKmZ,YAAa,EACxBxS,EAAMrK,QAAQ,SAAS4c,EAAGnS,GACxBJ,EAAM3G,KAAKmZ,YAAa,EACxB0C,EAAQ3B,MAKXnS,GAAQ/H,KAAKsZ,cAAgBvR,EAAQ/H,KAAKuZ,aAC3C2V,IAEArT,EAAQ3B,MAKViV,GACFV,EACAE,EACAC,EACAE,EACAG,EACAJ,GAGEO,GACF9lB,EAAWyF,QAAQ,yBACnBzF,EAAWyF,QAAQ,0BACnBzF,EAAWyF,QAAQ,yBACnBzF,EAAWyF,QAAQ,2BACnBzF,EAAWyF,QAAQ,eACnBzF,EAAWyF,QAAQ,2BAGjB/F,EAAqB,SAASP,GAChC,WAAyCuQ,IAAtCoW,EAAiB3mB,GACX2mB,EAAiB3mB,GAEjBa,EAAWyF,QAAQ,gBAI1BtG,GAAoB,EACpBN,EAAsB,EAEtBknB,EAAoB,SAASzhB,GAC/B,GAAI0hB,EAIJ,OAFAA,GAAY1hB,EAAQ,EACpBzF,EAAuBmnB,EAAYH,EAAS9xB,OAAU,IA8CxD,QACEwJ,KA3CiB,WACjB,GAAI6mB,GAAIC,EAAWjlB,EAAQG,EAAWN,EAAUK,EAAMrB,EAASoB,CAI/D,IAHAE,GAAY,IACZJ,GAEuB0mB,EAAS9xB,OAE9B,WADAkJ,GAAWoO,MAAM,oBAAqBlM,EAIxCilB,GAAKyB,EAAS1mB,GACdklB,EAAYD,GAEZ,IAAIG,GAAmB,SAASF,OACH3U,IAAxB2U,EAAmB,UACpBhlB,EAAUglB,EAAmB,SAG/BjlB,EAASilB,EAAkB,OAC3B/kB,EAAO+kB,EAAgB,KACvBplB,EAAWolB,EAAoB,SAC/BpmB,EAAUomB,EAAmB,QAEhB,WAAVjlB,IACDG,GAAY,GAGdtC,EAAWoO,MAAM,gBAAiBlM,EAAkBC,EAAQC,EAASJ,EAAUK,EAAMC,EAAWtB,GAIlGomB,GAAUjmB,KACR,SAASimB,GACPE,EAAiBF,IAEnB,SAASA,GACPE,EAAiBF,MAQrB3kB,mBAAsBA,EACtBb,oBAAuBA,EACvBW,UAAaumB","file":"scripts.js","sourcesContent":["// Last time updated at Oct 24, 2015, 08:32:23\n\n// Latest file can be found here: https://cdn.webrtc-experiment.com/getScreenId.js\n\n// Muaz Khan         - www.MuazKhan.com\n// MIT License       - www.WebRTC-Experiment.com/licence\n// Documentation     - https://github.com/muaz-khan/getScreenId.\n\n// ______________\n// getScreenId.js\n\n/*\ngetScreenId(function (error, sourceId, screen_constraints) {\n    // error    == null || 'permission-denied' || 'not-installed' || 'installed-disabled' || 'not-chrome'\n    // sourceId == null || 'string' || 'firefox'\n\n    if(sourceId == 'firefox') {\n        navigator.mozGetUserMedia(screen_constraints, onSuccess, onFailure);\n    }\n    else navigator.webkitGetUserMedia(screen_constraints, onSuccess, onFailure);\n});\n*/\n\n(function() {\n    window.getScreenId = function(callback) {\n        // for Firefox:\n        // sourceId == 'firefox'\n        // screen_constraints = {...}\n        if (!!navigator.mozGetUserMedia) {\n            callback(null, 'firefox', {\n                video: {\n                    mozMediaSource: 'window',\n                    mediaSource: 'window'\n                }\n            });\n            return;\n        }\n\n        postMessage();\n\n        window.addEventListener('message', onIFrameCallback);\n\n        function onIFrameCallback(event) {\n            if (!event.data) return;\n\n            if (event.data.chromeMediaSourceId) {\n                if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\n                    callback('permission-denied');\n                } else callback(null, event.data.chromeMediaSourceId, getScreenConstraints(null, event.data.chromeMediaSourceId));\n            }\n\n            if (event.data.chromeExtensionStatus) {\n                callback(event.data.chromeExtensionStatus, null, getScreenConstraints(event.data.chromeExtensionStatus));\n            }\n\n            // this event listener is no more needed\n            window.removeEventListener('message', onIFrameCallback);\n        }\n    };\n\n    function getScreenConstraints(error, sourceId) {\n        var screen_constraints = {\n            audio: false,\n            video: {\n                mandatory: {\n                    chromeMediaSource: error ? 'screen' : 'desktop',\n                    maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                    maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                },\n                optional: []\n            }\n        };\n\n        if (sourceId) {\n            screen_constraints.video.mandatory.chromeMediaSourceId = sourceId;\n        }\n\n        return screen_constraints;\n    }\n\n    function postMessage() {\n        if (!iframe) {\n            loadIFrame(postMessage);\n            return;\n        }\n\n        if (!iframe.isLoaded) {\n            setTimeout(postMessage, 100);\n            return;\n        }\n\n        iframe.contentWindow.postMessage({\n            captureSourceId: true\n        }, '*');\n    }\n\n    function loadIFrame(loadCallback) {\n        if (iframe) {\n            loadCallback();\n            return;\n        }\n\n        iframe = document.createElement('iframe');\n        iframe.onload = function() {\n            iframe.isLoaded = true;\n\n            loadCallback();\n        };\n        iframe.src = 'https://www.webrtc-experiment.com/getSourceId/'; // https://wwww.yourdomain.com/getScreenId.html\n        iframe.style.display = 'none';\n        (document.body || document.documentElement).appendChild(iframe);\n    }\n\n    var iframe;\n\n    // this function is used in v3.0\n    window.getScreenConstraints = function(callback) {\n        loadIFrame(function() {\n            getScreenId(function(error, sourceId, screen_constraints) {\n                callback(error, screen_constraints.video);\n            });\n        });\n    };\n})();\n\n(function() {\n    if(document.domain.indexOf('webrtc-experiment.com') === -1) {\n        return;\n    }\n\n    window.getScreenId = function(callback) {\n        // for Firefox:\n        // sourceId == 'firefox'\n        // screen_constraints = {...}\n        if (!!navigator.mozGetUserMedia) {\n            callback(null, 'firefox', {\n                video: {\n                    mozMediaSource: 'window',\n                    mediaSource: 'window'\n                }\n            });\n            return;\n        }\n\n        postMessage();\n\n        window.addEventListener('message', onIFrameCallback);\n\n        function onIFrameCallback(event) {\n            if (!event.data) return;\n\n            if (event.data.chromeMediaSourceId) {\n                if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\n                    callback('permission-denied');\n                } else callback(null, event.data.chromeMediaSourceId, getScreenConstraints(null, event.data.chromeMediaSourceId));\n            }\n\n            if (event.data.chromeExtensionStatus) {\n                callback(event.data.chromeExtensionStatus, null, getScreenConstraints(event.data.chromeExtensionStatus));\n            }\n\n            // this event listener is no more needed\n            window.removeEventListener('message', onIFrameCallback);\n        }\n    };\n\n    function getScreenConstraints(error, sourceId) {\n        var screen_constraints = {\n            audio: false,\n            video: {\n                mandatory: {\n                    chromeMediaSource: error ? 'screen' : 'desktop',\n                    maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                    maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                },\n                optional: []\n            }\n        };\n\n        if (sourceId) {\n            screen_constraints.video.mandatory.chromeMediaSourceId = sourceId;\n        }\n\n        return screen_constraints;\n    }\n\n    function postMessage() {\n        if (!iframe) {\n            loadIFrame(postMessage);\n            return;\n        }\n\n        if (!iframe.isLoaded) {\n            setTimeout(postMessage, 100);\n            return;\n        }\n\n        iframe.contentWindow.postMessage({\n            captureSourceId: true\n        }, '*');\n    }\n\n    function loadIFrame(loadCallback) {\n        if (iframe) {\n            loadCallback();\n            return;\n        }\n\n        iframe = document.createElement('iframe');\n        iframe.onload = function() {\n            iframe.isLoaded = true;\n\n            loadCallback();\n        };\n        iframe.src = 'https://www.webrtc-experiment.com/getSourceId/'; // https://wwww.yourdomain.com/getScreenId.html\n        iframe.style.display = 'none';\n        (document.body || document.documentElement).appendChild(iframe);\n    }\n\n    var iframe;\n\n    // this function is used in v3.0\n    window.getScreenConstraints = function(callback) {\n        loadIFrame(function() {\n            getScreenId(function(error, sourceId, screen_constraints) {\n                callback(error, screen_constraints.video);\n            });\n        });\n    };\n})();\n\n/*\n * JavaScript MD5 1.0.1\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n!function(a){\"use strict\";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c=\"\";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;16>c;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d=\"0123456789abcdef\",e=\"\";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}\"function\"==typeof define&&define.amd?define(function(){return t}):a.md5=t}(this);\n/*\nThe MIT License (MIT)\n\nCopyright (c) 2014 Chris Wilson\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n/*\n\nUsage:\naudioNode = createAudioMeter(audioContext,clipLevel,averaging,clipLag);\n\naudioContext: the AudioContext you're using.\nclipLevel: the level (0 to 1) that you would consider \"clipping\".\n   Defaults to 0.98.\naveraging: how \"smoothed\" you would like the meter to be over time.\n   Should be between 0 and less than 1.  Defaults to 0.95.\nclipLag: how long you would like the \"clipping\" indicator to show\n   after clipping has occured, in milliseconds.  Defaults to 750ms.\n\nAccess the clipping through node.checkClipping(); use node.shutdown to get rid of it.\n*/\n\nfunction createAudioMeter(audioContext,clipLevel,averaging,clipLag) {\n\tvar processor = audioContext.createScriptProcessor(512);\n\tprocessor.onaudioprocess = volumeAudioProcess;\n\tprocessor.clipping = false;\n\tprocessor.lastClip = 0;\n\tprocessor.volume = 0;\n\tprocessor.clipLevel = clipLevel || 0.98;\n\tprocessor.averaging = averaging || 0.95;\n\tprocessor.clipLag = clipLag || 750;\n\n\t// this will have no effect, since we don't copy the input to the output,\n\t// but works around a current Chrome bug.\n\tprocessor.connect(audioContext.destination);\n\n\tprocessor.checkClipping =\n\t\tfunction(){\n\t\t\tif (!this.clipping)\n\t\t\t\treturn false;\n\t\t\tif ((this.lastClip + this.clipLag) < window.performance.now())\n\t\t\t\tthis.clipping = false;\n\t\t\treturn this.clipping;\n\t\t};\n\n\tprocessor.shutdown =\n\t\tfunction(){\n\t\t\tthis.disconnect();\n\t\t\tthis.onaudioprocess = null;\n\t\t};\n\n\treturn processor;\n}\n\nfunction volumeAudioProcess( event ) {\n\tvar buf = event.inputBuffer.getChannelData(0);\n    var bufLength = buf.length;\n\tvar sum = 0;\n    var x;\n\n\t// Do a root-mean-square on the samples: sum up the squares...\n    for (var i=0; i<bufLength; i++) {\n    \tx = buf[i];\n    \tif (Math.abs(x)>=this.clipLevel) {\n    \t\tthis.clipping = true;\n    \t\tthis.lastClip = window.performance.now();\n    \t}\n    \tsum += x * x;\n    }\n\n    // ... then take the square root of the sum.\n    var rms =  Math.sqrt(sum / bufLength);\n\n    // Now smooth this out with the averaging factor applied\n    // to the previous sample - take the max here because we\n    // want \"fast attack, slow release.\"\n    this.volume = Math.max(rms, this.volume*this.averaging);\n}\n\n(function() {\n  'use strict';\n\n  var vertoApp = angular.module('vertoApp', [\n    'timer',\n    'ngRoute',\n    'vertoControllers',\n    'vertoDirectives',\n    'vertoFilters',\n    'ngStorage',\n    'ngAnimate',\n    'ngSanitize',\n    'toastr',\n    'FBAngular',\n    'cgPrompt',\n    '720kb.tooltips',\n    'ui.gravatar',\n    'ui.bootstrap',\n    'directive.g+signin',\n    'pascalprecht.translate',\n    'angular-click-outside',\n  ]);\n\n  vertoApp.constant('configLanguages', {\n    'languages' : [\n         {id: 'en', name: 'English'},\n         {id: 'it', name: 'Italiano'},\n         {id: 'fr', name: 'Français'},\n         {id: 'de', name: 'Deutsch'},\n         {id: 'pt', name: 'Português'},\n         {id: 'pl', name: 'Polski'},\n         {id: 'zh', name: '中國'},\n         {id: 'ru', name: 'Pусский'},\n         {id: 'sv', name: 'Svenska'},\n         {id: 'da', name: 'Dansk'},\n         {id: 'es', name: 'Español'},\n         {id: 'id', name: 'Indonesia'}\n    ],\n\n    'dialects' : {\n        'en': 'en',\n        'en_GB': 'en',\n        'en_US': 'en',\n        'it': 'it',\n        'it_IT': 'it',\n        'fr': 'fr',\n        'fr_FR': 'fr',\n        'fr_CA': 'fr',\n        'pt': 'pt',\n        'pt_BR': 'pt',\n        'pt_PT': 'pt',\n        'de': 'de',\n        'de_DE': 'de',\n        'es': 'es',\n        'es_ES': 'es',\n        'pl': 'pl',\n        'pl_PL': 'pl',\n        'ru': 'ru',\n        'ru_RU': 'ru',\n        'sv': 'sv',\n        'sv_SV': 'sv',\n        'sv_FI': 'sv',\n        'da': 'da',\n        'da_DK': 'da',\n        'id': 'id',\n        'id_ID': 'id',\n        'zh': 'zh',\n        'zh_CN': 'zh',\n        'zh_TW': 'zh',\n        'zh_HK': 'zh'\n    }\n  });\n\n  vertoApp.config(['$routeProvider', 'gravatarServiceProvider', '$translateProvider', 'configLanguages',\n    function($routeProvider, gravatarServiceProvider, $translateProvider, configLanguages) {\n      $routeProvider.\n      when('/', {\n        title: 'Loading',\n        templateUrl: 'partials/splash_screen.html',\n        controller: 'SplashScreenController'\n      }).\n      when('/login', {\n        title: 'Login',\n        templateUrl: 'partials/login.html',\n        controller: 'LoginController'\n      }).\n      when('/dialpad', {\n        title: 'Dialpad',\n        templateUrl: 'partials/dialpad.html',\n        controller: 'DialPadController'\n      }).\n      when('/incall', {\n          title: 'In a Call',\n          templateUrl: 'partials/incall.html',\n          controller: 'InCallController'\n        }).\n      when('/loading', {\n        title: 'Loading Verto Communicator',\n        templateUrl: 'partials/loading.html',\n        controller: 'LoadingController'\n      }).\n      when('/preview', {\n        title: 'Preview Video',\n        templateUrl: 'partials/preview.html',\n        controller: 'PreviewController'\n      }).\n      when('/browser-upgrade', {\n        title: '',\n        templateUrl: 'partials/browser_upgrade.html',\n        controller: 'BrowserUpgradeController'\n      }).\n      otherwise({\n        redirectTo: '/'\n      });\n\n      gravatarServiceProvider.defaults = {\n        default: 'mm'  // Mystery man as default for missing avatars\n      };\n\n      var reg_langs = [];\n      angular.forEach(configLanguages.languages, function(value, key) {\n        reg_langs.push(value.id);\n      });\n\n      $translateProvider\n      .useStaticFilesLoader({\n        prefix: 'locales/locale-',\n        suffix: '.json'\n      })\n      .registerAvailableLanguageKeys(reg_langs, configLanguages.dialects)\n      .preferredLanguage('en')\n      .determinePreferredLanguage()\n      .fallbackLanguage('en')\n      .useSanitizeValueStrategy(null);\n    }\n  ]);\n\n  vertoApp.run(['$rootScope', '$location', 'toastr', 'prompt', 'verto',\n    function($rootScope, $location, toastr, prompt, verto) {\n\n      $rootScope.$on( \"$routeChangeStart\", function(event, next, current) {\n        if (!verto.data.connected) {\n          if ( next.templateUrl === \"partials/login.html\") {\n            // pass\n          } else {\n            $location.path(\"/\");\n          }\n        }\n      });\n\n      $rootScope.$on('$routeChangeSuccess', function(event, current, previous) {\n        $rootScope.title = current.$$route.title;\n      });\n\n      $rootScope.safeProtocol = false;\n\n      if (window.location.protocol == 'https:') {\n        $rootScope.safeProtocol = true;\n      }\n\n\n      $rootScope.promptInput = function(title, message, label, callback) {\n        var ret = prompt({\n          title: title,\n          message: message,\n          input: true,\n          label: label\n        }).then(function(ret) {\n          if (angular.isFunction(callback)) {\n            callback(ret);\n          }\n        }, function() {\n\n        });\n\n      };\n\n    }\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  var vertoControllers = angular.module('vertoControllers', [\n    'ui.bootstrap',\n    'vertoService',\n    'storageService',\n    'ui.gravatar'\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('vertoControllers')\n  .controller('SplashScreenController', ['$scope', '$rootScope', '$location', '$timeout', 'storage', 'splashscreen', 'prompt', 'verto',\n    function($scope, $rootScope, $location, $timeout, storage, splashscreen, prompt, verto) {\n      console.debug('Executing SplashScreenController.');\n\n      $scope.progress_percentage = splashscreen.progress_percentage;\n      $scope.message = '';\n      $scope.interrupt_next = false;\n      $scope.errors = [];\n\n      var redirectTo = function(link, activity) {\n        if(activity) {\n          if(activity == 'browser-upgrade') {\n            link = activity;\n          }\n        }\n\n        $location.path(link);\n      }\n\n      var checkProgressState = function(current_progress, status, promise, activity, soft, interrupt, message) {\n        $scope.progress_percentage = splashscreen.calculate(current_progress);\n        $scope.message = message;\n\n        if(interrupt && status == 'error') {\n          $scope.errors.push(message);\n          if(!soft) {\n            redirectTo('', activity);\n            return;\n          } else {\n            message = message + '. Continue?';\n          };\n\n          if(!confirm(message)) {\n            $scope.interrupt_next = true;\n          };\n        };\n\n        if($scope.interrupt_next) {\n          return;\n        };\n\n        $scope.message = splashscreen.getProgressMessage(current_progress+1);\n\n        return true;\n      };\n\n      $rootScope.$on('progress.next', function(ev, current_progress, status, promise, activity, soft, interrupt, message) {\n        $timeout(function() {\n          if(promise) {\n            promise.then(function(response) {\n              message = response['message'];\n              status = response['status'];\n              if(checkProgressState(current_progress, status, promise, activity, soft, interrupt, message)) {\n                splashscreen.next();\n              };\n            });\n\n            return;\n          }\n\n          if(!checkProgressState(current_progress, status, promise, activity, soft, interrupt, message)) {\n            return;\n          }\n\n          splashscreen.next();\n        }, 400);\n      });\n\n      $rootScope.$on('progress.complete', function(ev, current_progress) {\n        $scope.message = 'Complete';\n        if(verto.data.connected) {\n          if (0 && storage.data.preview) {\n            $location.path('/preview');\n          }\n          else {\n            $location.path('/dialpad');\n          }\n        } else {\n          redirectTo('/login');\n          $location.path('/login');\n        }\n      });\n\n      splashscreen.next();\n\n    }]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('BrowserUpgradeController', ['$scope', '$http',\n      '$location', 'verto', 'storage', 'Fullscreen',\n      function($scope, $http, $location, verto, storage, Fullscreen) {\n        console.debug('Executing BrowserUpgradeController.');\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('vertoControllers')\n  .controller('ChatController', ['$scope', '$rootScope', '$http',\n    '$location', '$anchorScroll', '$timeout', 'verto', 'prompt', '$translate',\n    function($scope, $rootScope, $http, $location, $anchorScroll, $timeout,\n      verto, prompt, $translate) {\n      console.debug('Executing ChatController.');\n\n      function scrollToChatBottom() {\n        // Going to the bottom of chat messages.\n        var obj = document.querySelector('.chat-messages');\n        obj.scrollTop = obj.scrollHeight;\n        //var chat_messages_top = jQuery('.chat-messages').scrollTop();\n        //var marker_position = jQuery('#chat-message-bottom').position().top;\n        //jQuery('.chat-messages').scrollTop(chat_messages_top + marker_position);\n      }\n\n      var CLEAN_MESSAGE = '';\n\n      function clearConferenceChat() {\n        $scope.members = [];\n        $scope.messages = [];\n        $scope.message = CLEAN_MESSAGE;\n      }\n      clearConferenceChat();\n\n      $scope.$watch('activePane', function() {\n        if ($scope.activePane == 'chat') {\n          $rootScope.chat_counter = 0;\n        }\n        $rootScope.activePane = $scope.activePane;\n      });\n\n      $rootScope.$on('chat.newMessage', function(event, data) {\n        data.created_at = new Date();\n        console.log('chat.newMessage', data);\n        $scope.$apply(function() {\n          $scope.messages.push(data);\n          if (data.from != verto.data.name &&\n              (!$scope.chatStatus && $scope.activePane != 'chat')) {\n            ++$rootScope.chat_counter;\n          }\n          $timeout(function() {\n            scrollToChatBottom();\n          }, 300);\n        });\n      });\n\n      $rootScope.$on('call.conference', function(event, data) {\n        $timeout(function() {\n          $scope.conf = verto.data.conf.params.laData;\n        });\n      });\n\n      $rootScope.$on('changedVideoLayout', function(event, layout) {\n        $scope.resIDs = getResByLayout(layout);\n\n        // remove resIDs param to clear every members resID.\n        // passing $scope.resIDs results in preserving resIDs compatible\n        // with the current layout\n        clearMembersResID($scope.resIDs);\n      });\n\n      $rootScope.$on('conference.canvasInfo', function(event, data) {\n        $scope.currentLayout = data[0].layoutName;\n        $scope.resIDs = getResByLayout($scope.currentLayout);\n      });\n\n      function getResByLayout(layout) {\n        var layoutsData = verto.data.confLayoutsData;\n        for (var i = 0; i < layoutsData.length; i++) {\n          if (layoutsData[i].name === layout) {\n            return layoutsData[i].resIDS;\n          }\n        }\n      }\n\n      // @preserve - a array of values to be preserved\n      function clearMembersResID(preserve) {\n        $scope.members.forEach(function(member) {\n          var resID = member.status.video.reservationID;\n          console.debug(\"resID to clear: \" + resID);\n          if (resID && preserve && preserve.indexOf(resID) !== -1) return;\n          if (resID){\n            console.debug(\"clearing resid [\" + resID + \"] from [\" + member.id + \"]\");\n            $scope.confResID(member.id, resID);\n          }\n        });\n      };\n\n      function findMemberByUUID(uuid) {\n        var found = false;\n        for (var idx in $scope.members) {\n          var member = $scope.members[idx];\n          if (member.uuid == uuid) {\n            found = true;\n            break;\n          }\n        }\n        if (found) {\n          return idx;\n        } else {\n          return -1;\n        }\n      }\n\n      function translateMember(member) {\n        return {\n          'uuid': member[0],\n          'id': member[1][0],\n          'number': member[1][1],\n          'name': member[1][2],\n          'codec': member[1][3],\n          'status': JSON.parse(member[1][4]),\n          'email': member[1][5].email\n        };\n      }\n\n      function addMember(member) {\n        $scope.members.push(translateMember(member));\n      }\n\n      $rootScope.$on('hangupCall', function() {\n        $scope.openId = null;\n      });\n\n      $rootScope.$on('members.boot', function(event, members) {\n        $scope.$apply(function() {\n          clearConferenceChat();\n          for (var idx in members) {\n            var member = members[idx];\n            addMember(member);\n          }\n        })\n      });\n\n      $rootScope.$on('members.add', function(event, member) {\n        $scope.$apply(function() {\n          addMember(member);\n        });\n      });\n\n      $rootScope.$on('members.del', function(event, uuid) {\n        if ($rootScope.watcher && $rootScope.master === uuid) {\n          verto.hangup();\n          window.close();\n        }\n\n        $scope.$apply(function() {\n          var memberIdx = findMemberByUUID(uuid);\n          if (memberIdx != -1) {\n            // Removing the member.\n            $scope.members.splice(memberIdx, 1);\n          }\n        });\n      });\n\n      $rootScope.$on('members.update', function(event, member) {\n        member = translateMember(member);\n        var memberIdx = findMemberByUUID(member.uuid);\n        if (memberIdx < 0) {\n          console.log('Didn\\'t find the member uuid ' + member.uuid);\n        } else {\n          $scope.$apply(function() {\n            // console.log('Updating', memberIdx, ' <', $scope.members[memberIdx],\n              // '> with <', member, '>');\n            // Checking if it's me\n            if (parseInt(member.id) == parseInt(verto.data.conferenceMemberID)) {\n              verto.data.mutedMic = member.status.audio.muted;\n              verto.data.mutedVideo = member.status.video.muted;\n\t\t\t  verto.data.call.setMute(member.status.audio.muted ? \"off\" : \"on\");\n\t\t\t  verto.data.call.setVideoMute(member.status.video.muted ? \"off\" : \"on\");\n            }\n            angular.extend($scope.members[memberIdx], member);\n          });\n        }\n      });\n\n      $rootScope.$on('members.clear', function(event) {\n        $scope.$applyAsync(function() {\n          clearConferenceChat();\n          $scope.closeChat();\n        });\n      });\n\n      /**\n       * Public methods.\n       */\n\n      $scope.toggleModMenu = function(index) {\n        if (verto.data.confRole != 'moderator') return;\n        $scope.openId = $scope.openId == index ? null : index;\n      };\n\n      $scope.send = function(event) {\n        // Only conferencing chat is supported for now\n        // but still calling method with the conference prefix\n        // so we know that explicitly.\n        if (event && event.type == 'keydown') {\n          event.preventDefault();\n        }\n        verto.sendConferenceChat($scope.message);\n        $scope.message = CLEAN_MESSAGE;\n      };\n\n      // Participants moderation.\n      $scope.confKick = function(memberID) {\n        console.log('$scope.confKick');\n        verto.data.conf.kick(memberID);\n      };\n\n      $scope.confMuteMic = function(memberID) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confMuteMic');\n          verto.data.conf.muteMic(memberID);\n        }\n      };\n\n      $scope.confMuteVideo = function(memberID) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confMuteVideo');\n          verto.data.conf.muteVideo(memberID);\n        }\n      };\n\n      $scope.confPresenter = function(memberID) {\n        console.log('$scope.confPresenter');\n        verto.data.conf.presenter(memberID);\n      };\n\n      $scope.confResID = function(memberID, resID) {\n        console.log('Set', memberID, 'to', resID);\n        verto.setResevartionId(memberID, resID);\n      };\n\n      $scope.confVideoFloor = function(memberID) {\n        console.log('$scope.confVideoFloor');\n        verto.data.conf.videoFloor(memberID);\n      };\n\n      $scope.confBanner = function(memberID) {\n        console.log('$scope.confBanner');\n\n        prompt({\n          title: $translate.instant('TITLE_INSERT_BANNER'),\n          input: true,\n          label: '',\n          value: '',\n        }).then(function(text) {\n          if (text) {\n            verto.data.conf.banner(memberID, text);\n          }\n        });\n      };\n\n      $scope.confCanvasIn = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setCanvasIn(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_CANVAS_ID'), function(canvasID) {\n          console.log(memberID, canvasID);\n          verto.setCanvasIn(memberID, canvasID);\n        });\n\n      };\n\n      $scope.confCanvasOut = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setCanvasOut(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_CANVAS_ID'), function(canvasID) {\n          verto.setCanvasOut(memberID, canvasID);\n        });\n      };\n\n      $scope.confLayer = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setLayer(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_LAYER'), function(canvasID) {\n          verto.setLayer(memberID, canvasID);\n        });\n      };\n\n      $scope.confResetBanner = function(memberID) {\n        console.log('$scope.confResetBanner');\n        var text = 'reset';\n        verto.data.conf.banner(memberID, text);\n      };\n\n      $scope.confVolumeDown = function(memberID) {\n        console.log('$scope.confVolumeDown');\n        verto.data.conf.volumeDown(memberID);\n      };\n\n      $scope.confVolumeUp = function(memberID) {\n        console.log('$scope.confVolumeUp');\n        verto.data.conf.volumeUp(memberID);\n      };\n\n      $scope.confGainDown = function(memberID) {\n        console.log('$scope.confGainDown');\n        verto.data.conf.gainDown(memberID);\n      };\n\n      $scope.confGainUp = function(memberID) {\n        console.log('$scope.confGainUp');\n        verto.data.conf.gainUp(memberID);\n      };\n\n      $scope.confTransfer = function(memberID) {\n        console.log('$scope.confTransfer');\n        $rootScope.disableOnKeydownDtmf();\n        prompt({\n          title: $translate.instant('TITLE_TRANSFER'),\n          message: $translate.instant('MESSAGE_TRANSFER'),\n          input: true,\n          label: $translate.instant('LABEL_TRANSFER'),\n          value: '',\n        }).then(function(exten) {\n          $rootScope.enableOnKeydownDtmf();\n          if (exten) {\n            verto.data.conf.transfer(memberID, exten);\n          }\n        }).catch(function(){\n          $rootScope.enableOnKeydownDtmf();\n        });\n\n      };\n\n      $scope.confToggleDeaf = function(member) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confToggleDeaf');\n\n          if (member.status.audio.deaf) {\n            verto.data.conf.undeaf(member.id);\n          } else {\n            verto.data.conf.deaf(member.id);\n          }\n        }\n      };\n\n      function shortPrompt(text, cb) {\n        prompt({\n          title: text,\n          input: true,\n          label: '',\n          value: '',\n        }).then(function(val) {\n          if (val && cb) {\n            cb(val);\n          }\n        });\n      }\n    }\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ContributorsController', ['$scope', '$http',\n      'toastr',\n      function($scope, $http, toastr) {\n        var url = window.location.origin + window.location.pathname;\n        $http.get(url + 'contributors.txt')\n          .success(function(data) {\n\n            var contributors = [];\n\n            angular.forEach(data, function(value, key) {\n              var re = /(.*) <(.*)>/;\n              var name = value.replace(re, \"$1\");\n              var email = value.replace(re, \"$2\");\n\n              this.push({\n                'name': name,\n                'email': email\n              });\n            }, contributors);\n\n            $scope.contributors = contributors;\n          })\n          .error(function() {\n            toastr.error('contributors not found.');\n          });\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('AboutController', ['$scope', '$http',\n      'toastr',\n      function($scope, $http, toastr) {\n\t    var githash = '3510866140' || 'something is not right';\n            $scope.githash = githash;\n\n\t/* leave this here for later, but its not needed right now\n        $http.get(window.location.pathname + '/contributors.txt')\n          .success(function(data) {\n\n          })\n          .error(function() {\n            toastr.error('contributors not found.');\n          });\n\t */\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('DialPadController', ['$rootScope', '$scope',\n      '$http', '$location', 'toastr', 'verto', 'storage', 'CallHistory', 'eventQueue', '$timeout',\n      function($rootScope, $scope, $http, $location, toastr, verto, storage, CallHistory, eventQueue, $timeout) {\n        console.debug('Executing DialPadController.');\n\n        eventQueue.process();\n\n        if ($location.search().autocall) {\n            $rootScope.dialpadNumber = $location.search().autocall;\n            delete $location.search().autocall;\n            call($rootScope.dialpadNumber);\n            if($rootScope.watcher) {\n              return;\n            }\n        }\n\n        $scope.call_history = CallHistory.all();\n        $scope.history_control = CallHistory.all_control();\n        $scope.has_history = Object.keys($scope.call_history).length;\n        storage.data.videoCall = false;\n        storage.data.userStatus = 'connecting';\n        storage.data.calling = false;\n\n        $scope.clearCallHistory = function() {\n          CallHistory.clear();\n          $scope.call_history = CallHistory.all();\n          $scope.history_control = CallHistory.all_control();\n          $scope.has_history = Object.keys($scope.call_history).length;\n          return $scope.history_control;\n        };\n\n        $scope.viewCallsList = function(calls) {\n          return $scope.call_list = calls;\n        };\n\n        /**\n         * fill dialpad via querystring [?autocall=\\d+]\n         */\n\n\t/**\n\t * fill in dialpad via config.json\n\t */\n        if ('autocall' in verto.data) {\n          $rootScope.dialpadNumber = verto.data.autocall;\n\t  delete verto.data.autocall;\n          call($rootScope.dialpadNumber);\n        }\n\n        /**\n         * used to bind click on number in call history to fill dialpad\n         * 'cause inside a ng-repeat the angular isnt in ctrl scope\n         */\n        $scope.fillDialpadNumber = function(number) {\n          $rootScope.dialpadNumber = number;\n        };\n\n        $scope.preview = function() {\n          $location.path('/preview');\n        };\n\n        $rootScope.transfer = function() {\n          if (!$rootScope.dialpadNumber) {\n            return false;\n          }\n          verto.data.call.transfer($rootScope.dialpadNumber);\n        };\n\n        function call(extension) {\n          storage.data.onHold = false;\n          storage.data.cur_call = 0;\n          $rootScope.dialpadNumber = extension;\n          if (!$rootScope.dialpadNumber && storage.data.called_number) {\n            $rootScope.dialpadNumber = storage.data.called_number;\n            return false;\n          } else if (!$rootScope.dialpadNumber && !storage.data.called_number) {\n            toastr.warning('Enter an extension, please.');\n            return false;\n          }\n\n          if (verto.data.call) {\n            console.debug('A call is already in progress.');\n            return false;\n          }\n\n          if (extension.indexOf('-canvas-') != -1) {\n            $rootScope.watcher = true;\n            verto.call($rootScope.dialpadNumber, null,\n              {\n                useCamera: \"none\",\n                useMic: \"none\",\n                useSpeak: \"none\",\n                caller_id_name: null,\n                userVariables: {},\n                caller_id_number: null,\n                mirrorInput: false\n              }\n            );\n            $location.path('/incall');\n            return;\n          }\n\n          storage.data.mutedVideo = false;\n          storage.data.mutedMic = false;\n\n          storage.data.videoCall = false;\n          verto.call($rootScope.dialpadNumber);\n\n          storage.data.called_number = $rootScope.dialpadNumber;\n          CallHistory.add($rootScope.dialpadNumber, 'outbound');\n          $location.path('/incall');\n        }\n\n        /**\n         * Call to the number in the $rootScope.dialpadNumber.\n         */\n        $scope.loading = false;\n        $scope.cancelled = false;\n        $rootScope.call = function(extension) {\n          if (!storage.data.testSpeedJoin || !$rootScope.dialpadNumber) {\n            return call(extension);\n          }\n          $scope.loading = true;\n\n          verto.testSpeed(function() {\n            if ($scope.cancelled) {\n              $scope.cancelled = false;\n              $scope.loading = false;\n              return;\n            } else {\n              call(extension);\n            }\n          });\n        }\n\n        $rootScope.cancel = function() {\n          $scope.cancelled = true;\n        }\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('InCallController', ['$rootScope', '$scope',\n      '$http', '$location', '$modal', '$timeout', 'toastr', 'verto', 'storage', 'prompt', 'Fullscreen', '$translate',\n      function($rootScope, $scope, $http, $location, $modal, $timeout, toastr,\n        verto, storage, prompt, Fullscreen, $translate) {\n\n        console.debug('Executing InCallController.');\n        $scope.layout = null;\n        $rootScope.dialpadNumber = '';\n        $scope.callTemplate = 'partials/phone_call.html';\n        $scope.dialpadTemplate = '';\n        $scope.incall = true;\n\n        if (storage.data.videoCall) {\n          $scope.callTemplate = 'partials/video_call.html';\n        }\n\n        $rootScope.$on('call.conference', function(event, data) {\n          $timeout(function() {\n            if($scope.chatStatus) {\n              $scope.openChat();\n            }\n            buildCanvasesData();\n          });\n        });\n\n        $rootScope.$on('call.video', function(event, data) {\n          $timeout(function() {\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        });\n\n        /**\n         * toggle dialpad in incall page\n         */\n        $scope.toggleDialpad = function() {\n          $scope.openModal('partials/dialpad_widget.html',\n            'ModalDialpadController');\n\n          /*\n          if(!$scope.dialpadTemplate) {\n            $scope.dialpadTemplate = 'partials/dialpad_widget.html';\n          } else {\n            $scope.dialpadTemplate = '';\n          }\n          */\n        }\n\n        /**\n         * TODO: useless?\n         */\n        $scope.videoCall = function() {\n          prompt({\n            title: $translate.instant('TITLE_ENABLE_VIDEO'),\n            message: $translate.instant('MESSAGE_ENABLE_VIDEO')\n          }).then(function() {\n            storage.data.videoCall = true;\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        };\n\n        $scope.cbMuteVideo = function(event, data) {\n          storage.data.mutedVideo = !storage.data.mutedVideo;\n        }\n\n        $scope.cbMuteMic = function(event, data) {\n          storage.data.mutedMic = !storage.data.mutedMic;\n        }\n\n        $scope.confChangeVideoLayout = function(layout, canvasID) {\n          verto.data.conf.setVideoLayout(layout, canvasID);\n          $scope.videoLayout = layout;\n          $rootScope.$emit('changedVideoLayout', layout);\n        };\n\n        $scope.confChangeSpeaker = function(speakerId) {\n          storage.data.selectedSpeaker = speakerId;\n          $rootScope.$emit('changedSpeaker', speakerId);\n        };\n\n        $scope.confPopup = function(canvas_id) {\n          var video = document.getElementById('webcam');\n          var s = window.location.href;\n          var curCall = verto.data.call.callID;\n          var extension = verto.data.call.params.remote_caller_id_number;\n          var width = webcam.offsetWidth;\n          var height = webcam.offsetHeight + 100;\n          var x = (screen.width - width)/2\n          var y = (screen.height - height)/2\n\n          s = s.replace(/\\#.*/, '');\n          s += \"#/?sessid=random&master=\" + curCall + \"&watcher=true&extension=\" + extension+ \"&canvas_id=\" + canvas_id;\n\n          console.log(\"opening new window to \" + s);\n          var popup = window.open(s, \"canvas_window_\" + canvas_id, \"toolbar=0,location=0,menubar=0,directories=0,width=\" + width + \",height=\" + height, + ',left=' + x + ',top=' + y);\n          popup.moveTo(x, y);\n        };\n\n        $scope.screenshare = function() {\n          if(verto.data.shareCall) {\n            verto.screenshareHangup();\n            return false;\n          }\n          if (verto.data.conf) {\n            console.log('Screenshare inside conferece: ', verto.data.conf);\n            // Setting the destination of the screenshare call as the conference\n            // number we last joined\n            verto.screenshare(verto.data.conf.params.laData.laName);\n          }\n          else {\n            verto.screenshare(storage.data.called_number);\n          }\n        };\n\n        function buildCanvasesData() {\n          $scope.conf = verto.data.conf.params.laData;\n          $scope.canvases = [{ id: 1, name: 'Super Canvas' }];\n          for (var i = 1; i < $scope.conf.canvasCount; i++) {\n            $scope.canvases.push({ id: i+1, name: 'Canvas ' + (i+1) });\n          }\n        }\n\n        $scope.muteMic = verto.muteMic;\n        $scope.muteVideo = verto.muteVideo;\n\n        $rootScope.$on('ScreenShareExtensionStatus', function(event, error) {\n          var pluginUrl = 'https://chrome.google.com/webstore/detail/screen-capturing/ajhifddimkapgcifgcodmmfdlknahffk';\n          switch(error) {\n            case 'permission-denied':\n              toastr.info('Please allow the plugin in order to use Screen Share', 'Error'); break;\n            case 'not-installed':\n              toastr.warning('Please <a target=\"_blank\" class=\"install\" href=\"'+ pluginUrl +'\">install</a> the plugin in order to use Screen Share', 'Warning', { allowHtml: true }); break;\n            case 'installed-disabled':\n              toastr.info('Please enable the plugin in order to use Screen Share', 'Error'); break;\n            // case 'not-chrome'\n            //   toastr.info('Chrome', 'Error');\n          }\n        });\n\n        $timeout(function() {\n          console.log('broadcast time-start incall');\n          $scope.$broadcast('timer-start');\n        }, 1000);\n\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('LoginController', ['$scope', '$http', '$location', 'verto', \n      function($scope, $http, $location, verto) {\n        var preRoute = function() {\n          if(verto.data.connected) {\n            $location.path('/dialpad');\n          }\n        }\n        preRoute();\n\n        var name = $location.search().name;\n        var email = $location.search().email;\n        var skipPreview = $location.search().skipPreview;\n\n        if (name && email) {\n          verto.data.name = name;\n          verto.data.email = email;\n          $scope.login(true, skipPreview);\n          return;\n        }\n\n        verto.data.name = $scope.storage.data.name;\n        verto.data.email = $scope.storage.data.email;\n\n        console.debug('Executing LoginController.');\n      }\n    ]);\n\n})();\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('MainController',\n      [\"$scope\", \"$rootScope\", \"$location\", \"$modal\", \"$timeout\", \"$q\", \"verto\", \"storage\", \"CallHistory\", \"toastr\", \"Fullscreen\", \"prompt\", \"eventQueue\", \"$translate\", \"$window\", function($scope, $rootScope, $location, $modal, $timeout, $q, verto, storage, CallHistory, toastr, Fullscreen, prompt, eventQueue, $translate, $window) {\n\n      console.debug('Executing MainController.');\n      $rootScope.dtmfHistory = { value: '' };\n      $rootScope.onKeydownDtmfEnabled = true;\n\n      $.verto.haltClosure = function() {\n        if (verto.data.callState == 'active') {\n          return true;\n        }\n      };\n\n      if (storage.data.language && storage.data.language !== 'browser') {\n        $translate.use(storage.data.language);\n      } else {\n        storage.data.language = 'browser';\n      }\n\n      $rootScope.master = $location.search().master;\n      if ($location.search().watcher === 'true') {\n        $rootScope.watcher = true;\n        angular.element(document.body).addClass('watcher');\n        var dialpad;\n        var extension = dialpad = $location.search().extension;\n        var canvasID = $location.search().canvas_id;\n\n        if (dialpad) {\n          if (canvasID) {\n            dialpad += '-canvas-' + canvasID;\n          }\n          $rootScope.extension = extension;\n          $rootScope.canvasID = canvasID;\n          $location.search().autocall = dialpad;\n        }\n      }\n\n      var myVideo = document.getElementById(\"webcam\");\n      $scope.verto = verto;\n      $scope.storage = storage;\n      $scope.call_history = angular.element(\"#call_history\").hasClass('active');\n      $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n      $scope.showReconnectModal = true;\n      /**\n       * (explanation) scope in another controller extends rootScope (singleton)\n       */\n      $rootScope.chat_counter = 0;\n      $rootScope.activePane = 'members';\n      /**\n       * The number that will be called.\n       * @type {string}\n       */\n      $rootScope.dialpadNumber = '';\n\n      // If verto is not connected, redirects to login page.\n      if (!verto.data.connected) {\n        console.debug('MainController: WebSocket not connected. Redirecting to login.');\n        $location.path('/');\n      }\n\n      $rootScope.$on('config.http.success', function(ev) {\n        $scope.login(false);\n      });\n\n      $rootScope.$on('changedSpeaker', function(event, speakerId) {\n        if (verto.data.call) {\n          verto.data.call.setAudioPlaybackDevice(speakerId, sinkIdCallback);\n        }\n      });\n\n      /**\n       * Login the user to verto server and\n       * redirects him to dialpad page.\n       */\n      $rootScope.login = function(redirect, skipPreview) {\n        if(redirect == undefined) {\n          redirect = true;\n        }\n\n        if(skipPreview == undefined) {\n          skipPreview = false;\n        }\n\n        var connectCallback = function(v, connected) {\n          $scope.$apply(function() {\n          verto.data.connecting = false;\n          if (connected) {\n            storage.data.hostname = verto.data.hostname;\n            storage.data.wsURL = verto.data.wsURL;\n            storage.data.ui_connected = verto.data.connected;\n            storage.data.ws_connected = verto.data.connected;\n            storage.data.name = verto.data.name;\n            storage.data.email = verto.data.email;\n            storage.data.login = verto.data.login;\n            storage.data.password = verto.data.password;\n            if (storage.data.autoBand) {\n              verto.testSpeed();\n            }\n\n            if (redirect && storage.data.preview && !skipPreview) {\n              $location.path('/loading');\n            } else if (redirect) {\n              $location.path('/dialpad');\n            }\n          }\n          });\n        };\n\n        verto.data.connecting = true;\n        verto.connect(connectCallback);\n      };\n\n      /**\n       * Logout the user from verto server and\n       * redirects him to login page.\n       */\n      $rootScope.logout = function() {\n        var disconnect = function() {\n          var disconnectCallback = function(v, connected) {\n            console.debug('Redirecting to login page.');\n            storage.reset();\n\t\t\tif (typeof gapi !== 'undefined'){\n\t\t\t\tconsole.debug(gapi);\n\t\t\t\tgapi.auth.signOut();\n\t\t\t}\n            $location.path('/login');\n          };\n\n          if (verto.data.call) {\n            verto.hangup();\n          }\n\n          $scope.closeChat();\n          $scope.showReconnectModal = false;\n          verto.disconnect(disconnectCallback);\n\n          verto.hangup();\n        };\n\n        if (verto.data.call) {\n          prompt({\n            title: $translate.instant('TITLE_ACTIVE_CALL'),\n            message: $translate.instant('MESSAGE_ACTIVE_CALL_HANGUP')\n          }).then(function() {\n            disconnect();\n          });\n        } else {\n          disconnect();\n        }\n\n      };\n\n      /**\n       * Shows a modal with the settings.\n       */\n      $scope.openModalSettings = function() {\n        var modalInstance = $modal.open({\n          animation: $scope.animationsEnabled,\n          templateUrl: 'partials/modal_settings.html',\n          controller: 'ModalSettingsController',\n        });\n\n        modalInstance.result.then(\n          function(result) {\n            console.log(result);\n          },\n          function() {\n            console.info('Modal dismissed at: ' + new Date());\n          }\n        );\n\n        modalInstance.rendered.then(\n          function() {\n            jQuery.material.init();\n          }\n        );\n      };\n\n      $rootScope.openModal = function(templateUrl, controller, _options) {\n        var options = {\n          animation: $scope.animationsEnabled,\n          templateUrl: templateUrl,\n          controller: controller,\n        };\n\n        angular.extend(options, _options);\n\n        var modalInstance = $modal.open(options);\n\n        modalInstance.result.then(\n          function(result) {\n            console.log(result);\n          },\n          function() {\n            console.info('Modal dismissed at: ' + new Date());\n          }\n        );\n\n        modalInstance.rendered.then(\n          function() {\n            jQuery.material.init();\n          }\n        );\n\n        return modalInstance;\n      };\n\n      $rootScope.$on('ws.close', onWSClose);\n      $rootScope.$on('ws.login', onWSLogin);\n\n      $rootScope.ws_modalInstance;\n\n      function onWSClose(ev, data) {\n        if($rootScope.ws_modalInstance) {\n          return;\n        };\n        var options = {\n          backdrop: 'static',\n          keyboard: false\n        };\n          if ($scope.showReconnectModal) {\n            $rootScope.ws_modalInstance = $scope.openModal('partials/ws_reconnect.html', 'ModalWsReconnectController', options);\n          };\n      };\n\n      function onWSLogin(ev, data) {\n        if(storage.data.autoBand) {\n          verto.testSpeed();\n        }\n        if(!$rootScope.ws_modalInstance) {\n          return;\n        };\n\n        $rootScope.ws_modalInstance.close();\n        $rootScope.ws_modalInstance = null;\n      };\n\n      $scope.showAbout = function() {\n        $scope.openModal('partials/about.html', 'AboutController');\n      };\n\n      $scope.showContributors = function() {\n        $scope.openModal('partials/contributors.html', 'ContributorsController');\n      };\n\n      /**\n       * Updates the display adding the new number touched.\n       *\n       * @param {String} number - New touched number.\n       */\n      $rootScope.dtmf = function(number) {\n        console.log('dtmf', number);\n        $rootScope.dialpadNumber = $rootScope.dialpadNumber + number;\n        if (verto.data.call) {\n          verto.dtmf(number);\n        }\n      };\n\n      /**\n       * Removes the last character from the number.\n       */\n      $rootScope.backspace = function() {\n        var number = $rootScope.dialpadNumber;\n        var len = number.length;\n        $rootScope.dialpadNumber = number.substring(0, len - 1);\n      };\n\n\n      $scope.toggleCallHistory = function() {\n        if (!$scope.call_history) {\n          angular.element(\"#call_history\").addClass('active');\n          angular.element(\"#call-history-wrapper\").addClass('active');\n        } else {\n          angular.element(\"#call_history\").removeClass('active');\n          angular.element(\"#call-history-wrapper\").removeClass('active');\n        }\n        $scope.call_history = angular.element(\"#call_history\").hasClass('active');\n      };\n\n      $scope.toggleChat = function() {\n        if ($rootScope.chatStatus && $rootScope.activePane === 'chat') {\n          $rootScope.chat_counter = 0;\n        }\n        angular.element('#wrapper').toggleClass('toggled');\n        $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n        updateVideoSize();\n      };\n\n      $rootScope.openChat = function() {\n        $rootScope.chatStatus = false;\n        angular.element('#wrapper').removeClass('toggled');\n      };\n\n      $scope.closeChat = function() {\n        $rootScope.chatStatus = true;\n        angular.element('#wrapper').addClass('toggled');\n      };\n\n      $scope.toggleSettings = function() {\n        var settingsEl = angular.element(document.querySelector('#settings'));\n        settingsEl.toggleClass('toggled');\n        $rootScope.$emit('toggledSettings', settingsEl.hasClass('toggled'));\n      };\n\n      $scope.closeSettings = function() {\n        var settingsEl = angular.element(document.querySelector('#settings'));\n        if (settingsEl.hasClass('toggled')) {\n          settingsEl.removeClass('toggled');\n          $rootScope.$emit('toggledSettings', settingsEl.hasClass('toggled'));\n        }\n      };\n\n      $scope.goFullscreen = function() {\n        if (storage.data.userStatus !== 'connected') {\n          return;\n        }\n        $rootScope.fullscreenEnabled = !Fullscreen.isEnabled();\n        if (Fullscreen.isEnabled()) {\n          Fullscreen.cancel();\n        } else {\n          Fullscreen.enable(document.getElementsByTagName('body')[0]);\n        }\n      };\n\n      $rootScope.$on('call.video', function(event) {\n        storage.data.videoCall = true;\n      });\n\n      $rootScope.$on('call.hangup', function(event, data) {\n        if (Fullscreen.isEnabled()) {\n          Fullscreen.cancel();\n        }\n\n        if (!$rootScope.chatStatus) {\n          angular.element('#wrapper').toggleClass('toggled');\n          $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n        }\n\n        $rootScope.dialpadNumber = '';\n        console.debug('Redirecting to dialpad page.');\n        $location.path('/dialpad');\n\n        try {\n          $rootScope.$digest();\n        } catch (e) {\n          console.log('not digest');\n        }\n      });\n\n      $rootScope.$on('page.incall', function(event, data) {\n        var page_incall = function() {\n          return $q(function(resolve, reject) {\n            if (storage.data.askRecoverCall) {\n              prompt({\n                title: $translate.instant('TITLE_ACTIVE_CALL'),\n                message: $translate.instant('MESSAGE_ACTIVE_CALL_BACK')\n              }).then(function() {\n                console.log('redirect to incall page');\n                $location.path('/incall');\n              }, function() {\n                storage.data.userStatus = 'connecting';\n                verto.hangup();\n              });\n            } else {\n              console.log('redirect to incall page');\n              $location.path('/incall');\n            }\n            resolve();\n          });\n        };\n        eventQueue.events.push(page_incall);\n      });\n\n      $scope.$on('event:google-plus-signin-success', function (event,authResult) {\n        // Send login to server or save into cookie\n        console.log('Google+ Login Success');\n\tconsole.log(authResult);\n\tgapi.client.load('plus', 'v1', gapiClientLoaded);\n      });\n\n      function gapiClientLoaded() {\n\tgapi.client.plus.people.get({userId: 'me'}).execute(handleEmailResponse);\n      }\n\n      function handleEmailResponse(resp){\n        var primaryEmail;\n\tfor (var i=0; i < resp.emails.length; i++) {\n\t  if (resp.emails[i].type === 'account') primaryEmail = resp.emails[i].value;\n        }\n\tconsole.debug(\"Primary Email: \" + primaryEmail );\n\tconsole.debug(\"display name: \" + resp.displayName);\n\tconsole.debug(\"imageurl: \" + resp.image.url);\n\tconsole.debug(resp);\n\tconsole.debug(verto.data);\n\tverto.data.email = primaryEmail;\n\tverto.data.name = resp.displayName;\n\tstorage.data.name = verto.data.name;\n\tstorage.data.email = verto.data.email;\n\n\t$scope.login();\n      }\n\n      $scope.$on('event:google-plus-signin-failure', function (event,authResult) {\n        // Auth failure or signout detected\n        console.log('Google+ Login Failure');\n      });\n\n      $rootScope.callActive = function(data, params) {\n        verto.data.mutedMic = storage.data.mutedMic;\n        verto.data.mutedVideo = storage.data.mutedVideo;\n\n        if (!storage.data.cur_call) {\n          storage.data.call_start = new Date();\n        }\n        storage.data.userStatus = 'connected';\n        var call_start = new Date(storage.data.call_start);\n        $rootScope.start_time = call_start;\n\n        $timeout(function() {\n          $scope.$broadcast('timer-start');\n        });\n        myVideo.play();\n        storage.data.calling = false;\n\n        storage.data.cur_call = 1;\n\n        $location.path('/incall');\n\n        if(params.useVideo) {\n          $rootScope.$emit('call.video', 'video');\n        }\n      };\n\n      $rootScope.$on('call.active', function(event, data, params) {\n        $rootScope.callActive(data, params);\n      });\n\n      $rootScope.$on('call.calling', function(event, data) {\n        storage.data.calling = true;\n      });\n\n      $rootScope.$on('call.incoming', function(event, data) {\n        console.log('Incoming call from: ' + data);\n\n        storage.data.cur_call = 0;\n        $scope.incomingCall = true;\n        storage.data.videoCall = false;\n        storage.data.mutedVideo = false;\n        storage.data.mutedMic = false;\n\n        prompt({\n          title: $translate.instant('TITLE_INCOMING_CALL'),\n          message: $translate.instant('MESSAGE_INCOMING_CALL') + data\n        }).then(function() {\n          var call_start = new Date(storage.data.call_start);\n          $rootScope.start_time = call_start;\n          console.log($rootScope.start_time);\n\n          $scope.answerCall();\n          storage.data.called_number = data;\n          CallHistory.add(data, 'inbound', true);\n          $location.path('/incall');\n        }, function() {\n          $scope.declineCall();\n          CallHistory.add(data, 'inbound', false);\n        });\n      });\n\n      $scope.hold = function() {\n        storage.data.onHold = !storage.data.onHold;\n        verto.data.call.toggleHold();\n      };\n\n      /**\n       * Hangup the current call.\n       */\n      $scope.hangup = function() {\n        if (!verto.data.call) {\n          toastr.warning($translate.instant('MESSAGE_NO_HANGUP_CALL'));\n          $location.path('/dialpad');\n          return;\n        }\n\n        if ($rootScope.watcher) {\n          window.close();\n          return;\n        }\n\n        //var hangupCallback = function(v, hangup) {\n        //  if (hangup) {\n        //    $location.path('/dialpad');\n        //  } else {\n        //    console.debug('The call could not be hangup.');\n        //  }\n        //};\n        //\n        //verto.hangup(hangupCallback);\n        if (verto.data.shareCall) {\n          verto.screenshareHangup();\n        }\n\n        verto.hangup();\n\n        $rootScope.$emit('hangupCall');\n        $location.path('/dialpad');\n      };\n\n      $scope.answerCall = function() {\n        storage.data.onHold = false;\n\n        verto.data.call.answer({\n          useStereo: storage.data.useStereo,\n          useCamera: storage.data.selectedVideo,\n          useVideo: storage.data.useVideo,\n          useMic: storage.data.useMic,\n          callee_id_name: verto.data.name,\n          callee_id_number: verto.data.login\n        });\n\n\n        $location.path('/incall');\n      };\n\n      $scope.declineCall = function() {\n        $scope.hangup();\n        $scope.incomingCall = false;\n      };\n\n      $scope.play = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.play(file);\n            console.log('play file :', file);\n          });\n\n      };\n\n      $scope.stop = function() {\n        verto.data.conf.stop();\n      };\n\n      $scope.record = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.record(file);\n            console.log('recording file :', file);\n          });\n      };\n\n      $scope.stopRecord = function() {\n        verto.data.conf.stopRecord();\n      };\n\n      $scope.snapshot = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.snapshot(file);\n            console.log('snapshot file :', file);\n          });\n      };\n\n      function sinkIdCallback(success, deviceName) {\n        if (success) {\n          toastr.info('Speaker is now <span class=\"install\">' + deviceName + '</a>', 'Success', { allowHtml: true });\n        } else {\n          toastr.error('Your browser doesn\\'t seem to support this feature', 'Error');\n        }\n      }\n\n      $rootScope.dtmfWidget = function(number) {\n        $rootScope.dtmfHistory.value = $rootScope.dtmfHistory.value + number;\n        if (verto.data.call) {\n          verto.dtmf(number);\n        }\n      }\n\n      $rootScope.disableOnKeydownDtmf = function() {\n        $rootScope.onKeydownDtmfEnabled = false;\n      };\n\n      $rootScope.enableOnKeydownDtmf = function() {\n        $rootScope.onKeydownDtmfEnabled = true;\n      };\n\n      $rootScope.$on(\"$routeChangeStart\", function(event, next, current) {\n        if (next.$$route.originalPath === '/incall') {\n          $rootScope.dtmfHistory.value = '';\n          angular.element($window).bind('keydown', onKeydownDtmfHistory);\n        } else {\n          angular.element($window).unbind('keydown', onKeydownDtmfHistory);\n        }\n      });\n\n      function onKeydownDtmfHistory(event) {\n        var caracter = event.key;\n        if ($rootScope.onKeydownDtmfEnabled && caracter.match(/^(\\*|\\#|[0-9a-dA-D])$/g)) {\n          $rootScope.dtmfWidget(caracter);\n          $scope.$applyAsync();\n        }\n      }\n\n    }]\n  );\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n\t.controller('MenuController', ['$scope', '$http', '$location',\n\t  'verto', 'storage', '$rootScope',\n\t  function($scope, $http, $location, verto, storage, $rootScope) {\n\t    console.debug('Executing MenuController.');\n      $scope.storage = storage;\n\n      $rootScope.$on('testSpeed', function(e, data) {\n        var vidQual = storage.data.vidQual;\n\tvar bwp = 4;\n\n        $scope.bandDown = data.downKPS;\n        $scope.bandUp = data.upKPS;\n\n        if (data.downKPS < 2000) {\n          bwp--;\n        }\n\n        if (data.upKPS < 2000) {\n           bwp--;\n        }\n\n        $scope.iconClass = 'mdi-device-signal-wifi-4-bar green';                      \n\n        if (bwp < 4) {\n           $scope.iconClass = 'mdi-device-signal-wifi-3-bar yellow';\n        } else if (bwp < 2) {\n           $scope.iconClass = 'mdi-device-signal-wifi-1-bar red';\n        }\n\n        verto.videoQuality.forEach(function(vid) {\n          if (vid.id == vidQual){\n            $scope.vidRes = vid.label;\n          }\n        });\n\n        $scope.$apply();\n      });\n    }\n\t]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalDialpadController', ['$scope',\n      '$modalInstance',\n      function($scope, $modalInstance) {\n\n        $scope.ok = function() {\n          $modalInstance.close('Ok.');\n        };\n\n        $scope.cancel = function() {\n          $modalInstance.dismiss('cancel');\n        };\n\n      }\n    ]);\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalWsReconnectController', ModalWsReconnectController);\n\n    ModalWsReconnectController.$inject = ['$rootScope', '$scope', 'storage', 'verto'];\n\n    function ModalWsReconnectController($rootScope, $scope, storage, verto) {\n      console.debug('Executing ModalWsReconnectController'); \n\n      $scope.closeReconnect = closeReconnect;\n\n      function closeReconnect() {\n        if ($rootScope.ws_modalInstance && verto.data.instance) {\n          verto.data.instance.rpcClient.stopRetrying();\n          $rootScope.ws_modalInstance.close();\n          delete verto.data.instance;\n        }\n      };\n    };\n                \n                \n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalLoginInformationController', ['$scope',\n      '$http', '$location', '$modalInstance', 'verto', 'storage',\n      function($scope, $http, $location, $modalInstance, verto, storage) {\n        console.debug('Executing ModalLoginInformationController.');\n\n        $scope.verto = verto;\n        $scope.storage = storage;\n\n        $scope.ok = function() {\n          $modalInstance.close('Ok.');\n        };\n\n        $scope.cancel = function() {\n          $modalInstance.dismiss('cancel');\n        };\n\n        verto.data.name = storage.data.name;\n        verto.data.email = storage.data.email;\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('SettingsController', ['$scope', '$http',\n      '$location', '$rootScope', 'storage', 'verto', '$translate', 'toastr', 'configLanguages',\n      function($scope, $http, $location, $rootScope, storage, verto, $translate, toastr, configLanguages) {\n        console.debug('Executing ModalSettingsController.');\n\n        $.material.init();\n\n        $scope.speakerFeature = typeof document.getElementById('webcam').sinkId !== 'undefined';\n        $scope.storage = storage;\n        $scope.verto = verto;\n        $scope.mydata = angular.copy(storage.data);\n        $scope.languages = configLanguages.languages;\n        $scope.languages.unshift({id: 'browser', name : $translate.instant('BROWSER_LANGUAGE')});\n        $scope.mydata.language = storage.data.language || 'browser';\n\n        $rootScope.$on('$translateChangeSuccess', function () {\n          $translate('BROWSER_LANGUAGE').then(function (translation) {\n          $scope.languages[0].name = translation;\n          });\n        });\n\n        $rootScope.$on('toggledSettings', function(e, status) {\n          if (status) {\n            $scope.mydata = angular.copy(storage.data);\n          } else {\n            $scope.ok();\n          }\n        });\n\n        $scope.ok = function() {\n          console.log('Camera Selected is', $scope.mydata.selectedVideo, $scope.verto.data.videoDevices);\n\n          angular.forEach(verto.data.videoDevices, function(video) {\n            console.log('checking video ', video);\n            if (video.id == $scope.mydata.selectedVideo) {\n              $scope.mydata.selectedVideoName = video.label;\n              console.log('Setting selectedVideoName to ', video.label);\n            }\n          })\n          if ($scope.mydata.selectedSpeaker != storage.data.selectedSpeaker) {\n            $rootScope.$emit('changedSpeaker', $scope.mydata.selectedSpeaker);\n          }\n          storage.changeData($scope.mydata);\n          verto.data.instance.iceServers(storage.data.useSTUN);\n\n          if (storage.data.autoBand) {\n            $scope.testSpeed();\n          }\n\n          var audioParams = {\n            googEchoCancellation: storage.data.googEchoCancellation === undefined ? true : storage.data.googEchoCancellation,\n            googNoiseSuppression: storage.data.googNoiseSuppression === undefined ? true : storage.data.googNoiseSuppression,\n            googHighpassFilter: storage.data.googHighpassFilter === undefined ? true : storage.data.googHighpassFilter,\n            googAutoGainControl: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl,\n            googAutoGainControl2: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl\n          };\n          verto.data.instance.options.audioParams = audioParams;\n\n        };\n\n        $scope.changedLanguage = function(langKey){\n          if (langKey === 'browser'){\n           storage.data.language = 'browser';\n            var browserlang = $translate.preferredLanguage();\n            $translate.use(browserlang).then(\n              function(lang) {}, function(fail_lang) {\n                $translate.use('en');\n               });\n          } else {\n            $translate.use(langKey);\n            storage.data.language = langKey;\n          }\n        };\n\n        $scope.refreshDeviceList = function() {\n          return verto.refreshDevices();\n        };\n\n        $scope.showPreview = function() {\n          var settingsEl = angular.element(document.querySelector('#settings'));\n          settingsEl.toggleClass('toggled');\n          if (!verto.data.call) {\n            $location.path('/preview');\n            return;\n          }\n          else {\n            toastr.warning($translate.instant('MESSAGE_DISPLAY_SETTINGS'));\n          }\n        };\n\n        $scope.testSpeed = function() {\n          $scope.isTestingSpeed = true;\n          return verto.testSpeed(cb);\n\n          function cb(data) {\n            $scope.mydata.vidQual = storage.data.vidQual;\n            $scope.speedMsg = 'Up: ' + data.upKPS + ' Down: ' + data.downKPS;\n            $scope.isTestingSpeed = false;\n            $scope.$apply();\n          }\n        };\n\n        $scope.resetSettings = function() {\n\t  if (confirm('Factory Reset Settings?')) {\n            storage.factoryReset();\n            $scope.logout();\n\t    window.location.reload();\n\t  };\n        };\n\n        $scope.checkAutoBand = function(option) {\n          $scope.mydata.useDedenc = false;\n          var bestres = videoQuality[videoQuality.length-1];\n          $scope.mydata.vidQual = bestres.id;\n          storage.data.vidQual = bestres.id;\n          verto.data.instance.videoParams({\n            minWidth: bestres.width,\n            minHeight: bestres.height,\n            maxWidth: bestres.width,\n            maxHeight: bestres.height,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n          storage.data.vidQual = bestres.id;\n          if (!option) {\n            $scope.mydata.outgoingBandwidth = 'default';\n            $scope.mydata.incomingBandwidth = 'default';\n            $scope.mydata.testSpeedJoin = false;\n\n          } else {\n            $scope.mydata.testSpeedJoin = true;\n          }\n        };\n\n        $scope.checkUseDedRemoteEncoder = function(option) {\n          if (['0', 'default', '5120'].indexOf(option) != -1) {\n            $scope.mydata.useDedenc = false;\n          } else {\n            $scope.mydata.useDedenc = true;\n          }\n        };\n\n        $scope.checkVideoQuality = function(resolution) {\n          var w = videoResolution[resolution]['width'];\n          var h = videoResolution[resolution]['height'];\n          storage.data.vidQual = resolution;\n          verto.data.instance.videoParams({\n            minWidth: w,\n            minHeight: h,\n            maxWidth: w,\n            maxHeight: h,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n\n        };\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('PreviewController', ['$rootScope', '$scope',\n      '$http', '$location', '$modal', '$timeout', 'toastr', 'verto', 'storage', 'prompt', 'Fullscreen', '$translate',\n      function($rootScope, $scope, $http, $location, $modal, $timeout, toastr,\n        verto, storage, prompt, Fullscreen, $translate) {\n\n        $scope.storage = storage;\n        console.debug('Executing PreviewController.');\n        var localVideo = document.getElementById('videopreview');\n        var volumes = document.querySelector('#mic-meter .volumes');\n        if (volumes) {\n          volumes = volumes.children;\n        }\n\n        $scope.localVideo = function() {\n          var constraints = {\n            mirrored: true,\n            audio: {\n              optional: [{ sourceId: storage.data.selectedAudio }]\n            }\n          };\n\n          var newDevice = verto.data.videoDevices.find(function(device) {\n            return device.id == storage.data.selectedVideo;\n          });\n\n          storage.data.selectedVideo = newDevice.id;\n          storage.data.selectedVideoName = newDevice.label;\n\n          if (newDevice.id !== 'none') {\n            constraints.video = {\n              optional: [{ sourceId: newDevice.id }]\n            };\n          }\n\n          navigator.getUserMedia(constraints, handleMedia, function(err, data) {\n\n          });\n        };\n        var audioContext = null;\n        if (typeof AudioContext !== \"undefined\") {\n          audioContext = new AudioContext();\n        }\n\n        var mediaStreamSource = null;\n        var meter = null;\n        var streamObj = {};\n\n        function stopMedia(stream) {\n          if (typeof stream == 'function') {\n            stream.stop();\n          } else {\n            if (stream.active) {\n              var tracks = stream.getTracks();\n              tracks.forEach(function(track, index) {\n                track.stop();\n              })\n            }\n          }\n        }\n        function handleMedia(stream) {\n          if (streamObj) {\n            stopMedia(streamObj);\n          }\n\n          streamObj = stream;\n          FSRTCattachMediaStream(localVideo, stream);\n          if (audioContext) {\n            mediaStreamSource = audioContext.createMediaStreamSource(stream);\n            meter = createAudioMeter(audioContext);\n            mediaStreamSource.connect(meter);\n          };\n        }\n\n        function renderMic() {\n          // meter.volume;\n          var n = Math.round(meter.volume * 25);\n          for(var i = volumes.length -1, j = 0; i >= 0; i--, j++) {\n            var el = angular.element(volumes[j]);\n            if (i >= n) el.removeClass('active');\n            else        el.addClass('active');\n          }\n\n          if(!verto.data.call) {\n            window.requestAnimationFrame(renderMic);\n          }\n        }\n        /**\n         * TODO: useless?\n         */\n\n        $scope.refreshDeviceList = function() {\n         return verto.refreshDevices();\n        };\n\n        $scope.videoCall = function() {\n          prompt({\n            title: $translate.instant('TITLE_ENABLE_VIDEO'),\n            message: $translate.instant('MESSAGE_ENABLE_VIDEO')\n          }).then(function() {\n            storage.data.videoCall = true;\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        };\n\n        $scope.cbMuteVideo = function(event, data) {\n          storage.data.mutedVideo = !storage.data.mutedVideo;\n        }\n\n        $scope.cbMuteMic = function(event, data) {\n          storage.data.mutedMic = !storage.data.mutedMic;\n        }\n\n        $scope.confChangeVideoLayout = function(layout) {\n          verto.data.conf.setVideoLayout(layout);\n        };\n\n        $scope.endPreview = function() {\n          localVideo.src = null;\n          if (audioContext) {\n            meter.shutdown();\n            meter.onaudioprocess = null;\n          };\n          stopMedia(streamObj);\n          $location.path('/dialpad');\n          storage.data.preview = false;\n        };\n\n        $scope.localVideo();\n      }\n    ]);\n})();\n\n(function() {\n    'use strict';\n\n    angular\n        .module('vertoControllers')\n        .controller('LoadingController', ['$rootScope', '$scope', '$location', '$interval', 'verto',\n            function($rootScope, $scope, $location, $interval, verto) {\n                console.log('Loading controller');\n                var int_id;\n\n                $scope.stopInterval = function() {\n                    $interval.cancel(int_id);\n                };\n\n                int_id = $interval(function() {\n                  if (verto.data.resCheckEnded) {\n                    $scope.stopInterval();\n                    $location.path('/preview');\n                  }\n                }, 1000);\n\n            }\n        ]);\n})();\n\n(function() {\n  'use strict';\n  var vertoDirectives = angular.module('vertoDirectives', []);\n})();\n\n/*\nSometimes autofocus HTML5 directive just isn't enough with SPAs.\nThis directive will force autofocus to work properly under those circumstances.\n*/\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('autofocus', ['$timeout',\n    function ($timeout) {\n      return {\n        restrict: 'A',\n        link: function ($scope, $element) {\n          $timeout(function () {\n            $element[0].focus();\n          });\n        }\n      };\n    }\n  ]);\n})();\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('showControls',\n  [\"Fullscreen\", function(Fullscreen) {\n    var link = function(scope, element, attrs) {\n      var i = null;\n      jQuery('.video-footer').fadeIn('slow');\n      jQuery('.video-hover-buttons').fadeIn('slow');\n      element.parent().bind('mousemove', function() {\n        if (Fullscreen.isEnabled()) {\n          clearTimeout(i);\n          jQuery('.video-footer').fadeIn('slow');\n          jQuery('.video-hover-buttons').fadeIn(500);\n          i = setTimeout(function() {\n            if (Fullscreen.isEnabled()) {\n              jQuery('.video-footer').fadeOut('slow');\n              jQuery('.video-hover-buttons').fadeOut(500);\n            }\n          }, 3000);\n        }\n      });\n      element.parent().bind('mouseleave', function() {\n        jQuery('.video-footer').fadeIn();\n        jQuery('.video-hover-buttons').fadeIn();\n      });\n    }\n\n\n    return {\n      link: link\n    };\n  }]);\n\n})();\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives').directive('userStatus',\n  function() {\n    var link = function(scope, element, attrs) {\n      scope.$watch('condition', function(condition) {\n        element.removeClass('connected');\n        element.removeClass('disconnected');\n        element.removeClass('connecting');\n\n        element.addClass(condition);\n\n      });\n    }\n\n    return {\n      scope: {\n        'condition': '='\n      },\n      link: link\n    };\n\n  });\n\n})();\n/**\n * To RTC work properly we need to give a <video> tag as soon as possible\n * because it needs to attach the video and audio stream to the tag.\n *\n * This directive is responsible for moving the video tag from the body to\n * the right place when a call start and move back to the body when the\n * call ends. It also hides and display the tag when its convenient.\n */\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('videoTag',\n  function() {\n\n    function link(scope, element, attrs) {\n      // Moving the video tag to the new place inside the incall page.\n      console.log('Moving the video to element.');\n      var videoElem = jQuery('#webcam');\n\n      var newParent = document.getElementsByClassName('video-tag-wrapper');\n\tnewParent[0].appendChild(document.getElementById('webcam'));\n\n\t$(\"#webcam\").resize(function() {\n\t    updateVideoSize();\n\t});\n\n\t$(window).resize(function() {\n\t    updateVideoSize();\n\t});\n\n\tupdateVideoSize();\n\t\n\tvideoElem.removeClass('hide');\n\tvideoElem.css('display', 'block');\n\n      scope.callActive(\"\", {useVideo: true});\n\n      element.on('$destroy', function() {\n        // Move the video back to the body.\n        console.log('Moving the video back to body.');\n        videoElem.addClass('hide').appendTo(jQuery('body'));\n        $(window).unbind('resize');\n      });\n    }\n\n    return {\n      link: link\n    }\n  });\n\n})();\n\n(function() {\n  'use strict';\n  var vertoFilters = angular.module('vertoFilters', []);\n})();\n\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoFilters')\n  .filter('picturify', function() {\n    var regex = /<a (|target=\"\\s*\\S*\" )href=\"(\\s*\\S*.(png|jpg|svg|gif|webp|bmp))\">\\s*\\S*<\\/a>/i;\n    var regex64 = /data:image\\/(\\s*\\S*);base64,((?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=))/g;\n\n    return function (text, width, n) {\n      var i = 0;\n      width = width || 150; //default width\n      if(regex64.test(text)) {\n        text = text.replace(regex64, '<a href=\"$1\" target=\"_blank\"><img class=\"chat-img\" width=\"'+ width +'\" src=\"data:image/png;base64,$2\"/></a>')\n      }\n\n      do {\n        text = text.replace(regex, '<a $1href=\"$2\"><img class=\"chat-img\" width=\"'+ width +'\" src=\"$2\"/></a>');\n      } while((!n || (n && i++ < n)) && regex.test(text));\n\n      return text;\n    }\n\n  });\n\n})();\n\n(function() {\n  'use strict';\n  var vertoService = angular.module('vertoService', []);\n})();\n\n'use strict';\n\n/* Controllers */\nvar videoQuality = [];\nvar videoQualitySource = [{\n  id: 'qqvga',\n  label: 'QQVGA 160x120',\n  width: 160,\n  height: 120\n}, {\n  id: 'qvga',\n  label: 'QVGA 320x240',\n  width: 320,\n  height: 240\n}, {\n  id: 'vga',\n  label: 'VGA 640x480',\n  width: 640,\n  height: 480\n}, {\n  id: 'qvga_wide',\n  label: 'QVGA WIDE 320x180',\n  width: 320,\n  height: 180\n}, {\n  id: 'vga_wide',\n  label: 'VGA WIDE 640x360',\n  width: 640,\n  height: 360\n}, {\n  id: 'hd',\n  label: 'HD 1280x720',\n  width: 1280,\n  height: 720\n}, {\n  id: 'hhd',\n  label: 'HHD 1920x1080',\n  width: 1920,\n  height: 1080\n}, ];\n\nvar videoResolution = {\n  qqvga: {\n    width: 160,\n    height: 120\n  },\n  qvga: {\n    width: 320,\n    height: 240\n  },\n  vga: {\n    width: 640,\n    height: 480\n  },\n  qvga_wide: {\n    width: 320,\n    height: 180\n  },\n  vga_wide: {\n    width: 640,\n    height: 360\n  },\n  hd: {\n    width: 1280,\n    height: 720\n  },\n  hhd: {\n    width: 1920,\n    height: 1080\n  },\n};\n\nvar bandwidth = [{\n  id: '250',\n  label: '250kb'\n}, {\n  id: '500',\n  label: '500kb'\n}, {\n  id: '1024',\n  label: '1mb'\n}, {\n  id: '1536',\n  label: '1.5mb'\n}, {\n  id: '2048',\n  label: '2mb'\n}, {\n  id: '3196',\n  label: '3mb'\n}, {\n  id: '4192',\n  label: '4mb'\n}, {\n  id: '5120',\n  label: '5mb'\n}, {\n  id: '0',\n  label: 'No Limit'\n}, {\n  id: 'default',\n  label: 'Server Default'\n}, ];\n\nvar framerate = [{\n  id: '15',\n  label: '15 FPS'\n}, {\n  id: '20',\n  label: '20 FPS'\n}, {\n  id: '30',\n  label: '30 FPS'\n}, ];\n\nvar updateReq;\n\nvar updateVideoSize = function(ms) {\n    if (!ms) ms = 500;\n\n    clearTimeout(updateReq);\n    updateReq = setTimeout(function () {\n        var videoElem = jQuery('#webcam');\n        videoElem.width(\"\");\n        videoElem.height(\"\");\n\n        var w = videoElem.width();\n        var h = videoElem.height();\n        var new_w, new_h;\n        var aspect = w / h;\n        var videoContainer = jQuery('div.video-wrapper');\n        if (w > h) {\n            new_w = videoContainer.width();\n            new_h = Math.round(videoContainer.width() / aspect);\n        } else {\n            new_h = videoContainer.height();\n            new_w = Math.round(videoContainer.height() / aspect);\n        }\n        videoElem.width(new_w);\n        videoElem.height(new_h);\n        console.log('Setting video size to ' + new_w + '/' + new_h);\n    }, ms);\n}\n\nvar vertoService = angular.module('vertoService', ['ngCookies']);\n\nvertoService.service('verto', ['$rootScope', '$cookieStore', '$location', 'storage',\n  function($rootScope, $cookieStore, $location, storage) {\n    var data = {\n      // Connection data.\n      instance: null,\n      connected: false,\n\n      // Call data.\n      call: null,\n      shareCall: null,\n      callState: null,\n      conf: null,\n      confLayouts: [],\n      confRole: null,\n      chattingWith: null,\n      liveArray: null,\n\n      // Settings data.\n      videoDevices: [],\n      audioDevices: [],\n      shareDevices: [],\n      videoQuality: [],\n      extension: $cookieStore.get('verto_demo_ext'),\n      name: $cookieStore.get('verto_demo_name'),\n      email: $cookieStore.get('verto_demo_email'),\n      cid: $cookieStore.get('verto_demo_cid'),\n      textTo: $cookieStore.get('verto_demo_textto') || \"1000\",\n      login: $cookieStore.get('verto_demo_login') || \"1008\",\n      password: $cookieStore.get('verto_demo_passwd') || \"1234\",\n      hostname: window.location.hostname,\n      wsURL: (\"wss://\" + window.location.hostname + \":8082\"),\n      wsFallbackURL: null,\n      turnServer: null,\n      resCheckEnded: false\n    };\n\n    function cleanShareCall(that) {\n      data.shareCall = null;\n      data.callState = 'active';\n      that.refreshDevices();\n    }\n\n    function cleanCall() {\n      data.call = null;\n      data.callState = null;\n      data.conf = null;\n      data.confLayouts = [];\n      data.confRole = null;\n      data.chattingWith = null;\n\n      $rootScope.$emit('call.hangup', 'hangup');\n    }\n\n    function inCall() {\n      $rootScope.$emit('page.incall', 'call');\n    }\n\n    function callActive(last_state, params) {\n      $rootScope.$emit('call.active', last_state, params);\n    }\n\n    function calling() {\n      $rootScope.$emit('call.calling', 'calling');\n    }\n\n    function incomingCall(number) {\n      $rootScope.$emit('call.incoming', number);\n    }\n\n    function updateResolutions(supportedResolutions) {\n      console.debug('Attempting to sync supported and available resolutions');\n\n      //var removed = 0;\n\n      console.debug(\"VQ length: \" + videoQualitySource.length);\n      console.debug(supportedResolutions);\n\n      angular.forEach(videoQualitySource, function(resolution, id) {\n        angular.forEach(supportedResolutions, function(res) {\n          var width = res[0];\n          var height = res[1];\n\n          if(resolution.width == width && resolution.height == height) {\n            videoQuality.push(resolution);\n          }\n        });\n      });\n\n      // videoQuality.length = videoQuality.length - removed;\n      console.debug(\"VQ length 2: \" + videoQuality.length);\n      data.videoQuality = videoQuality;\n      console.debug(videoQuality);\n      data.vidQual = (videoQuality.length > 0) ? videoQuality[videoQuality.length - 1].id : null;\n      console.debug(data.vidQual);\n\n      return videoQuality;\n    };\n\n    var callState = {\n      muteMic: false,\n      muteVideo: false\n    };\n\n    return {\n      data: data,\n      callState: callState,\n\n      // Options to compose the interface.\n      videoQuality: videoQuality,\n      videoResolution: videoResolution,\n      bandwidth: bandwidth,\n      framerate: framerate,\n\n      refreshDevicesCallback : function refreshDevicesCallback(callback) {\n        data.videoDevices = [{\n          id: 'none',\n          label: 'No Camera'\n        }];\n        data.shareDevices = [{\n          id: 'screen',\n          label: 'Screen'\n        }];\n        data.audioDevices = [{\n          id: 'any',\n          label: 'Default Microphone'\n\t},\n\t{\n\t    id: 'none',\n\t    label: 'No Microphone'\n        }];\n        data.speakerDevices = [{\n\t    id: 'any',\n\t    label: 'Default Speaker'\n\t}];\n\n        if(!storage.data.selectedShare) {\n          storage.data.selectedShare = data.shareDevices[0]['id'];\n        }\n\n        for (var i in jQuery.verto.videoDevices) {\n          var device = jQuery.verto.videoDevices[i];\n          if (!device.label) {\n            data.videoDevices.push({\n              id: 'Camera ' + i,\n              label: 'Camera ' + i\n            });\n          } else {\n            data.videoDevices.push({\n              id: device.id,\n              label: device.label || device.id\n            });\n          }\n\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedVideo) {\n            storage.data.selectedVideo = device.id;\n          }\n\n          if (!device.label) {\n            data.shareDevices.push({\n              id: 'Share Device ' + i,\n              label: 'Share Device ' + i\n            });\n            continue;\n          }\n\n          data.shareDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n\n        for (var i in jQuery.verto.audioInDevices) {\n          var device = jQuery.verto.audioInDevices[i];\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedAudio) {\n            storage.data.selectedAudio = device.id;\n          }\n\n          if (!device.label) {\n            data.audioDevices.push({\n              id: 'Microphone ' + i,\n              label: 'Microphone ' + i\n            });\n            continue;\n          }\n          data.audioDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n\n        for (var i in jQuery.verto.audioOutDevices) {\n          var device = jQuery.verto.audioOutDevices[i];\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedSpeaker) {\n            storage.data.selectedSpeaker = device.id;\n          }\n\n          if (!device.label) {\n            data.speakerDevices.push({\n              id: 'Speaker ' + i,\n              label: 'Speaker ' + i\n            });\n            continue;\n          }\n          data.speakerDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n        console.debug('Devices were refreshed, checking that we have cameras.');\n\n        // Verify if selected devices are valid\n        var videoFlag = data.videoDevices.some(function(device) {\n          console.log('Evaluating device ', device);\n          if (device.label == storage.data.selectedVideoName) {\n            console.log('Matched video selection by name: ', device.label);\n            storage.data.selectedVideo = device.id;\n            return true;\n          }\n          return device.id == storage.data.selectedVideo && storage.data.selectedVideo !== \"none\";\n        });\n\n        var shareFlag = data.shareDevices.some(function(device) {\n          return device.id == storage.data.selectedShare;\n        });\n\n        var audioFlag = data.audioDevices.some(function(device) {\n          return device.id == storage.data.selectedAudio;\n        });\n\n        var speakerFlag = data.speakerDevices.some(function(device) {\n          return device.id == storage.data.selectedSpeaker;\n        });\n\n        console.log('Storage Video: ', storage.data.selectedVideo);\n        console.log('Video Flag: ', videoFlag)\n\n        if (!videoFlag) storage.data.selectedVideo = data.videoDevices[data.videoDevices.length - 1].id;\n        if (!shareFlag) storage.data.selectedShare = data.shareDevices[0].id;\n        if (!audioFlag) storage.data.selectedAudio = data.audioDevices[0].id;\n        if (!speakerFlag && data.speakerDevices.length > 0) storage.data.selectedSpeaker = data.speakerDevices[0].id;\n\n        // This means that we cannot use video!\n        if (data.videoDevices.length === 0) {\n          console.log('No camera, disabling video.');\n          data.canVideo = false;\n          data.videoDevices.push({\n            id: 'none',\n            label: 'No camera'\n          });\n        } else {\n          data.canVideo = true;\n        }\n\n        if(angular.isFunction(callback)) {\n          callback();\n        }\n      },\n\n      refreshDevices: function(callback) {\n        console.debug('Attempting to refresh the devices.');\n        if(callback) {\n          jQuery.verto.refreshDevices(callback);\n        } else {\n          jQuery.verto.refreshDevices(this.refreshDevicesCallback);\n        }\n      },\n\n      /**\n       * Updates the video resolutions based on settings.\n       */\n      refreshVideoResolution: function(resolutions) {\n        console.debug('Attempting to refresh video resolutions.');\n\n        if (data.instance) {\n          var w = resolutions['bestResSupported'][0];\n          var h = resolutions['bestResSupported'][1];\n\n          if (h === 1080) {\n            w = 1280;\n            h = 720;\n          }\n\n          updateResolutions(resolutions['validRes']);\n          /* Do not touch video device resolution if autoBand is off and we have selected a vidQual */\n          if (!storage.data.autoBand && storage.data.vidQual) {\n            w = videoResolution[storage.data.vidQual].width;\n            h = videoResolution[storage.data.vidQual].height;\n          }\n          data.instance.videoParams({\n            minWidth: w,\n            minHeight: h,\n            maxWidth: w,\n            maxHeight: h,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n          videoQuality.forEach(function(qual){\n            if (w === qual.width && h === qual.height) {\n              if (storage.data.vidQual !== qual.id || storage.data.vidQual === undefined) {\n                storage.data.vidQual = qual.id;\n              }\n            }\n\n          });\n          data.resCheckEnded = true;\n\n        } else {\n          console.debug('There is no instance of verto.');\n        }\n      },\n\n      /**\n       * Connects to the verto server. Automatically calls `onWSLogin`\n       * callback set in the verto object.\n       *\n       * @param callback\n       */\n      connect: function(callback) {\n        console.debug('Attempting to connect to verto.');\n        var that = this;\n\n        function startConference(v, dialog, pvtData) {\n          $rootScope.$emit('call.video', 'video');\n          $rootScope.$emit('call.conference', 'conference');\n          data.chattingWith = pvtData.chatID;\n          data.confRole = pvtData.role;\n          data.conferenceMemberID = pvtData.conferenceMemberID;\n          var conf = new $.verto.conf(v, {\n            dialog: dialog,\n            hasVid: storage.data.useVideo,\n            laData: pvtData,\n            chatCallback: function(v, e) {\n              var from = e.data.fromDisplay || e.data.from || \"Unknown\";\n              var message = e.data.message || \"\";\n              $rootScope.$emit('chat.newMessage', {\n                from: from,\n                body: message\n              });\n            },\n            onBroadcast: function(v, conf, message) {\n              console.log('>>> conf.onBroadcast:', arguments);\n              if (message.action == 'response') {\n                // This is a response with the video layouts list.\n                if (message['conf-command'] == 'list-videoLayouts') {\n                  var rdata = [];\n\n                  for (var i in message.responseData) {\n                    rdata.push(message.responseData[i].name);\n                  }\n\n                  var options = rdata.sort(function(a, b) {\n                    var ga = a.substring(0, 6) == \"group:\" ? true : false;\n                    var gb = b.substring(0, 6) == \"group:\" ? true : false;\n\n                    if ((ga || gb) && ga != gb) {\n                      return ga ? -1 : 1;\n                    }\n\n                    return ( ( a == b ) ? 0 : ( ( a > b ) ? 1 : -1 ) );\n                  });\n                  data.confLayoutsData = message.responseData;\n                  data.confLayouts = options;\n                } else if (message['conf-command'] == 'canvasInfo') {\n                  data.canvasInfo = message.responseData;\n                  $rootScope.$emit('conference.canvasInfo', message.responseData);\n                } else {\n                  $rootScope.$emit('conference.broadcast', message);\n                }\n              }\n            }\n          });\n\n          if (data.confRole == \"moderator\") {\n            console.log('>>> conf.listVideoLayouts();');\n            conf.listVideoLayouts();\n            conf.modCommand('canvasInfo');\n          }\n\n          data.conf = conf;\n\n          data.liveArray = new $.verto.liveArray(\n            data.instance, pvtData.laChannel,\n            pvtData.laName, {\n              subParams: {\n                callID: dialog ? dialog.callID : null\n              }\n            });\n\n          data.liveArray.onErr = function(obj, args) {\n            console.log('liveArray.onErr', obj, args);\n          };\n\n          data.liveArray.onChange = function(obj, args) {\n            // console.log('liveArray.onChange', obj, args);\n            switch (args.action) {\n              case 'bootObj':\n                $rootScope.$emit('members.boot', args.data);\n                args.data.forEach(function(member){\n                  var callId = member[0];\n                  var status = angular.fromJson(member[1][4]);\n                  if (callId === data.call.callID) {\n                    $rootScope.$apply(function(){\n                      data.mutedMic = status.audio.muted;\n                      data.mutedVideo = status.video.muted;\n                    });\n                  }\n                });\n                break;\n              case 'add':\n                var member = [args.key, args.data];\n                $rootScope.$emit('members.add', member);\n                break;\n              case 'del':\n                var uuid = args.key;\n                $rootScope.$emit('members.del', uuid);\n                break;\n              case 'clear':\n                $rootScope.$emit('members.clear');\n                break;\n              case 'modify':\n                var member = [args.key, args.data];\n                $rootScope.$emit('members.update', member);\n                break;\n              default:\n                console.log('NotImplemented', args.action);\n            }\n          };\n        }\n\n        function stopConference() {\n          console.log('stopConference()');\n          if (data.liveArray) {\n            data.liveArray.destroy();\n            console.log('Has data.liveArray.');\n            $rootScope.$emit('members.clear');\n            data.liveArray = null;\n          } else {\n            console.log('Doesn\\'t found data.liveArray.');\n          }\n\n          if (data.conf) {\n            data.conf.destroy();\n            data.conf = null;\n          }\n        }\n\n        var callbacks = {\n          onWSLogin: function(v, success) {\n            data.connected = success;\n            $rootScope.loginFailed = !success;\n            $rootScope.$emit('ws.login', success);\n            console.debug('Connected to verto server:', success);\n\n            if (angular.isFunction(callback)) {\n              callback(v, success);\n            }\n          },\n\n          onMessage: function(v, dialog, msg, params) {\n            console.debug('onMessage:', v, dialog, msg, params);\n\n            switch (msg) {\n              case $.verto.enum.message.pvtEvent:\n                if (params.pvtData) {\n                  switch (params.pvtData.action) {\n                    case \"conference-liveArray-join\":\n\t\t      if (!params.pvtData.screenShare && !params.pvtData.videoOnly) {\n\t\t\t  console.log(\"conference-liveArray-join\");\n\t\t\t  stopConference();\n\t\t\t  startConference(v, dialog, params.pvtData);\n\t\t\t  updateVideoSize();\n\t\t      }\n                      break;\n                    case \"conference-liveArray-part\":\n\t\t      if (!params.pvtData.screenShare && !params.pvtData.videoOnly) {\n\t\t\t  console.log(\"conference-liveArray-part\");\n\t\t\t  stopConference();\n\t\t      }\n                      break;\n                  }\n                }\n                break;\n              /**\n                * This is not being used for conferencing chat\n                * anymore (see conf.chatCallback for that).\n                */\n              case $.verto.enum.message.info:\n                var body = params.body;\n                var from = params.from_msg_name || params.from;\n                if (!body) {\n                  console.log('Received an empty body: ', params);\n                  return;\n                }\n                $rootScope.$emit('chat.newMessage', {\n                  from: from,\n                  body: body\n                });\n                break;\n              case $.verto.enum.message.display:\n                    $rootScope.$apply(function() {});\n                    break;\n              case $.verto.enum.message.clientReady:\n                    $rootScope.$emit('clientReady', {\n                      reattached_sessions: params.reattached_sessions,\n                    });\n                    break;\n              default:\n                console.warn('Got a not implemented message:', msg, dialog, params);\n                break;\n            }\n          },\n\n          onDialogState: function(d) {\n            if (!data.call) {\n              data.call = d;\n\n            }\n\n            console.debug('onDialogState:', d);\n            switch (d.state.name) {\n              case \"ringing\":\n                incomingCall(d.params.caller_id_number);\n                break;\n              case \"trying\":\n                console.debug('Calling:', d.cidString());\n                data.callState = 'trying';\n                break;\n              case \"early\":\n                console.debug('Talking to:', d.cidString());\n                data.callState = 'active';\n                calling();\n                break;\n              case \"active\":\n                console.debug('Talking to:', d.cidString());\n                data.callState = 'active';\n                callActive(d.lastState.name, d.params);\n\t\tupdateVideoSize();\n                break;\n              case \"hangup\":\n                console.debug('Call ended with cause: ' + d.cause);\n                data.callState = 'hangup';\n                break;\n              case \"destroy\":\n                console.debug('Destroying: ' + d.cause);\n                if (d.params.screenShare) {\n                  cleanShareCall(that);\n                } else {\n                  stopConference();\n                  if (!that.reloaded) {\n                    cleanCall();\n                  }\n                }\n                break;\n              default:\n                console.warn('Got a not implemented state:', d);\n                break;\n            }\n          },\n\n          onWSClose: function(v, success) {\n            console.debug('onWSClose:', success);\n            $rootScope.$emit('ws.close', success);\n          },\n\n          onEvent: function(v, e) {\n            console.debug('onEvent:', e);\n          }\n        };\n\n        var that = this;\n        function ourBootstrap() {\n          var sessid = $location.search().sessid;\n          if (sessid === 'random') {\n            sessid = $.verto.genUUID();\n            $location.search().sessid = sessid;\n          }\n          // Checking if we have a failed connection attempt before\n          // connecting again.\n          if (data.instance && !data.instance.rpcClient.socketReady()) {\n            data.instance.rpcClient.stopRetrying();\n            data.instance.logout();\n            data.instance.login();\n            return;\n          };\n          data.instance = new jQuery.verto({\n            login: data.login + '@' + data.hostname,\n            passwd: data.password,\n            socketUrl: data.wsURL,\n            wsFallbackURL: data.wsFallbackURL,\n            turnServer: data.turnServer,\n            tag: \"webcam\",\n            ringFile: \"sounds/bell_ring2.wav\",\n            audioParams: {\n                googEchoCancellation: storage.data.googEchoCancellation === undefined ? true : storage.data.googEchoCancellation,\n                googNoiseSuppression: storage.data.googNoiseSuppression === undefined ? true : storage.data.googNoiseSuppression,\n                googHighpassFilter: storage.data.googHighpassFilter === undefined ? true : storage.data.googHighpassFilter,\n                googAutoGainControl: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl,\n                googAutoGainControl2: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl\n            },\n            sessid: sessid,\n            iceServers: storage.data.useSTUN\n          }, callbacks);\n\n          // We need to know when user reloaded page and not react to\n          // verto events in order to not stop the reload and redirect user back\n          // to the dialpad.\n          that.reloaded = false;\n          jQuery.verto.unloadJobs.push(function() {\n            that.reloaded = true;\n          });\n\n          data.instance.deviceParams({\n            useCamera: storage.data.selectedVideo,\n            useSpeak: storage.data.selectedSpeaker,\n            useMic: storage.data.selectedAudio,\n            onResCheck: that.refreshVideoResolution\n          });\n        }\n        if (data.mediaPerm) {\n          ourBootstrap();\n        } else {\n          $.FSRTC.checkPerms(ourBootstrap, true, true);\n        }\n      },\n\n      mediaPerm: function(callback) {\n        $.FSRTC.checkPerms(callback, true, true);\n      },\n\n      /**\n       * Login the client.\n       *\n       * @param callback\n       */\n      login: function(callback) {\n        data.instance.loginData({\n          login: data.login + '@' + data.hostname,\n          passwd: data.password\n        });\n        data.instance.login();\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Disconnects from the verto server. Automatically calls `onWSClose`\n       * callback set in the verto object.\n       *\n       * @param callback\n       */\n      disconnect: function(callback) {\n        console.debug('Attempting to disconnect to verto.');\n\n        data.instance.logout();\n        data.connected = false;\n\n        console.debug('Disconnected from verto server.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, data.connected);\n        }\n      },\n\n      /**\n       * Make a call.\n       *\n       * @param callback\n       */\n      call: function(destination, callback, custom) {\n        console.debug('Attempting to call destination ' + destination + '.');\n\n        var call = data.instance.newCall(angular.extend({\n          destination_number: destination,\n          caller_id_name: data.name,\n          caller_id_number: data.callerid ? data.callerid : data.email,\n          outgoingBandwidth: storage.data.outgoingBandwidth,\n          incomingBandwidth: storage.data.incomingBandwidth,\n          useVideo: storage.data.useVideo,\n          useStereo: storage.data.useStereo,\n          useCamera: storage.data.selectedVideo,\n          useSpeak: storage.data.selectedSpeaker,\n          useMic: storage.data.selectedAudio,\n          dedEnc: storage.data.useDedenc,\n          mirrorInput: storage.data.mirrorInput,\n          userVariables: {\n            email : storage.data.email,\n            avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n          }\n        }, custom));\n\n        data.call = call;\n\n        data.mutedMic = false;\n        data.mutedVideo = false;\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, call);\n        }\n      },\n\n      screenshare: function(destination, callback) {\n\n\n          var that = this;\n\n\t  if (storage.data.selectedShare !== \"screen\") {\n\n              console.log('share screen from device ' + storage.data.selectedShare);\n\n\t      var call = data.instance.newCall({\n\t\t  destination_number: destination + \"-screen\",\n\t\t  caller_id_name: data.name + \" (Screen)\",\n\t\t  caller_id_number: data.login + \" (screen)\",\n\t\t  outgoingBandwidth: storage.data.outgoingBandwidth,\n\t\t  incomingBandwidth: storage.data.incomingBandwidth,\n\t\t  useCamera: storage.data.selectedShare,\n\t\t  useVideo: true,\n\t\t  screenShare: true,\n\t\t  dedEnc: storage.data.useDedenc,\n\t\t  mirrorInput: storage.data.mirrorInput,\n\t\t  userVariables: {\n\t\t      email : storage.data.email,\n\t\t      avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n\t\t  }\n\t      });\n\n              // Override onStream callback in $.FSRTC instance\n              call.rtc.options.callbacks.onStream = function(rtc, stream) {\n\t\t  if(stream) {\n\t\t      var StreamTrack = stream.getVideoTracks()[0];\n\t\t      StreamTrack.addEventListener('ended', stopSharing);\n\t\t      // (stream.getVideoTracks()[0]).onended = stopSharing;\n\t\t  }\n\n\t\t  console.log(\"screenshare started\");\n\n\t\t  function stopSharing() {\n\t\t      if(that.data.shareCall) {\n\t\t\t  that.screenshareHangup();\n\t\t\t  console.log(\"screenshare ended\");\n\t\t      }\n\t\t  }\n              };\n\n              data.shareCall = call;\n\n              console.log('shareCall', data);\n\n              data.mutedMic = false;\n              data.mutedVideo = false;\n\n              that.refreshDevices();\n\n\t      return;\n\t  }\n\n\n        console.log('share screen from plugin ' + storage.data.selectedShare);\n\n        var screenfunc = function(error, sourceId, screen_constraints) {\n\n          if(error) {\n            $rootScope.$emit('ScreenShareExtensionStatus', error);\n            return;\n          }\n\n          var share_call = data.instance.newCall({\n            destination_number: destination + '-screen',\n            caller_id_name: data.name + ' (Screen)',\n            caller_id_number: data.login + ' (Screen)',\n            outgoingBandwidth: storage.data.outgoingBandwidth,\n            incomingBandwidth: storage.data.incomingBandwidth,\n            videoParams: screen_constraints ? screen_constraints.video.mandatory : {},\n            useVideo: true,\n            screenShare: true,\n            dedEnc: storage.data.useDedenc,\n            mirrorInput: storage.data.mirrorInput,\n            userVariables: {\n              email : storage.data.email,\n              avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n            }\n          });\n\n          // Override onStream callback in $.FSRTC instance\n          share_call.rtc.options.callbacks.onStream = function(rtc, stream) {\n            if(stream) {\n              var StreamTrack = stream.getVideoTracks()[0];\n              StreamTrack.addEventListener('ended', stopSharing);\n              // (stream.getVideoTracks()[0]).onended = stopSharing;\n            }\n\n            console.log(\"screenshare started\");\n\n            function stopSharing() {\n              if(that.data.shareCall) {\n                that.screenshareHangup();\n                console.log(\"screenshare ended\");\n              }\n            }\n          };\n\n          data.shareCall = share_call;\n\n          console.log('shareCall', data);\n\n          data.mutedMic = false;\n          data.mutedVideo = false;\n        };\n\n\t  if (!!navigator.mozGetUserMedia) {\n\t      screenfunc();\n\t  } else {\n              getScreenId(screenfunc);\n\t  }\n\n      },\n\n      screenshareHangup: function() {\n        if (!data.shareCall) {\n          console.debug('There is no call to hangup.');\n          return false;\n        }\n\n        console.log('shareCall End', data.shareCall);\n        data.shareCall.hangup();\n\n        console.debug('The screencall was hangup.');\n\n      },\n\n      /**\n       * Hangup the current call.\n       *\n       * @param callback\n       */\n      hangup: function(callback) {\n        console.debug('Attempting to hangup the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to hangup.');\n          return false;\n        }\n\n        data.call.hangup();\n\n        if (data.conf) {\n          data.conf.destroy();\n          data.conf = null;\n        }\n\n        console.debug('The call was hangup.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Send a DTMF to the current call.\n       *\n       * @param {string|integer} number\n       * @param callback\n       */\n      dtmf: function(number, callback) {\n        console.debug('Attempting to send DTMF \"' + number + '\".');\n\n        if (!data.call) {\n          console.debug('There is no call to send DTMF.');\n          return false;\n        }\n\n        data.call.dtmf(number.toString());\n        console.debug('The DTMF was sent for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Do speed test.\n       *\n       * @param callback\n       */\n      testSpeed: function(cb) {\n\n        data.instance.rpcClient.speedTest(1024 * 256, function(e, data) {\n          var upBand = Math.ceil(data.upKPS * .75),\n              downBand = Math.ceil(data.downKPS * .75);\n\n\n          if (storage.data.autoBand) {\n            storage.data.incomingBandwidth = downBand;\n            storage.data.outgoingBandwidth = upBand;\n            storage.data.useDedenc = false;\n            storage.data.vidQual = 'hd';\n\n            if (upBand < 256) {\n              storage.data.vidQual = 'qqvga';\n            }\n            else if (upBand < 512) {\n              storage.data.vidQual = 'qvga';\n            }\n            else if (upBand < 1024) {\n              storage.data.vidQual = 'vga';\n            }\n          }\n\n          if(cb) {\n            cb(data);\n          }\n\n          $rootScope.$emit('testSpeed', data);\n        });\n      },\n      /**\n       * Mute the microphone for the current call.\n       *\n       * @param callback\n       */\n      muteMic: function(callback) {\n        console.debug('Attempting to mute mic for the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to mute.');\n          return false;\n        }\n\n        data.call.dtmf('0');\n        data.mutedMic = !data.mutedMic;\n        console.debug('The mic was muted for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Mute the video for the current call.\n       *\n       * @param callback\n       */\n      muteVideo: function(callback) {\n        console.debug('Attempting to mute video for the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to mute.');\n          return false;\n        }\n\n        data.call.dtmf('*0');\n        data.mutedVideo = !data.mutedVideo;\n        console.debug('The video was muted for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n      /*\n      * Method is used to send conference chats ONLY.\n      */\n      sendConferenceChat: function(message) {\n        data.conf.sendChat(message, \"message\");\n      },\n      setCanvasIn: function(memberID, canvasID) {\n        data.conf.modCommand('vid-canvas', memberID, canvasID);\n      },\n      setCanvasOut: function(memberID, canvasID) {\n        data.conf.modCommand('vid-watching-canvas', memberID, canvasID);\n      },\n      setLayer: function(memberID, canvasID) {\n        data.conf.modCommand('vid-layer', memberID, canvasID);\n      },\n      /*\n      * Method is used to set a member's resevartion Id.\n      */\n      setResevartionId: function(memberID, resID) {\n        data.conf.modCommand('vid-res-id', memberID, resID);\n      },\n      /*\n      * Method is used to send user2user chats.\n      * VC does not yet support that.\n      */\n      sendMessage: function(body, callback) {\n        data.call.message({\n          to: data.chattingWith,\n          body: body,\n          from_msg_name: data.name,\n          from_msg_number: data.cid\n        });\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      }\n    };\n  }\n]);\n\n'use strict';\n\nvar vertoService = angular.module('vertoService');\n\nvertoService.service('config', ['$rootScope', '$http', '$location', 'storage', 'verto',\n  function($rootScope, $http, $location, storage, verto) {\n    var configure = function() {\n      /**\n       * Load stored user info into verto service\n       */\n      if(storage.data.name) {\n        verto.data.name = storage.data.name;\n      }\n      if(storage.data.email) {\n        verto.data.email = storage.data.email;\n      }\n      if(storage.data.login) {\n        verto.data.login = storage.data.login;\n      }\n      if(storage.data.password) {\n        verto.data.password = storage.data.password;\n      }\n\n      /*\n       * Load the Configs before logging in\n       * with cache buster\n       */\n      var url = window.location.origin + window.location.pathname;\n      var httpRequest = $http.get(url + 'config.json?cachebuster=' + Math.floor((Math.random()*1000000)+1));\n\n      var httpReturn = httpRequest.then(function(response) {\n        var data = response.data;\n\n        /* save these for later as we're about to possibly over write them */\n        var name = verto.data.name;\n        var email = verto.data.email;\n\n        console.debug(\"googlelogin: \" + data.googlelogin);\n        if (data.googlelogin){\n          verto.data.googlelogin = data.googlelogin;\n          verto.data.googleclientid = data.googleclientid;\n        }\n\n        if (data.wsFallbackURL) {\n          verto.data.wsFallbackURL = data.wsFallbackURL;\n        }\n\n        if (data.turnServer) {\n          verto.data.turnServer = data.turnServer;\n        }\n\n        angular.extend(verto.data, data);\n\n        /**\n         * use stored data (localStorage) for login, allow config.json to take precedence\n         */\n\n        if (name != '' && data.name == '') {\n          verto.data.name = name;\n        }\n        if (email != '' && data.email == '') {\n          verto.data.email = email;\n        }\n        if (verto.data.login == '' && verto.data.password == '' && storage.data.login != '' && storage.data.password != '') {\n          verto.data.login = storage.data.login;\n          verto.data.password = storage.data.password;\n        }\n\n        if (verto.data.autologin == \"true\" && !verto.data.autologin_done) {\n          console.debug(\"auto login per config.json\");\n          verto.data.autologin_done = true;\n        }\n\n        if(verto.data.autologin && storage.data.name.length && storage.data.email.length && storage.data.login.length && storage.data.password.length) {\n          $rootScope.$emit('config.http.success', data);\n        };\n        return response;\n      }, function(response) {\n        $rootScope.$emit('config.http.error', response);\n        return response;\n      });\n\n      return httpReturn;\n    };\n\n    return {\n      'configure': configure\n    };\n  }]);\n\n'use strict';\n\n  angular\n    .module('vertoService')\n    .service('eventQueue', ['$rootScope', '$q', 'storage', 'verto',\n      function($rootScope, $q, storage, verto) {\n        \n        var events = [];\n        \n        var next = function() {\n          var fn, fn_return;\n          \n          fn = events.shift();\n          \n          if (fn == undefined) {\n            $rootScope.$emit('eventqueue.complete');\n            return;\n          }\n          fn_return = fn();\n\n          var emitNextProgress = function() {\n            $rootScope.$emit('eventqueue.next');\n          };\n\n          fn_return.then(\n            function() {\n              emitNextProgress();\n            }, \n            function() {\n              emitNextProgress();\n            }\n          );\n        };\n\n        var process = function() {\n          $rootScope.$on('eventqueue.next', function (ev){\n            next();\n          });\n          \n          next(); \n        };\n\n        return {\n          'next': next,\n          'process': process,\n          'events': events\n        };\n\n      }]);\n \n\n(function() {\n  'use strict';\n  var vertoService = angular.module('storageService', ['ngStorage']);\n})();\n\n'use strict';\n\n  angular\n  .module('storageService')\n  .service('storage', ['$rootScope', '$localStorage',\n  function($rootScope, $localStorage) {\n    var data = $localStorage,\n\tdefaultSettings = {\n\t  ui_connected: false,\n          ws_connected: false,\n          cur_call: 0,\n          called_number: '',\n          useVideo: true,\n          call_history: {},\n          history_control: [],\n          call_start: false,\n          name: '',\n          email: '',\n          login: '',\n          password: '',\n          userStatus: 'disconnected',\n          mutedVideo: false,\n          mutedMic: false,\n          preview: true,\n          selectedVideo: null,\n          selectedVideoName: null,\n          selectedAudio: null,\n          selectedShare: null,\n          selectedSpeaker: null,\n          useStereo: true,\n          useSTUN: true,\n          useDedenc: false,\n          mirrorInput: false,\n          outgoingBandwidth: 'default',\n          incomingBandwidth: 'default',\n          vidQual: undefined,\n          askRecoverCall: false,\n          googNoiseSuppression: true,\n          googHighpassFilter: true,\n          googEchoCancellation: true,\n          googAutoGainControl: true,\n          autoBand: true,\n          testSpeedJoin: true,\n          bestFrameRate: \"15\",\n          language: undefined\n       };\n\n    data.$default(defaultSettings);\n\n    function changeData(verto_data) {\n      jQuery.extend(true, data, verto_data);\n    }\n\n    return {\n      data: data,\n      changeData: changeData,\n      reset: function() {\n        data.ui_connected = false;\n        data.ws_connected = false;\n        data.cur_call = 0;\n        data.userStatus = 'disconnected';\n      },\n      factoryReset: function() {\n        localStorage.clear();\n        // set defaultSettings again\n        data.$reset(defaultSettings);\n      },\n    };\n  }\n]);\n\n'use strict';\n\n  angular\n  .module('storageService')\n  .factory('CallHistory', [\"storage\", function(storage) {\n\n    var history = storage.data.call_history;\n    var history_control = storage.data.history_control;\n\n    var addCallToHistory = function(number, direction, status) {\n      if(history[number] == undefined) {\n        history[number] = [];\n      }\n\n      history[number].unshift({\n        'number': number,\n        'direction': direction,\n        'status': status,\n        'call_start': Date()\n      });\n\n      var index = history_control.indexOf(number);\n      console.log(index);\n      if(index > -1) {\n        history_control.splice(index, 1);\n      }\n\n      history_control.unshift(number);\n\n    };\n\n    var getCallsFromHistory = function(number) {\n      return history[number];\n    };\n\n    return {\n      all: function() {\n        return history;\n      },\n      all_control: function() {\n        return history_control;\n      },\n      get: function(number) {\n        return getCallsFromHistory(number);\n      },\n      add: function(number, direction, status) {\n        return addCallToHistory(number, direction, status);\n      },\n      clear: function() {\n        storage.data.call_history = {};\n        storage.data.history_control = [];\n        history = storage.data.call_history;\n        history_control = storage.data.history_control;\n        return history_control;\n      }\n    }\n}]);\n\n'use strict';\n\n  angular\n    .module('storageService')\n    .service('splashscreen', ['$rootScope', '$q', 'storage', 'config', 'verto', '$translate',\n      function($rootScope, $q, storage, config, verto, $translate) {\n\n        var checkBrowser = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'browser-upgrade';\n            var result = {\n              'activity': activity,\n              'soft': false,\n              'status': 'success',\n              'message': $translate.instant('BROWSER_COMPATIBILITY')\n            };\n            if (!navigator.mediaDevices.getUserMedia) {\n              result['status'] = 'error';\n              result['message'] = $translate.instant('BROWSER_WITHOUT_WEBRTC');\n              reject(result);\n            }\n\n            resolve(result);\n\n          });\n        };\n\n        var checkMediaPerm = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'media-perm';\n            var result = {\n              'activity': activity,\n              'soft': false,\n              'status': 'success',\n              'message': $translate.instant('CHECK_PERMISSION_MEDIA')\n            };\n\n            verto.mediaPerm(function(status) {\n              if(!status) {\n                result['status'] = 'error';\n                result['message'] = $translate.instant('ERROR_PERMISSION_MEDIA');\n                verto.data.mediaPerm = false;\n                reject(result);\n              }\n              verto.data.mediaPerm = true;\n              resolve(result);\n            });\n          });\n        };\n\n        var refreshMediaDevices = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'refresh-devices';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('REFRESH_MEDIA_DEVICES')\n            };\n\n            verto.refreshDevices(function(status) {\n              verto.refreshDevicesCallback(function() {\n                resolve(result);\n              });\n            });\n\n          });\n        };\n\n        var checkConnectionSpeed = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'check-connection-speed';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_CONNECTION_SPEED')\n            };\n\n            if (storage.data.autoBand && verto.data.instance) {\n              verto.testSpeed(cb);\n            } else {\n              resolve(result);\n            }\n\n            function cb(data) {\n              resolve(result);\n            }\n          });\n        };\n\n        var provisionConfig = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'provision-config';\n            var result = {\n              'status': 'promise',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_PROVISIONING_CONF')\n            };\n\n            var configResponse = config.configure();\n\n            var configPromise = configResponse.then(\n              function(response) {\n                /**\n                 * from angular docs:\n                 * A response status code between 200 and 299 is considered a success status and will result in the success callback being called\n                 */\n                if(response.status >= 200 && response.status <= 299) {\n                  return result;\n                } else {\n                  result['status'] = 'error';\n                  result['message'] = $translate.instant('ERROR_PROVISIONING_CONF');\n                  return result;\n                }\n              });\n\n              result['promise'] = configPromise;\n\n              resolve(result);\n          });\n        };\n\n        var checkLogin = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'check-login';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_LOGIN'),\n            };\n\n            if(verto.data.connecting || verto.data.connected) {\n              resolve(result);\n              return;\n            };\n\n            var checkUserStored = function() {\n              /**\n               * if user data saved, use stored data for logon and not connecting\n               * not connecting prevent two connects\n               */\n              if (storage.data.ui_connected && storage.data.ws_connected && !verto.data.connecting) {\n                verto.data.hostname = storage.data.hostname || verto.data.hostname;\n                verto.data.wsURL = storage.data.wsURL || verto.data.wsURL;\n                verto.data.name = storage.data.name;\n                verto.data.email = storage.data.email;\n                verto.data.login = storage.data.login;\n                verto.data.password = storage.data.password;\n\n                verto.data.connecting = true;\n                verto.connect(function(v, connected) {\n                  verto.data.connecting = false;\n                  resolve(result);\n                });\n              };\n            };\n\n            if(storage.data.ui_connected && storage.data.ws_connected) {\n              checkUserStored();\n            } else {\n              resolve(result);\n            };\n          });\n        };\n\n        var progress = [\n          checkBrowser,\n          checkMediaPerm,\n          refreshMediaDevices,\n          provisionConfig,\n          checkLogin,\n          checkConnectionSpeed\n        ];\n\n        var progress_message = [\n          $translate.instant('BROWSER_COMPATIBILITY'),\n          $translate.instant('CHECK_PERMISSION_MEDIA'),\n          $translate.instant('REFRESH_MEDIA_DEVICES'),\n          $translate.instant('CHECK_PROVISIONING_CONF'),\n          $translate.instant('CHECK_LOGIN'),\n          $translate.instant('CHECK_CONNECTION_SPEED'),\n        ];\n\n        var getProgressMessage = function(current_progress) {\n          if(progress_message[current_progress] != undefined) {\n            return progress_message[current_progress];\n          } else {\n            return $translate.instant('PLEASE_WAIT');\n          }\n        };\n\n        var current_progress = -1;\n        var progress_percentage = 0;\n\n        var calculateProgress = function(index) {\n          var _progress;\n\n          _progress = index + 1;\n          progress_percentage = (_progress / progress.length) * 100;\n          return progress_percentage;\n        };\n\n        var nextProgress = function() {\n          var fn, fn_return, status, interrupt, activity, soft, message, promise;\n          interrupt = false;\n          current_progress++;\n\n          if(current_progress >= progress.length) {\n            $rootScope.$emit('progress.complete', current_progress);\n            return;\n          }\n\n          fn = progress[current_progress];\n          fn_return = fn();\n\n          var emitNextProgress = function(fn_return) {\n            if(fn_return['promise'] != undefined) {\n              promise = fn_return['promise'];\n            }\n\n            status = fn_return['status'];\n            soft = fn_return['soft'];\n            activity = fn_return['activity'];\n            message = fn_return['message'];\n\n            if(status != 'success') {\n              interrupt = true;\n            }\n\n            $rootScope.$emit('progress.next', current_progress, status, promise, activity, soft, interrupt, message);\n\n          };\n\n          fn_return.then(\n            function(fn_return) {\n              emitNextProgress(fn_return);\n            },\n            function(fn_return) {\n              emitNextProgress(fn_return);\n            }\n          );\n\n        };\n\n        return {\n          'next': nextProgress,\n          'getProgressMessage': getProgressMessage,\n          'progress_percentage': progress_percentage,\n          'calculate': calculateProgress\n        };\n\n      }]);\n"]}